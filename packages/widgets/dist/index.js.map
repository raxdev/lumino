{"version":3,"file":"index.js","sources":["../src/boxengine.ts","../../../node_modules/tslib/tslib.es6.js","../src/title.ts","../src/widget.ts","../src/layout.ts","../src/panellayout.ts","../src/boxlayout.ts","../src/panel.ts","../src/boxpanel.ts","../src/commandpalette.ts","../src/menu.ts","../src/contextmenu.ts","../src/docklayout.ts","../src/tabbar.ts","../src/dockpanel.ts","../src/focustracker.ts","../src/gridlayout.ts","../src/menubar.ts","../src/scrollbar.ts","../src/singletonlayout.ts","../src/splitlayout.ts","../src/splitpanel.ts","../src/stackedlayout.ts","../src/stackedpanel.ts","../src/tabpanel.ts"],"sourcesContent":["// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\n\r\n\r\n/**\r\n * A sizer object for use with the box engine layout functions.\r\n *\r\n * #### Notes\r\n * A box sizer holds the geometry information for an object along an\r\n * arbitrary layout orientation.\r\n *\r\n * For best performance, this class should be treated as a raw data\r\n * struct. It should not typically be subclassed.\r\n */\r\nexport\r\nclass BoxSizer {\r\n  /**\r\n   * The preferred size for the sizer.\r\n   *\r\n   * #### Notes\r\n   * The sizer will be given this initial size subject to its size\r\n   * bounds. The sizer will not deviate from this size unless such\r\n   * deviation is required to fit into the available layout space.\r\n   *\r\n   * There is no limit to this value, but it will be clamped to the\r\n   * bounds defined by [[minSize]] and [[maxSize]].\r\n   *\r\n   * The default value is `0`.\r\n   */\r\n  sizeHint = 0;\r\n\r\n  /**\r\n   * The minimum size of the sizer.\r\n   *\r\n   * #### Notes\r\n   * The sizer will never be sized less than this value, even if\r\n   * it means the sizer will overflow the available layout space.\r\n   *\r\n   * It is assumed that this value lies in the range `[0, Infinity)`\r\n   * and that it is `<=` to [[maxSize]]. Failure to adhere to this\r\n   * constraint will yield undefined results.\r\n   *\r\n   * The default value is `0`.\r\n   */\r\n  minSize = 0;\r\n\r\n  /**\r\n   * The maximum size of the sizer.\r\n   *\r\n   * #### Notes\r\n   * The sizer will never be sized greater than this value, even if\r\n   * it means the sizer will underflow the available layout space.\r\n   *\r\n   * It is assumed that this value lies in the range `[0, Infinity]`\r\n   * and that it is `>=` to [[minSize]]. Failure to adhere to this\r\n   * constraint will yield undefined results.\r\n   *\r\n   * The default value is `Infinity`.\r\n   */\r\n  maxSize = Infinity;\r\n\r\n  /**\r\n   * The stretch factor for the sizer.\r\n   *\r\n   * #### Notes\r\n   * This controls how much the sizer stretches relative to its sibling\r\n   * sizers when layout space is distributed. A stretch factor of zero\r\n   * is special and will cause the sizer to only be resized after all\r\n   * other sizers with a stretch factor greater than zero have been\r\n   * resized to their limits.\r\n   *\r\n   * It is assumed that this value is an integer that lies in the range\r\n   * `[0, Infinity)`. Failure to adhere to this constraint will yield\r\n   * undefined results.\r\n   *\r\n   * The default value is `1`.\r\n   */\r\n  stretch = 1;\r\n\r\n  /**\r\n   * The computed size of the sizer.\r\n   *\r\n   * #### Notes\r\n   * This value is the output of a call to [[boxCalc]]. It represents\r\n   * the computed size for the object along the layout orientation,\r\n   * and will always lie in the range `[minSize, maxSize]`.\r\n   *\r\n   * This value is output only.\r\n   *\r\n   * Changing this value will have no effect.\r\n   */\r\n  size = 0;\r\n\r\n  /**\r\n   * An internal storage property for the layout algorithm.\r\n   *\r\n   * #### Notes\r\n   * This value is used as temporary storage by the layout algorithm.\r\n   *\r\n   * Changing this value will have no effect.\r\n   */\r\n  done = false;\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the box engine layout functions.\r\n */\r\nexport\r\nnamespace BoxEngine {\r\n  /**\r\n   * Calculate the optimal layout sizes for a sequence of box sizers.\r\n   *\r\n   * This distributes the available layout space among the box sizers\r\n   * according to the following algorithm:\r\n   *\r\n   * 1. Initialize the sizers's size to its size hint and compute the\r\n   *    sums for each of size hint, min size, and max size.\r\n   *\r\n   * 2. If the total size hint equals the available space, return.\r\n   *\r\n   * 3. If the available space is less than the total min size, set all\r\n   *    sizers to their min size and return.\r\n   *\r\n   * 4. If the available space is greater than the total max size, set\r\n   *    all sizers to their max size and return.\r\n   *\r\n   * 5. If the layout space is less than the total size hint, distribute\r\n   *    the negative delta as follows:\r\n   *\r\n   *    a. Shrink each sizer with a stretch factor greater than zero by\r\n   *       an amount proportional to the negative space and the sum of\r\n   *       stretch factors. If the sizer reaches its min size, remove\r\n   *       it and its stretch factor from the computation.\r\n   *\r\n   *    b. If after adjusting all stretch sizers there remains negative\r\n   *       space, distribute the space equally among the sizers with a\r\n   *       stretch factor of zero. If a sizer reaches its min size,\r\n   *       remove it from the computation.\r\n   *\r\n   * 6. If the layout space is greater than the total size hint,\r\n   *    distribute the positive delta as follows:\r\n   *\r\n   *    a. Expand each sizer with a stretch factor greater than zero by\r\n   *       an amount proportional to the postive space and the sum of\r\n   *       stretch factors. If the sizer reaches its max size, remove\r\n   *       it and its stretch factor from the computation.\r\n   *\r\n   *    b. If after adjusting all stretch sizers there remains positive\r\n   *       space, distribute the space equally among the sizers with a\r\n   *       stretch factor of zero. If a sizer reaches its max size,\r\n   *       remove it from the computation.\r\n   *\r\n   * 7. return\r\n   *\r\n   * @param sizers - The sizers for a particular layout line.\r\n   *\r\n   * @param space - The available layout space for the sizers.\r\n   *\r\n   * @returns The delta between the provided available space and the\r\n   *   actual consumed space. This value will be zero if the sizers\r\n   *   can be adjusted to fit, negative if the available space is too\r\n   *   small, and positive if the available space is too large.\r\n   *\r\n   * #### Notes\r\n   * The [[size]] of each sizer is updated with the computed size.\r\n   *\r\n   * This function can be called at any time to recompute the layout for\r\n   * an existing sequence of sizers. The previously computed results will\r\n   * have no effect on the new output. It is therefore not necessary to\r\n   * create new sizer objects on each resize event.\r\n   */\r\n  export\r\n  function calc(sizers: ArrayLike<BoxSizer>, space: number): number {\r\n    // Bail early if there is nothing to do.\r\n    let count = sizers.length;\r\n    if (count === 0) {\r\n      return space;\r\n    }\r\n\r\n    // Setup the size and stretch counters.\r\n    let totalMin = 0;\r\n    let totalMax = 0;\r\n    let totalSize = 0;\r\n    let totalStretch = 0;\r\n    let stretchCount = 0;\r\n\r\n    // Setup the sizers and compute the totals.\r\n    for (let i = 0; i < count; ++i) {\r\n      let sizer = sizers[i];\r\n      let min = sizer.minSize;\r\n      let max = sizer.maxSize;\r\n      let hint = sizer.sizeHint;\r\n      sizer.done = false;\r\n      sizer.size = Math.max(min, Math.min(hint, max));\r\n      totalSize += sizer.size;\r\n      totalMin += min;\r\n      totalMax += max;\r\n      if (sizer.stretch > 0) {\r\n        totalStretch += sizer.stretch;\r\n        stretchCount++;\r\n      }\r\n    }\r\n\r\n    // If the space is equal to the total size, return early.\r\n    if (space === totalSize) {\r\n      return 0;\r\n    }\r\n\r\n    // If the space is less than the total min, minimize each sizer.\r\n    if (space <= totalMin) {\r\n      for (let i = 0; i < count; ++i) {\r\n        let sizer = sizers[i];\r\n        sizer.size = sizer.minSize;\r\n      }\r\n      return space - totalMin;\r\n    }\r\n\r\n    // If the space is greater than the total max, maximize each sizer.\r\n    if (space >= totalMax) {\r\n      for (let i = 0; i < count; ++i) {\r\n        let sizer = sizers[i];\r\n        sizer.size = sizer.maxSize;\r\n      }\r\n      return space - totalMax;\r\n    }\r\n\r\n    // The loops below perform sub-pixel precision sizing. A near zero\r\n    // value is used for compares instead of zero to ensure that the\r\n    // loop terminates when the subdivided space is reasonably small.\r\n    let nearZero = 0.01;\r\n\r\n    // A counter which is decremented each time a sizer is resized to\r\n    // its limit. This ensures the loops terminate even if there is\r\n    // space remaining to distribute.\r\n    let notDoneCount = count;\r\n\r\n    // Distribute negative delta space.\r\n    if (space < totalSize) {\r\n      // Shrink each stretchable sizer by an amount proportional to its\r\n      // stretch factor. If a sizer reaches its min size it's marked as\r\n      // done. The loop progresses in phases where each sizer is given\r\n      // a chance to consume its fair share for the pass, regardless of\r\n      // whether a sizer before it reached its limit. This continues\r\n      // until the stretchable sizers or the free space is exhausted.\r\n      let freeSpace = totalSize - space;\r\n      while (stretchCount > 0 && freeSpace > nearZero) {\r\n        let distSpace = freeSpace;\r\n        let distStretch = totalStretch;\r\n        for (let i = 0; i < count; ++i) {\r\n          let sizer = sizers[i];\r\n          if (sizer.done || sizer.stretch === 0) {\r\n            continue;\r\n          }\r\n          let amt = sizer.stretch * distSpace / distStretch;\r\n          if (sizer.size - amt <= sizer.minSize) {\r\n            freeSpace -= sizer.size - sizer.minSize;\r\n            totalStretch -= sizer.stretch;\r\n            sizer.size = sizer.minSize;\r\n            sizer.done = true;\r\n            notDoneCount--;\r\n            stretchCount--;\r\n          } else {\r\n            freeSpace -= amt;\r\n            sizer.size -= amt;\r\n          }\r\n        }\r\n      }\r\n      // Distribute any remaining space evenly among the non-stretchable\r\n      // sizers. This progresses in phases in the same manner as above.\r\n      while (notDoneCount > 0 && freeSpace > nearZero) {\r\n        let amt = freeSpace / notDoneCount;\r\n        for (let i = 0; i < count; ++i) {\r\n          let sizer = sizers[i];\r\n          if (sizer.done) {\r\n            continue;\r\n          }\r\n          if (sizer.size - amt <= sizer.minSize) {\r\n            freeSpace -= sizer.size - sizer.minSize;\r\n            sizer.size = sizer.minSize;\r\n            sizer.done = true;\r\n            notDoneCount--;\r\n          } else {\r\n            freeSpace -= amt;\r\n            sizer.size -= amt;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // Distribute positive delta space.\r\n    else {\r\n      // Expand each stretchable sizer by an amount proportional to its\r\n      // stretch factor. If a sizer reaches its max size it's marked as\r\n      // done. The loop progresses in phases where each sizer is given\r\n      // a chance to consume its fair share for the pass, regardless of\r\n      // whether a sizer before it reached its limit. This continues\r\n      // until the stretchable sizers or the free space is exhausted.\r\n      let freeSpace = space - totalSize;\r\n      while (stretchCount > 0 && freeSpace > nearZero) {\r\n        let distSpace = freeSpace;\r\n        let distStretch = totalStretch;\r\n        for (let i = 0; i < count; ++i) {\r\n          let sizer = sizers[i];\r\n          if (sizer.done || sizer.stretch === 0) {\r\n            continue;\r\n          }\r\n          let amt = sizer.stretch * distSpace / distStretch;\r\n          if (sizer.size + amt >= sizer.maxSize) {\r\n            freeSpace -= sizer.maxSize - sizer.size;\r\n            totalStretch -= sizer.stretch;\r\n            sizer.size = sizer.maxSize;\r\n            sizer.done = true;\r\n            notDoneCount--;\r\n            stretchCount--;\r\n          } else {\r\n            freeSpace -= amt;\r\n            sizer.size += amt;\r\n          }\r\n        }\r\n      }\r\n      // Distribute any remaining space evenly among the non-stretchable\r\n      // sizers. This progresses in phases in the same manner as above.\r\n      while (notDoneCount > 0 && freeSpace > nearZero) {\r\n        let amt = freeSpace / notDoneCount;\r\n        for (let i = 0; i < count; ++i) {\r\n          let sizer = sizers[i];\r\n          if (sizer.done) {\r\n            continue;\r\n          }\r\n          if (sizer.size + amt >= sizer.maxSize) {\r\n            freeSpace -= sizer.maxSize - sizer.size;\r\n            sizer.size = sizer.maxSize;\r\n            sizer.done = true;\r\n            notDoneCount--;\r\n          } else {\r\n            freeSpace -= amt;\r\n            sizer.size += amt;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Indicate that the consumed space equals the available space.\r\n    return 0;\r\n  }\r\n\r\n  /**\r\n   * Adjust a sizer by a delta and update its neighbors accordingly.\r\n   *\r\n   * @param sizers - The sizers which should be adjusted.\r\n   *\r\n   * @param index - The index of the sizer to grow.\r\n   *\r\n   * @param delta - The amount to adjust the sizer, positive or negative.\r\n   *\r\n   * #### Notes\r\n   * This will adjust the indicated sizer by the specified amount, along\r\n   * with the sizes of the appropriate neighbors, subject to the limits\r\n   * specified by each of the sizers.\r\n   *\r\n   * This is useful when implementing box layouts where the boundaries\r\n   * between the sizers are interactively adjustable by the user.\r\n   */\r\n  export\r\n  function adjust(sizers: ArrayLike<BoxSizer>, index: number, delta: number): void {\r\n    // Bail early when there is nothing to do.\r\n    if (sizers.length === 0 || delta === 0) {\r\n      return;\r\n    }\r\n\r\n    // Dispatch to the proper implementation.\r\n    if (delta > 0) {\r\n      growSizer(sizers, index, delta);\r\n    } else {\r\n      shrinkSizer(sizers, index, -delta);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Grow a sizer by a positive delta and adjust neighbors.\r\n   */\r\n  function growSizer(sizers: ArrayLike<BoxSizer>, index: number, delta: number): void {\r\n    // Compute how much the items to the left can expand.\r\n    let growLimit = 0;\r\n    for (let i = 0; i <= index; ++i) {\r\n      let sizer = sizers[i];\r\n      growLimit += sizer.maxSize - sizer.size;\r\n    }\r\n\r\n    // Compute how much the items to the right can shrink.\r\n    let shrinkLimit = 0;\r\n    for (let i = index + 1, n = sizers.length; i < n; ++i) {\r\n      let sizer = sizers[i];\r\n      shrinkLimit += sizer.size - sizer.minSize;\r\n    }\r\n\r\n    // Clamp the delta adjustment to the limits.\r\n    delta = Math.min(delta, growLimit, shrinkLimit);\r\n\r\n    // Grow the sizers to the left by the delta.\r\n    let grow = delta;\r\n    for (let i = index; i >= 0 && grow > 0; --i) {\r\n      let sizer = sizers[i];\r\n      let limit = sizer.maxSize - sizer.size;\r\n      if (limit >= grow) {\r\n        sizer.sizeHint = sizer.size + grow;\r\n        grow = 0;\r\n      } else {\r\n        sizer.sizeHint = sizer.size + limit;\r\n        grow -= limit;\r\n      }\r\n    }\r\n\r\n    // Shrink the sizers to the right by the delta.\r\n    let shrink = delta;\r\n    for (let i = index + 1, n = sizers.length; i < n && shrink > 0; ++i) {\r\n      let sizer = sizers[i];\r\n      let limit = sizer.size - sizer.minSize;\r\n      if (limit >= shrink) {\r\n        sizer.sizeHint = sizer.size - shrink;\r\n        shrink = 0;\r\n      } else {\r\n        sizer.sizeHint = sizer.size - limit;\r\n        shrink -= limit;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Shrink a sizer by a positive delta and adjust neighbors.\r\n   */\r\n  function shrinkSizer(sizers: ArrayLike<BoxSizer>, index: number, delta: number): void {\r\n    // Compute how much the items to the right can expand.\r\n    let growLimit = 0;\r\n    for (let i = index + 1, n = sizers.length; i < n; ++i) {\r\n      let sizer = sizers[i];\r\n      growLimit += sizer.maxSize - sizer.size;\r\n    }\r\n\r\n    // Compute how much the items to the left can shrink.\r\n    let shrinkLimit = 0;\r\n    for (let i = 0; i <= index; ++i) {\r\n      let sizer = sizers[i];\r\n      shrinkLimit += sizer.size - sizer.minSize;\r\n    }\r\n\r\n    // Clamp the delta adjustment to the limits.\r\n    delta = Math.min(delta, growLimit, shrinkLimit);\r\n\r\n    // Grow the sizers to the right by the delta.\r\n    let grow = delta;\r\n    for (let i = index + 1, n = sizers.length; i < n && grow > 0; ++i) {\r\n      let sizer = sizers[i];\r\n      let limit = sizer.maxSize - sizer.size;\r\n      if (limit >= grow) {\r\n        sizer.sizeHint = sizer.size + grow;\r\n        grow = 0;\r\n      } else {\r\n        sizer.sizeHint = sizer.size + limit;\r\n        grow -= limit;\r\n      }\r\n    }\r\n\r\n    // Shrink the sizers to the left by the delta.\r\n    let shrink = delta;\r\n    for (let i = index; i >= 0 && shrink > 0; --i) {\r\n      let sizer = sizers[i];\r\n      let limit = sizer.size - sizer.minSize;\r\n      if (limit >= shrink) {\r\n        sizer.sizeHint = sizer.size - shrink;\r\n        shrink = 0;\r\n      } else {\r\n        sizer.sizeHint = sizer.size - limit;\r\n        shrink -= limit;\r\n      }\r\n    }\r\n  }\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport { VirtualElement } from \"@lumino/virtualdom\";\r\n\r\n\r\n/**\r\n * An object which holds data related to an object's title.\r\n *\r\n * #### Notes\r\n * A title object is intended to hold the data necessary to display a\r\n * header for a particular object. A common example is the `TabPanel`,\r\n * which uses the widget title to populate the tab for a child widget.\r\n */\r\nexport\r\nclass Title<T> {\r\n  /**\r\n   * Construct a new title.\r\n   *\r\n   * @param options - The options for initializing the title.\r\n   */\r\n  constructor(options: Title.IOptions<T>) {\r\n    this.owner = options.owner;\r\n    if (options.label !== undefined) {\r\n      this._label = options.label;\r\n    }\r\n    if (options.mnemonic !== undefined) {\r\n      this._mnemonic = options.mnemonic;\r\n    }\r\n    if (options.icon !== undefined) {\r\n      /* <DEPRECATED> */\r\n      if (typeof options.icon === \"string\") {\r\n        // when ._icon is null, the .icon getter will alias .iconClass\r\n        this._icon = null;\r\n        this._iconClass = options.icon;\r\n      } else {\r\n      /* </DEPRECATED> */\r\n\r\n      this._icon = options.icon;\r\n\r\n      /* <DEPRECATED> */\r\n      }\r\n      /* </DEPRECATED> */\r\n    }\r\n\r\n    /* <DEPRECATED> */\r\n    else {\r\n      // if unset, default to aliasing .iconClass\r\n      this._icon = null;\r\n    }\r\n    /* </DEPRECATED> */\r\n\r\n    if (options.iconClass !== undefined) {\r\n      this._iconClass = options.iconClass;\r\n    }\r\n    if (options.iconLabel !== undefined) {\r\n      this._iconLabel = options.iconLabel;\r\n    }\r\n    if (options.iconRenderer !== undefined) {\r\n      this._icon = options.iconRenderer;\r\n    }\r\n    if (options.caption !== undefined) {\r\n      this._caption = options.caption;\r\n    }\r\n    if (options.className !== undefined) {\r\n      this._className = options.className;\r\n    }\r\n    if (options.closable !== undefined) {\r\n      this._closable = options.closable;\r\n    }\r\n    this._dataset = options.dataset || {};\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the state of the title changes.\r\n   */\r\n  get changed(): ISignal<this, void> {\r\n    return this._changed;\r\n  }\r\n\r\n  /**\r\n   * The object which owns the title.\r\n   */\r\n  readonly owner: T;\r\n\r\n  /**\r\n   * Get the label for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is an empty string.\r\n   */\r\n  get label(): string {\r\n    return this._label;\r\n  }\r\n\r\n  /**\r\n   * Set the label for the title.\r\n   */\r\n  set label(value: string) {\r\n    if (this._label === value) {\r\n      return;\r\n    }\r\n    this._label = value;\r\n    this._changed.emit(undefined);\r\n  }\r\n\r\n  /**\r\n   * Get the mnemonic index for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is `-1`.\r\n   */\r\n  get mnemonic(): number {\r\n    return this._mnemonic;\r\n  }\r\n\r\n  /**\r\n   * Set the mnemonic index for the title.\r\n   */\r\n  set mnemonic(value: number) {\r\n    if (this._mnemonic === value) {\r\n      return;\r\n    }\r\n    this._mnemonic = value;\r\n    this._changed.emit(undefined);\r\n  }\r\n\r\n  /**\r\n   * Get the icon renderer for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is undefined.\r\n   *\r\n   * DEPRECATED: if set to a string value, the .icon field will function as\r\n   * an alias for the .iconClass field, for backwards compatibility\r\n   */\r\n  get icon(): VirtualElement.IRenderer| undefined\r\n  /* <DEPRECATED> */ | string /* </DEPRECATED> */\r\n  {\r\n    /* <DEPRECATED> */\r\n    if (this._icon === null) {\r\n      // only alias .iconClass if ._icon has been explicitly nulled\r\n      return this.iconClass\r\n    }\r\n    /* </DEPRECATED> */\r\n\r\n    return this._icon;\r\n  }\r\n\r\n  /**\r\n   * Set the icon renderer for the title.\r\n   *\r\n   * #### Notes\r\n   * A renderer is an object that supplies a render and unrender function.\r\n   *\r\n   * DEPRECATED: if set to a string value, the .icon field will function as\r\n   * an alias for the .iconClass field, for backwards compatibility\r\n   */\r\n  set icon(value: VirtualElement.IRenderer | undefined\r\n  /* <DEPRECATED> */ | string /* </DEPRECATED> */\r\n  ) {\r\n    /* <DEPRECATED> */\r\n    if (typeof value === \"string\") {\r\n      // when ._icon is null, the .icon getter will alias .iconClass\r\n      this._icon = null;\r\n      this.iconClass = value;\r\n    } else {\r\n    /* </DEPRECATED> */\r\n\r\n    if (this._icon === value) {\r\n      return;\r\n    }\r\n    this._icon = value;\r\n    this._changed.emit(undefined);\r\n\r\n    /* <DEPRECATED> */\r\n    }\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * Get the icon class name for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is an empty string.\r\n   */\r\n  get iconClass(): string {\r\n    return this._iconClass;\r\n  }\r\n\r\n  /**\r\n   * Set the icon class name for the title.\r\n   *\r\n   * #### Notes\r\n   * Multiple class names can be separated with whitespace.\r\n   */\r\n  set iconClass(value: string) {\r\n    if (this._iconClass === value) {\r\n      return;\r\n    }\r\n    this._iconClass = value;\r\n    this._changed.emit(undefined);\r\n  }\r\n\r\n  /**\r\n   * Get the icon label for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is an empty string.\r\n   */\r\n  get iconLabel(): string {\r\n    return this._iconLabel;\r\n  }\r\n\r\n  /**\r\n   * Set the icon label for the title.\r\n   *\r\n   * #### Notes\r\n   * Multiple class names can be separated with whitespace.\r\n   */\r\n  set iconLabel(value: string) {\r\n    if (this._iconLabel === value) {\r\n      return;\r\n    }\r\n    this._iconLabel = value;\r\n    this._changed.emit(undefined);\r\n  }\r\n\r\n  /**\r\n   * @deprecated Use `icon` instead.\r\n   */\r\n  get iconRenderer(): VirtualElement.IRenderer | undefined {\r\n    return this._icon || undefined;\r\n  }\r\n\r\n  /**\r\n   * @deprecated Use `icon` instead.\r\n   */\r\n  set iconRenderer(value: VirtualElement.IRenderer | undefined) {\r\n    this.icon = value;\r\n  }\r\n\r\n  /**\r\n   * Get the caption for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is an empty string.\r\n   */\r\n  get caption(): string {\r\n    return this._caption;\r\n  }\r\n\r\n  /**\r\n   * Set the caption for the title.\r\n   */\r\n  set caption(value: string) {\r\n    if (this._caption === value) {\r\n      return;\r\n    }\r\n    this._caption = value;\r\n    this._changed.emit(undefined);\r\n  }\r\n\r\n  /**\r\n   * Get the extra class name for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is an empty string.\r\n   */\r\n  get className(): string {\r\n    return this._className;\r\n  }\r\n\r\n  /**\r\n   * Set the extra class name for the title.\r\n   *\r\n   * #### Notes\r\n   * Multiple class names can be separated with whitespace.\r\n   */\r\n  set className(value: string) {\r\n    if (this._className === value) {\r\n      return;\r\n    }\r\n    this._className = value;\r\n    this._changed.emit(undefined);\r\n  }\r\n\r\n  /**\r\n   * Get the closable state for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is `false`.\r\n   */\r\n  get closable(): boolean {\r\n    return this._closable;\r\n  }\r\n\r\n  /**\r\n   * Set the closable state for the title.\r\n   *\r\n   * #### Notes\r\n   * This controls the presence of a close icon when applicable.\r\n   */\r\n  set closable(value: boolean) {\r\n    if (this._closable === value) {\r\n      return;\r\n    }\r\n    this._closable = value;\r\n    this._changed.emit(undefined);\r\n  }\r\n\r\n  /**\r\n   * Get the dataset for the title.\r\n   *\r\n   * #### Notes\r\n   * The default value is an empty dataset.\r\n   */\r\n  get dataset(): Title.Dataset {\r\n    return this._dataset;\r\n  }\r\n\r\n  /**\r\n   * Set the dataset for the title.\r\n   *\r\n   * #### Notes\r\n   * This controls the data attributes when applicable.\r\n   */\r\n  set dataset(value: Title.Dataset) {\r\n    if (this._dataset === value) {\r\n      return;\r\n    }\r\n    this._dataset = value;\r\n    this._changed.emit(undefined);\r\n  }\r\n\r\n  private _label = '';\r\n  private _caption = '';\r\n  private _mnemonic = -1;\r\n\r\n  private _icon: VirtualElement.IRenderer | undefined\r\n  /* <DEPRECATED> */ | null /* </DEPRECATED> */;\r\n\r\n  private _iconClass = '';\r\n  private _iconLabel = '';\r\n  private _className = '';\r\n  private _closable = false;\r\n  private _dataset: Title.Dataset;\r\n  private _changed = new Signal<this, void>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `Title` class statics.\r\n */\r\nexport\r\nnamespace Title {\r\n  /**\r\n   * A type alias for a simple immutable string dataset.\r\n   */\r\n  export\r\n  type Dataset = { readonly [key: string]: string };\r\n\r\n  /**\r\n   * An options object for initializing a title.\r\n   */\r\n  export\r\n  interface IOptions<T> {\r\n    /**\r\n     * The object which owns the title.\r\n     */\r\n    owner: T;\r\n\r\n    /**\r\n     * The label for the title.\r\n     */\r\n    label?: string;\r\n\r\n    /**\r\n     * The mnemonic index for the title.\r\n     */\r\n    mnemonic?: number;\r\n\r\n    /**\r\n     * The icon renderer for the title.\r\n     *\r\n     * DEPRECATED: if set to a string value, the .icon field will function as\r\n     * an alias for the .iconClass field, for backwards compatibility\r\n     */\r\n    icon?: VirtualElement.IRenderer | string;\r\n\r\n    /**\r\n     * The icon class name for the title.\r\n     */\r\n    iconClass?: string;\r\n\r\n    /**\r\n     * The icon label for the title.\r\n     */\r\n    iconLabel?: string;\r\n\r\n    /**\r\n     * @deprecated Use `icon` instead.\r\n     */\r\n    iconRenderer?: VirtualElement.IRenderer;\r\n\r\n    /**\r\n     * The caption for the title.\r\n     */\r\n    caption?: string;\r\n\r\n    /**\r\n     * The extra class name for the title.\r\n     */\r\n    className?: string;\r\n\r\n    /**\r\n     * The closable state for the title.\r\n     */\r\n    closable?: boolean;\r\n\r\n    /**\r\n     * The dataset for the title.\r\n     */\r\n    dataset?: Dataset;\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  IIterator, empty\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  IObservableDisposable\r\n} from '@lumino/disposable';\r\n\r\nimport {\r\n  ConflatableMessage, IMessageHandler, Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  AttachedProperty\r\n} from '@lumino/properties';\r\n\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  Layout\r\n} from './layout';\r\n\r\nimport {\r\n  Title\r\n} from './title';\r\n\r\n\r\n/**\r\n * The base class of the lumino widget hierarchy.\r\n *\r\n * #### Notes\r\n * This class will typically be subclassed in order to create a useful\r\n * widget. However, it can be used directly to host externally created\r\n * content.\r\n */\r\nexport\r\nclass Widget implements IMessageHandler, IObservableDisposable {\r\n  /**\r\n   * Construct a new widget.\r\n   *\r\n   * @param options - The options for initializing the widget.\r\n   */\r\n  constructor(options: Widget.IOptions = {}) {\r\n    this.node = Private.createNode(options);\r\n    this.addClass('lm-Widget');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-Widget');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * Dispose of the widget and its descendant widgets.\r\n   *\r\n   * #### Notes\r\n   * It is unsafe to use the widget after it has been disposed.\r\n   *\r\n   * All calls made to this method after the first are a no-op.\r\n   */\r\n  dispose(): void {\r\n    // Do nothing if the widget is already disposed.\r\n    if (this.isDisposed) {\r\n      return;\r\n    }\r\n\r\n    // Set the disposed flag and emit the disposed signal.\r\n    this.setFlag(Widget.Flag.IsDisposed);\r\n    this._disposed.emit(undefined);\r\n\r\n    // Remove or detach the widget if necessary.\r\n    if (this.parent) {\r\n      this.parent = null;\r\n    } else if (this.isAttached) {\r\n      Widget.detach(this);\r\n    }\r\n\r\n    // Dispose of the widget layout.\r\n    if (this._layout) {\r\n      this._layout.dispose();\r\n      this._layout = null;\r\n    }\r\n\r\n    // Clear the extra data associated with the widget.\r\n    Signal.clearData(this);\r\n    MessageLoop.clearData(this);\r\n    AttachedProperty.clearData(this);\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the widget is disposed.\r\n   */\r\n  get disposed(): ISignal<this, void> {\r\n    return this._disposed;\r\n  }\r\n\r\n  /**\r\n   * Get the DOM node owned by the widget.\r\n   */\r\n  readonly node: HTMLElement;\r\n\r\n  /**\r\n   * Test whether the widget has been disposed.\r\n   */\r\n  get isDisposed(): boolean {\r\n    return this.testFlag(Widget.Flag.IsDisposed);\r\n  }\r\n\r\n  /**\r\n   * Test whether the widget's node is attached to the DOM.\r\n   */\r\n  get isAttached(): boolean {\r\n    return this.testFlag(Widget.Flag.IsAttached);\r\n  }\r\n\r\n  /**\r\n   * Test whether the widget is explicitly hidden.\r\n   */\r\n  get isHidden(): boolean {\r\n    return this.testFlag(Widget.Flag.IsHidden);\r\n  }\r\n\r\n  /**\r\n   * Test whether the widget is visible.\r\n   *\r\n   * #### Notes\r\n   * A widget is visible when it is attached to the DOM, is not\r\n   * explicitly hidden, and has no explicitly hidden ancestors.\r\n   */\r\n  get isVisible(): boolean {\r\n    return this.testFlag(Widget.Flag.IsVisible);\r\n  }\r\n\r\n  /**\r\n   * The title object for the widget.\r\n   *\r\n   * #### Notes\r\n   * The title object is used by some container widgets when displaying\r\n   * the widget alongside some title, such as a tab panel or side bar.\r\n   *\r\n   * Since not all widgets will use the title, it is created on demand.\r\n   *\r\n   * The `owner` property of the title is set to this widget.\r\n   */\r\n  get title(): Title<Widget> {\r\n    return Private.titleProperty.get(this);\r\n  }\r\n\r\n  /**\r\n   * Get the id of the widget's DOM node.\r\n   */\r\n  get id(): string {\r\n    return this.node.id;\r\n  }\r\n\r\n  /**\r\n   * Set the id of the widget's DOM node.\r\n   */\r\n  set id(value: string) {\r\n    this.node.id = value;\r\n  }\r\n\r\n  /**\r\n   * The dataset for the widget's DOM node.\r\n   */\r\n  get dataset(): DOMStringMap {\r\n    return this.node.dataset;\r\n  }\r\n\r\n  /**\r\n   * Get the parent of the widget.\r\n   */\r\n  get parent(): Widget | null {\r\n    return this._parent;\r\n  }\r\n\r\n  /**\r\n   * Set the parent of the widget.\r\n   *\r\n   * #### Notes\r\n   * Children are typically added to a widget by using a layout, which\r\n   * means user code will not normally set the parent widget directly.\r\n   *\r\n   * The widget will be automatically removed from its old parent.\r\n   *\r\n   * This is a no-op if there is no effective parent change.\r\n   */\r\n  set parent(value: Widget | null) {\r\n    if (this._parent === value) {\r\n      return;\r\n    }\r\n    if (value && this.contains(value)) {\r\n      throw new Error('Invalid parent widget.');\r\n    }\r\n    if (this._parent && !this._parent.isDisposed) {\r\n      let msg = new Widget.ChildMessage('child-removed', this);\r\n      MessageLoop.sendMessage(this._parent, msg);\r\n    }\r\n    this._parent = value;\r\n    if (this._parent && !this._parent.isDisposed) {\r\n      let msg = new Widget.ChildMessage('child-added', this);\r\n      MessageLoop.sendMessage(this._parent, msg);\r\n    }\r\n    if (!this.isDisposed) {\r\n      MessageLoop.sendMessage(this, Widget.Msg.ParentChanged);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the layout for the widget.\r\n   */\r\n  get layout(): Layout | null {\r\n    return this._layout;\r\n  }\r\n\r\n  /**\r\n   * Set the layout for the widget.\r\n   *\r\n   * #### Notes\r\n   * The layout is single-use only. It cannot be changed after the\r\n   * first assignment.\r\n   *\r\n   * The layout is disposed automatically when the widget is disposed.\r\n   */\r\n  set layout(value: Layout | null) {\r\n    if (this._layout === value) {\r\n      return;\r\n    }\r\n    if (this.testFlag(Widget.Flag.DisallowLayout)) {\r\n      throw new Error('Cannot set widget layout.');\r\n    }\r\n    if (this._layout) {\r\n      throw new Error('Cannot change widget layout.');\r\n    }\r\n    if (value!.parent) {\r\n      throw new Error('Cannot change layout parent.');\r\n    }\r\n    this._layout = value;\r\n    value!.parent = this;\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the widget's children.\r\n   *\r\n   * @returns A new iterator over the children of the widget.\r\n   *\r\n   * #### Notes\r\n   * The widget must have a populated layout in order to have children.\r\n   *\r\n   * If a layout is not installed, the returned iterator will be empty.\r\n   */\r\n  children(): IIterator<Widget> {\r\n    return this._layout ? this._layout.iter() : empty<Widget>();\r\n  }\r\n\r\n  /**\r\n   * Test whether a widget is a descendant of this widget.\r\n   *\r\n   * @param widget - The descendant widget of interest.\r\n   *\r\n   * @returns `true` if the widget is a descendant, `false` otherwise.\r\n   */\r\n  contains(widget: Widget): boolean {\r\n    for (let value: Widget | null = widget; value; value = value._parent) {\r\n      if (value === this) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Test whether the widget's DOM node has the given class name.\r\n   *\r\n   * @param name - The class name of interest.\r\n   *\r\n   * @returns `true` if the node has the class, `false` otherwise.\r\n   */\r\n  hasClass(name: string): boolean {\r\n    return this.node.classList.contains(name);\r\n  }\r\n\r\n  /**\r\n   * Add a class name to the widget's DOM node.\r\n   *\r\n   * @param name - The class name to add to the node.\r\n   *\r\n   * #### Notes\r\n   * If the class name is already added to the node, this is a no-op.\r\n   *\r\n   * The class name must not contain whitespace.\r\n   */\r\n  addClass(name: string): void {\r\n    this.node.classList.add(name);\r\n  }\r\n\r\n  /**\r\n   * Remove a class name from the widget's DOM node.\r\n   *\r\n   * @param name - The class name to remove from the node.\r\n   *\r\n   * #### Notes\r\n   * If the class name is not yet added to the node, this is a no-op.\r\n   *\r\n   * The class name must not contain whitespace.\r\n   */\r\n  removeClass(name: string): void {\r\n    this.node.classList.remove(name);\r\n  }\r\n\r\n  /**\r\n   * Toggle a class name on the widget's DOM node.\r\n   *\r\n   * @param name - The class name to toggle on the node.\r\n   *\r\n   * @param force - Whether to force add the class (`true`) or force\r\n   *   remove the class (`false`). If not provided, the presence of\r\n   *   the class will be toggled from its current state.\r\n   *\r\n   * @returns `true` if the class is now present, `false` otherwise.\r\n   *\r\n   * #### Notes\r\n   * The class name must not contain whitespace.\r\n   */\r\n  toggleClass(name: string, force?: boolean): boolean {\r\n    if (force === true) {\r\n      this.node.classList.add(name);\r\n      return true;\r\n    }\r\n    if (force === false) {\r\n      this.node.classList.remove(name);\r\n      return false;\r\n    }\r\n    return this.node.classList.toggle(name);\r\n  }\r\n\r\n  /**\r\n   * Post an `'update-request'` message to the widget.\r\n   *\r\n   * #### Notes\r\n   * This is a simple convenience method for posting the message.\r\n   */\r\n  update(): void {\r\n    MessageLoop.postMessage(this, Widget.Msg.UpdateRequest);\r\n  }\r\n\r\n  /**\r\n   * Post a `'fit-request'` message to the widget.\r\n   *\r\n   * #### Notes\r\n   * This is a simple convenience method for posting the message.\r\n   */\r\n  fit(): void {\r\n    MessageLoop.postMessage(this, Widget.Msg.FitRequest);\r\n  }\r\n\r\n  /**\r\n   * Post an `'activate-request'` message to the widget.\r\n   *\r\n   * #### Notes\r\n   * This is a simple convenience method for posting the message.\r\n   */\r\n  activate(): void {\r\n    MessageLoop.postMessage(this, Widget.Msg.ActivateRequest);\r\n  }\r\n\r\n  /**\r\n   * Send a `'close-request'` message to the widget.\r\n   *\r\n   * #### Notes\r\n   * This is a simple convenience method for sending the message.\r\n   */\r\n  close(): void {\r\n    MessageLoop.sendMessage(this, Widget.Msg.CloseRequest);\r\n  }\r\n\r\n  /**\r\n   * Show the widget and make it visible to its parent widget.\r\n   *\r\n   * #### Notes\r\n   * This causes the [[isHidden]] property to be `false`.\r\n   *\r\n   * If the widget is not explicitly hidden, this is a no-op.\r\n   */\r\n  show(): void {\r\n    if (!this.testFlag(Widget.Flag.IsHidden)) {\r\n      return;\r\n    }\r\n    if (this.isAttached && (!this.parent || this.parent.isVisible)) {\r\n      MessageLoop.sendMessage(this, Widget.Msg.BeforeShow);\r\n    }\r\n    this.clearFlag(Widget.Flag.IsHidden);\r\n    this.removeClass('lm-mod-hidden');\r\n    /* <DEPRECATED> */\r\n    this.removeClass('p-mod-hidden');\r\n    /* </DEPRECATED> */\r\n    if (this.isAttached && (!this.parent || this.parent.isVisible)) {\r\n      MessageLoop.sendMessage(this, Widget.Msg.AfterShow);\r\n    }\r\n    if (this.parent) {\r\n      let msg = new Widget.ChildMessage('child-shown', this);\r\n      MessageLoop.sendMessage(this.parent, msg);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Hide the widget and make it hidden to its parent widget.\r\n   *\r\n   * #### Notes\r\n   * This causes the [[isHidden]] property to be `true`.\r\n   *\r\n   * If the widget is explicitly hidden, this is a no-op.\r\n   */\r\n  hide(): void {\r\n    if (this.testFlag(Widget.Flag.IsHidden)) {\r\n      return;\r\n    }\r\n    if (this.isAttached && (!this.parent || this.parent.isVisible)) {\r\n      MessageLoop.sendMessage(this, Widget.Msg.BeforeHide);\r\n    }\r\n    this.setFlag(Widget.Flag.IsHidden);\r\n    this.addClass('lm-mod-hidden');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-mod-hidden');\r\n    /* </DEPRECATED> */\r\n    if (this.isAttached && (!this.parent || this.parent.isVisible)) {\r\n      MessageLoop.sendMessage(this, Widget.Msg.AfterHide);\r\n    }\r\n    if (this.parent) {\r\n      let msg = new Widget.ChildMessage('child-hidden', this);\r\n      MessageLoop.sendMessage(this.parent, msg);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show or hide the widget according to a boolean value.\r\n   *\r\n   * @param hidden - `true` to hide the widget, or `false` to show it.\r\n   *\r\n   * #### Notes\r\n   * This is a convenience method for `hide()` and `show()`.\r\n   */\r\n  setHidden(hidden: boolean): void {\r\n    if (hidden) {\r\n      this.hide();\r\n    } else {\r\n      this.show();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Test whether the given widget flag is set.\r\n   *\r\n   * #### Notes\r\n   * This will not typically be called directly by user code.\r\n   */\r\n  testFlag(flag: Widget.Flag): boolean {\r\n    return (this._flags & flag) !== 0;\r\n  }\r\n\r\n  /**\r\n   * Set the given widget flag.\r\n   *\r\n   * #### Notes\r\n   * This will not typically be called directly by user code.\r\n   */\r\n  setFlag(flag: Widget.Flag): void {\r\n    this._flags |= flag;\r\n  }\r\n\r\n  /**\r\n   * Clear the given widget flag.\r\n   *\r\n   * #### Notes\r\n   * This will not typically be called directly by user code.\r\n   */\r\n  clearFlag(flag: Widget.Flag): void {\r\n    this._flags &= ~flag;\r\n  }\r\n\r\n  /**\r\n   * Process a message sent to the widget.\r\n   *\r\n   * @param msg - The message sent to the widget.\r\n   *\r\n   * #### Notes\r\n   * Subclasses may reimplement this method as needed.\r\n   */\r\n  processMessage(msg: Message): void {\r\n    switch (msg.type) {\r\n    case 'resize':\r\n      this.notifyLayout(msg);\r\n      this.onResize(msg as Widget.ResizeMessage);\r\n      break;\r\n    case 'update-request':\r\n      this.notifyLayout(msg);\r\n      this.onUpdateRequest(msg);\r\n      break;\r\n    case 'fit-request':\r\n      this.notifyLayout(msg);\r\n      this.onFitRequest(msg);\r\n      break;\r\n    case 'before-show':\r\n      this.notifyLayout(msg);\r\n      this.onBeforeShow(msg);\r\n      break;\r\n    case 'after-show':\r\n      this.setFlag(Widget.Flag.IsVisible);\r\n      this.notifyLayout(msg);\r\n      this.onAfterShow(msg);\r\n      break;\r\n    case 'before-hide':\r\n      this.notifyLayout(msg);\r\n      this.onBeforeHide(msg);\r\n      break;\r\n    case 'after-hide':\r\n      this.clearFlag(Widget.Flag.IsVisible);\r\n      this.notifyLayout(msg);\r\n      this.onAfterHide(msg);\r\n      break;\r\n    case 'before-attach':\r\n      this.notifyLayout(msg);\r\n      this.onBeforeAttach(msg);\r\n      break;\r\n    case 'after-attach':\r\n      if (!this.isHidden && (!this.parent || this.parent.isVisible)) {\r\n        this.setFlag(Widget.Flag.IsVisible);\r\n      }\r\n      this.setFlag(Widget.Flag.IsAttached);\r\n      this.notifyLayout(msg);\r\n      this.onAfterAttach(msg);\r\n      break;\r\n    case 'before-detach':\r\n      this.notifyLayout(msg);\r\n      this.onBeforeDetach(msg);\r\n      break;\r\n    case 'after-detach':\r\n      this.clearFlag(Widget.Flag.IsVisible);\r\n      this.clearFlag(Widget.Flag.IsAttached);\r\n      this.notifyLayout(msg);\r\n      this.onAfterDetach(msg);\r\n      break;\r\n    case 'activate-request':\r\n      this.notifyLayout(msg);\r\n      this.onActivateRequest(msg);\r\n      break;\r\n    case 'close-request':\r\n      this.notifyLayout(msg);\r\n      this.onCloseRequest(msg);\r\n      break;\r\n    case 'child-added':\r\n      this.notifyLayout(msg);\r\n      this.onChildAdded(msg as Widget.ChildMessage);\r\n      break;\r\n    case 'child-removed':\r\n      this.notifyLayout(msg);\r\n      this.onChildRemoved(msg as Widget.ChildMessage);\r\n      break;\r\n    default:\r\n      this.notifyLayout(msg);\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Invoke the message processing routine of the widget's layout.\r\n   *\r\n   * @param msg - The message to dispatch to the layout.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the widget does not have a layout.\r\n   *\r\n   * This will not typically be called directly by user code.\r\n   */\r\n  protected notifyLayout(msg: Message): void {\r\n    if (this._layout) {\r\n      this._layout.processParentMessage(msg);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'close-request'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation unparents or detaches the widget.\r\n   */\r\n  protected onCloseRequest(msg: Message): void {\r\n    if (this.parent) {\r\n      this.parent = null;\r\n    } else if (this.isAttached) {\r\n      Widget.detach(this);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'resize'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onResize(msg: Widget.ResizeMessage): void { }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'fit-request'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onFitRequest(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on an `'activate-request'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onActivateRequest(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-show'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onBeforeShow(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-show'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onAfterShow(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-hide'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onBeforeHide(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-hide'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onAfterHide(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-attach'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onAfterAttach(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-detach'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onBeforeDetach(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-detach'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onAfterDetach(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-added'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onChildAdded(msg: Widget.ChildMessage): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-removed'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onChildRemoved(msg: Widget.ChildMessage): void { }\r\n\r\n  private _flags = 0;\r\n  private _layout: Layout | null = null;\r\n  private _parent: Widget | null = null;\r\n  private _disposed = new Signal<this, void>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `Widget` class statics.\r\n */\r\nexport\r\nnamespace Widget {\r\n  /**\r\n   * An options object for initializing a widget.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The optional node to use for the widget.\r\n     *\r\n     * If a node is provided, the widget will assume full ownership\r\n     * and control of the node, as if it had created the node itself.\r\n     *\r\n     * The default is a new `<div>`.\r\n     */\r\n    node?: HTMLElement;\r\n\r\n    /**\r\n     * The optional element tag, used for constructing the widget's node.\r\n     *\r\n     * If a pre-constructed node is provided via the `node` arg, this\r\n     * value is ignored.\r\n     */\r\n    tag?: keyof HTMLElementTagNameMap;\r\n  }\r\n\r\n  /**\r\n   * An enum of widget bit flags.\r\n   */\r\n  export\r\n  enum Flag {\r\n    /**\r\n     * The widget has been disposed.\r\n     */\r\n    IsDisposed = 0x1,\r\n\r\n    /**\r\n     * The widget is attached to the DOM.\r\n     */\r\n    IsAttached = 0x2,\r\n\r\n    /**\r\n     * The widget is hidden.\r\n     */\r\n    IsHidden = 0x4,\r\n\r\n    /**\r\n     * The widget is visible.\r\n     */\r\n    IsVisible = 0x8,\r\n\r\n    /**\r\n     * A layout cannot be set on the widget.\r\n     */\r\n    DisallowLayout = 0x10\r\n  }\r\n\r\n  /**\r\n   * A collection of stateless messages related to widgets.\r\n   */\r\n  export\r\n  namespace Msg {\r\n    /**\r\n     * A singleton `'before-show'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget before it becomes visible.\r\n     *\r\n     * This message is **not** sent when the widget is being attached.\r\n     */\r\n    export\r\n    const BeforeShow = new Message('before-show');\r\n\r\n    /**\r\n     * A singleton `'after-show'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget after it becomes visible.\r\n     *\r\n     * This message is **not** sent when the widget is being attached.\r\n     */\r\n    export\r\n    const AfterShow = new Message('after-show');\r\n\r\n    /**\r\n     * A singleton `'before-hide'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget before it becomes not-visible.\r\n     *\r\n     * This message is **not** sent when the widget is being detached.\r\n     */\r\n    export\r\n    const BeforeHide = new Message('before-hide');\r\n\r\n    /**\r\n     * A singleton `'after-hide'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget after it becomes not-visible.\r\n     *\r\n     * This message is **not** sent when the widget is being detached.\r\n     */\r\n    export\r\n    const AfterHide = new Message('after-hide');\r\n\r\n    /**\r\n     * A singleton `'before-attach'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget before it is attached.\r\n     */\r\n    export\r\n    const BeforeAttach = new Message('before-attach');\r\n\r\n    /**\r\n     * A singleton `'after-attach'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget after it is attached.\r\n     */\r\n    export\r\n    const AfterAttach = new Message('after-attach');\r\n\r\n    /**\r\n     * A singleton `'before-detach'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget before it is detached.\r\n     */\r\n    export\r\n    const BeforeDetach = new Message('before-detach');\r\n\r\n    /**\r\n     * A singleton `'after-detach'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget after it is detached.\r\n     */\r\n    export\r\n    const AfterDetach = new Message('after-detach');\r\n\r\n    /**\r\n     * A singleton `'parent-changed'` message.\r\n     *\r\n     * #### Notes\r\n     * This message is sent to a widget when its parent has changed.\r\n     */\r\n    export\r\n    const ParentChanged = new Message('parent-changed');\r\n\r\n    /**\r\n     * A singleton conflatable `'update-request'` message.\r\n     *\r\n     * #### Notes\r\n     * This message can be dispatched to supporting widgets in order to\r\n     * update their content based on the current widget state. Not all\r\n     * widgets will respond to messages of this type.\r\n     *\r\n     * For widgets with a layout, this message will inform the layout to\r\n     * update the position and size of its child widgets.\r\n     */\r\n    export\r\n    const UpdateRequest = new ConflatableMessage('update-request');\r\n\r\n    /**\r\n     * A singleton conflatable `'fit-request'` message.\r\n     *\r\n     * #### Notes\r\n     * For widgets with a layout, this message will inform the layout to\r\n     * recalculate its size constraints to fit the space requirements of\r\n     * its child widgets, and to update their position and size. Not all\r\n     * layouts will respond to messages of this type.\r\n     */\r\n    export\r\n    const FitRequest = new ConflatableMessage('fit-request');\r\n\r\n    /**\r\n     * A singleton conflatable `'activate-request'` message.\r\n     *\r\n     * #### Notes\r\n     * This message should be dispatched to a widget when it should\r\n     * perform the actions necessary to activate the widget, which\r\n     * may include focusing its node or descendant node.\r\n     */\r\n    export\r\n    const ActivateRequest = new ConflatableMessage('activate-request');\r\n\r\n    /**\r\n     * A singleton conflatable `'close-request'` message.\r\n     *\r\n     * #### Notes\r\n     * This message should be dispatched to a widget when it should close\r\n     * and remove itself from the widget hierarchy.\r\n     */\r\n    export\r\n    const CloseRequest = new ConflatableMessage('close-request');\r\n  }\r\n\r\n  /**\r\n   * A message class for child related messages.\r\n   */\r\n  export\r\n  class ChildMessage extends Message {\r\n    /**\r\n     * Construct a new child message.\r\n     *\r\n     * @param type - The message type.\r\n     *\r\n     * @param child - The child widget for the message.\r\n     */\r\n    constructor(type: string, child: Widget) {\r\n      super(type);\r\n      this.child = child;\r\n    }\r\n\r\n    /**\r\n     * The child widget for the message.\r\n     */\r\n    readonly child: Widget;\r\n  }\r\n\r\n  /**\r\n   * A message class for `'resize'` messages.\r\n   */\r\n  export\r\n  class ResizeMessage extends Message {\r\n    /**\r\n     * Construct a new resize message.\r\n     *\r\n     * @param width - The **offset width** of the widget, or `-1` if\r\n     *   the width is not known.\r\n     *\r\n     * @param height - The **offset height** of the widget, or `-1` if\r\n     *   the height is not known.\r\n     */\r\n    constructor(width: number, height: number) {\r\n      super('resize');\r\n      this.width = width;\r\n      this.height = height;\r\n    }\r\n\r\n    /**\r\n     * The offset width of the widget.\r\n     *\r\n     * #### Notes\r\n     * This will be `-1` if the width is unknown.\r\n     */\r\n    readonly width: number;\r\n\r\n    /**\r\n     * The offset height of the widget.\r\n     *\r\n     * #### Notes\r\n     * This will be `-1` if the height is unknown.\r\n     */\r\n    readonly height: number;\r\n  }\r\n\r\n  /**\r\n   * The namespace for the `ResizeMessage` class statics.\r\n   */\r\n  export\r\n  namespace ResizeMessage {\r\n    /**\r\n     * A singleton `'resize'` message with an unknown size.\r\n     */\r\n    export\r\n    const UnknownSize = new ResizeMessage(-1, -1);\r\n  }\r\n\r\n  /**\r\n   * Attach a widget to a host DOM node.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param host - The DOM node to use as the widget's host.\r\n   *\r\n   * @param ref - The child of `host` to use as the reference element.\r\n   *   If this is provided, the widget will be inserted before this\r\n   *   node in the host. The default is `null`, which will cause the\r\n   *   widget to be added as the last child of the host.\r\n   *\r\n   * #### Notes\r\n   * This will throw an error if the widget is not a root widget, if\r\n   * the widget is already attached, or if the host is not attached\r\n   * to the DOM.\r\n   */\r\n  export\r\n  function attach(widget: Widget, host: HTMLElement, ref: HTMLElement | null = null): void {\r\n    if (widget.parent) {\r\n      throw new Error('Cannot attach a child widget.');\r\n    }\r\n    if (widget.isAttached || document.body.contains(widget.node)) {\r\n      throw new Error('Widget is already attached.');\r\n    }\r\n    if (!document.body.contains(host)) {\r\n      throw new Error('Host is not attached.');\r\n    }\r\n    MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    host.insertBefore(widget.node, ref);\r\n    MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n  }\r\n\r\n  /**\r\n   * Detach the widget from its host DOM node.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * #### Notes\r\n   * This will throw an error if the widget is not a root widget,\r\n   * or if the widget is not attached to the DOM.\r\n   */\r\n  export\r\n  function detach(widget: Widget): void {\r\n    if (widget.parent) {\r\n      throw new Error('Cannot detach a child widget.');\r\n    }\r\n    if (!widget.isAttached || !document.body.contains(widget.node)) {\r\n      throw new Error('Widget is not attached.');\r\n    }\r\n    MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    widget.node.parentNode!.removeChild(widget.node);\r\n    MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * An attached property for the widget title object.\r\n   */\r\n  export\r\n  const titleProperty = new AttachedProperty<Widget, Title<Widget>>({\r\n    name: 'title',\r\n    create: owner => new Title<Widget>({ owner }),\r\n  });\r\n\r\n  /**\r\n   * Create a DOM node for the given widget options.\r\n   */\r\n  export\r\n  function createNode(options: Widget.IOptions): HTMLElement {\r\n    return options.node || document.createElement(options.tag || 'div');\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  IIterable, IIterator, each\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  IDisposable\r\n} from '@lumino/disposable';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  AttachedProperty\r\n} from '@lumino/properties';\r\n\r\nimport {\r\n  Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * An abstract base class for creating lumino layouts.\r\n *\r\n * #### Notes\r\n * A layout is used to add widgets to a parent and to arrange those\r\n * widgets within the parent's DOM node.\r\n *\r\n * This class implements the base functionality which is required of\r\n * nearly all layouts. It must be subclassed in order to be useful.\r\n *\r\n * Notably, this class does not define a uniform interface for adding\r\n * widgets to the layout. A subclass should define that API in a way\r\n * which is meaningful for its intended use.\r\n */\r\nexport\r\nabstract class Layout implements IIterable<Widget>, IDisposable {\r\n  /**\r\n   * Construct a new layout.\r\n   *\r\n   * @param options - The options for initializing the layout.\r\n   */\r\n  constructor(options: Layout.IOptions = {}) {\r\n    this._fitPolicy = options.fitPolicy || 'set-min-size';\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the layout.\r\n   *\r\n   * #### Notes\r\n   * This should be reimplemented to clear and dispose of the widgets.\r\n   *\r\n   * All reimplementations should call the superclass method.\r\n   *\r\n   * This method is called automatically when the parent is disposed.\r\n   */\r\n  dispose(): void {\r\n    this._parent = null;\r\n    this._disposed = true;\r\n    Signal.clearData(this);\r\n    AttachedProperty.clearData(this);\r\n  }\r\n\r\n  /**\r\n   * Test whether the layout is disposed.\r\n   */\r\n  get isDisposed(): boolean {\r\n    return this._disposed;\r\n  }\r\n\r\n  /**\r\n   * Get the parent widget of the layout.\r\n   */\r\n  get parent(): Widget | null {\r\n    return this._parent;\r\n  }\r\n\r\n  /**\r\n   * Set the parent widget of the layout.\r\n   *\r\n   * #### Notes\r\n   * This is set automatically when installing the layout on the parent\r\n   * widget. The parent widget should not be set directly by user code.\r\n   */\r\n  set parent(value: Widget | null) {\r\n    if (this._parent === value) {\r\n      return;\r\n    }\r\n    if (this._parent) {\r\n      throw new Error('Cannot change parent widget.');\r\n    }\r\n    if (value!.layout !== this) {\r\n      throw new Error('Invalid parent widget.');\r\n    }\r\n    this._parent = value;\r\n    this.init();\r\n  }\r\n\r\n  /**\r\n   * Get the fit policy for the layout.\r\n   *\r\n   * #### Notes\r\n   * The fit policy controls the computed size constraints which are\r\n   * applied to the parent widget by the layout.\r\n   *\r\n   * Some layout implementations may ignore the fit policy.\r\n   */\r\n  get fitPolicy(): Layout.FitPolicy {\r\n    return this._fitPolicy;\r\n  }\r\n\r\n  /**\r\n   * Set the fit policy for the layout.\r\n   *\r\n   * #### Notes\r\n   * The fit policy controls the computed size constraints which are\r\n   * applied to the parent widget by the layout.\r\n   *\r\n   * Some layout implementations may ignore the fit policy.\r\n   *\r\n   * Changing the fit policy will clear the current size constraint\r\n   * for the parent widget and then re-fit the parent.\r\n   */\r\n  set fitPolicy(value: Layout.FitPolicy) {\r\n    // Bail if the policy does not change\r\n    if (this._fitPolicy === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal policy.\r\n    this._fitPolicy = value;\r\n\r\n    // Clear the size constraints and schedule a fit of the parent.\r\n    if (this._parent) {\r\n      let style = this._parent.node.style;\r\n      style.minWidth = '';\r\n      style.minHeight = '';\r\n      style.maxWidth = '';\r\n      style.maxHeight = '';\r\n      this._parent.fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the widgets in the layout.\r\n   *\r\n   * @returns A new iterator over the widgets in the layout.\r\n   *\r\n   * #### Notes\r\n   * This abstract method must be implemented by a subclass.\r\n   */\r\n  abstract iter(): IIterator<Widget>;\r\n\r\n  /**\r\n   * Remove a widget from the layout.\r\n   *\r\n   * @param widget - The widget to remove from the layout.\r\n   *\r\n   * #### Notes\r\n   * A widget is automatically removed from the layout when its `parent`\r\n   * is set to `null`. This method should only be invoked directly when\r\n   * removing a widget from a layout which has yet to be installed on a\r\n   * parent widget.\r\n   *\r\n   * This method should *not* modify the widget's `parent`.\r\n   */\r\n  abstract removeWidget(widget: Widget): void;\r\n\r\n  /**\r\n   * Process a message sent to the parent widget.\r\n   *\r\n   * @param msg - The message sent to the parent widget.\r\n   *\r\n   * #### Notes\r\n   * This method is called by the parent widget to process a message.\r\n   *\r\n   * Subclasses may reimplement this method as needed.\r\n   */\r\n  processParentMessage(msg: Message): void {\r\n    switch (msg.type) {\r\n    case 'resize':\r\n      this.onResize(msg as Widget.ResizeMessage);\r\n      break;\r\n    case 'update-request':\r\n      this.onUpdateRequest(msg);\r\n      break;\r\n    case 'fit-request':\r\n      this.onFitRequest(msg);\r\n      break;\r\n    case 'before-show':\r\n      this.onBeforeShow(msg);\r\n      break;\r\n    case 'after-show':\r\n      this.onAfterShow(msg);\r\n      break;\r\n    case 'before-hide':\r\n      this.onBeforeHide(msg);\r\n      break;\r\n    case 'after-hide':\r\n      this.onAfterHide(msg);\r\n      break;\r\n    case 'before-attach':\r\n      this.onBeforeAttach(msg);\r\n      break;\r\n    case 'after-attach':\r\n      this.onAfterAttach(msg);\r\n      break;\r\n    case 'before-detach':\r\n      this.onBeforeDetach(msg);\r\n      break;\r\n    case 'after-detach':\r\n      this.onAfterDetach(msg);\r\n      break;\r\n    case 'child-removed':\r\n      this.onChildRemoved(msg as Widget.ChildMessage);\r\n      break;\r\n    case 'child-shown':\r\n      this.onChildShown(msg as Widget.ChildMessage);\r\n      break;\r\n    case 'child-hidden':\r\n      this.onChildHidden(msg as Widget.ChildMessage);\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Perform layout initialization which requires the parent widget.\r\n   *\r\n   * #### Notes\r\n   * This method is invoked immediately after the layout is installed\r\n   * on the parent widget.\r\n   *\r\n   * The default implementation reparents all of the widgets to the\r\n   * layout parent widget.\r\n   *\r\n   * Subclasses should reimplement this method and attach the child\r\n   * widget nodes to the parent widget's node.\r\n   */\r\n  protected init(): void {\r\n    each(this, widget => {\r\n      widget.parent = this.parent;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'resize'` message.\r\n   *\r\n   * #### Notes\r\n   * The layout should ensure that its widgets are resized according\r\n   * to the specified layout space, and that they are sent a `'resize'`\r\n   * message if appropriate.\r\n   *\r\n   * The default implementation of this method sends an `UnknownSize`\r\n   * resize message to all widgets.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onResize(msg: Widget.ResizeMessage): void {\r\n    each(this, widget => {\r\n      MessageLoop.sendMessage(widget, Widget.ResizeMessage.UnknownSize);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   *\r\n   * #### Notes\r\n   * The layout should ensure that its widgets are resized according\r\n   * to the available layout space, and that they are sent a `'resize'`\r\n   * message if appropriate.\r\n   *\r\n   * The default implementation of this method sends an `UnknownSize`\r\n   * resize message to all widgets.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    each(this, widget => {\r\n      MessageLoop.sendMessage(widget, Widget.ResizeMessage.UnknownSize);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this method forwards the message\r\n   * to all widgets. It assumes all widget nodes are attached to the\r\n   * parent widget node.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    each(this, widget => {\r\n      MessageLoop.sendMessage(widget, msg);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-attach'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this method forwards the message\r\n   * to all widgets. It assumes all widget nodes are attached to the\r\n   * parent widget node.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onAfterAttach(msg: Message): void {\r\n    each(this, widget => {\r\n      MessageLoop.sendMessage(widget, msg);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-detach'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this method forwards the message\r\n   * to all widgets. It assumes all widget nodes are attached to the\r\n   * parent widget node.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onBeforeDetach(msg: Message): void {\r\n    each(this, widget => {\r\n      MessageLoop.sendMessage(widget, msg);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-detach'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this method forwards the message\r\n   * to all widgets. It assumes all widget nodes are attached to the\r\n   * parent widget node.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onAfterDetach(msg: Message): void {\r\n    each(this, widget => {\r\n      MessageLoop.sendMessage(widget, msg);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-show'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this method forwards the message to\r\n   * all non-hidden widgets. It assumes all widget nodes are attached\r\n   * to the parent widget node.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onBeforeShow(msg: Message): void {\r\n    each(this, widget => {\r\n      if (!widget.isHidden) {\r\n        MessageLoop.sendMessage(widget, msg);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-show'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this method forwards the message to\r\n   * all non-hidden widgets. It assumes all widget nodes are attached\r\n   * to the parent widget node.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onAfterShow(msg: Message): void {\r\n    each(this, widget => {\r\n      if (!widget.isHidden) {\r\n        MessageLoop.sendMessage(widget, msg);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-hide'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this method forwards the message to\r\n   * all non-hidden widgets. It assumes all widget nodes are attached\r\n   * to the parent widget node.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onBeforeHide(msg: Message): void {\r\n    each(this, widget => {\r\n      if (!widget.isHidden) {\r\n        MessageLoop.sendMessage(widget, msg);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-hide'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this method forwards the message to\r\n   * all non-hidden widgets. It assumes all widget nodes are attached\r\n   * to the parent widget node.\r\n   *\r\n   * This may be reimplemented by subclasses as needed.\r\n   */\r\n  protected onAfterHide(msg: Message): void {\r\n    each(this, widget => {\r\n      if (!widget.isHidden) {\r\n        MessageLoop.sendMessage(widget, msg);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-removed'` message.\r\n   *\r\n   * #### Notes\r\n   * This will remove the child widget from the layout.\r\n   *\r\n   * Subclasses should **not** typically reimplement this method.\r\n   */\r\n  protected onChildRemoved(msg: Widget.ChildMessage): void {\r\n    this.removeWidget(msg.child);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'fit-request'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onFitRequest(msg: Message): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-shown'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onChildShown(msg: Widget.ChildMessage): void { }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-hidden'` message.\r\n   *\r\n   * #### Notes\r\n   * The default implementation of this handler is a no-op.\r\n   */\r\n  protected onChildHidden(msg: Widget.ChildMessage): void { }\r\n\r\n  private _disposed = false;\r\n  private _fitPolicy: Layout.FitPolicy;\r\n  private _parent: Widget | null = null;\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `Layout` class statics.\r\n */\r\nexport\r\nnamespace Layout {\r\n  /**\r\n   * A type alias for the layout fit policy.\r\n   *\r\n   * #### Notes\r\n   * The fit policy controls the computed size constraints which are\r\n   * applied to the parent widget by the layout.\r\n   *\r\n   * Some layout implementations may ignore the fit policy.\r\n   */\r\n  export\r\n  type FitPolicy = (\r\n    /**\r\n     * No size constraint will be applied to the parent widget.\r\n     */\r\n    'set-no-constraint' |\r\n\r\n    /**\r\n     * The computed min size will be applied to the parent widget.\r\n     */\r\n    'set-min-size'\r\n  );\r\n\r\n  /**\r\n   * An options object for initializing a layout.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The fit policy for the layout.\r\n     *\r\n     * The default is `'set-min-size'`.\r\n     */\r\n    fitPolicy?: FitPolicy;\r\n  }\r\n\r\n  /**\r\n   * A type alias for the horizontal alignment of a widget.\r\n   */\r\n  export\r\n  type HorizontalAlignment = 'left' | 'center' | 'right';\r\n\r\n  /**\r\n   * A type alias for the vertical alignment of a widget.\r\n   */\r\n  export\r\n  type VerticalAlignment = 'top' | 'center' | 'bottom';\r\n\r\n  /**\r\n   * Get the horizontal alignment for a widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The horizontal alignment for the widget.\r\n   *\r\n   * #### Notes\r\n   * If the layout width allocated to a widget is larger than its max\r\n   * width, the horizontal alignment controls how the widget is placed\r\n   * within the extra horizontal space.\r\n   *\r\n   * If the allocated width is less than the widget's max width, the\r\n   * horizontal alignment has no effect.\r\n   *\r\n   * Some layout implementations may ignore horizontal alignment.\r\n   */\r\n  export\r\n  function getHorizontalAlignment(widget: Widget): HorizontalAlignment {\r\n    return Private.horizontalAlignmentProperty.get(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the horizontal alignment for a widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the horizontal alignment.\r\n   *\r\n   * #### Notes\r\n   * If the layout width allocated to a widget is larger than its max\r\n   * width, the horizontal alignment controls how the widget is placed\r\n   * within the extra horizontal space.\r\n   *\r\n   * If the allocated width is less than the widget's max width, the\r\n   * horizontal alignment has no effect.\r\n   *\r\n   * Some layout implementations may ignore horizontal alignment.\r\n   *\r\n   * Changing the horizontal alignment will post an `update-request`\r\n   * message to widget's parent, provided the parent has a layout\r\n   * installed.\r\n   */\r\n  export\r\n  function setHorizontalAlignment(widget: Widget, value: HorizontalAlignment): void {\r\n    Private.horizontalAlignmentProperty.set(widget, value);\r\n  }\r\n\r\n  /**\r\n   * Get the vertical alignment for a widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The vertical alignment for the widget.\r\n   *\r\n   * #### Notes\r\n   * If the layout height allocated to a widget is larger than its max\r\n   * height, the vertical alignment controls how the widget is placed\r\n   * within the extra vertical space.\r\n   *\r\n   * If the allocated height is less than the widget's max height, the\r\n   * vertical alignment has no effect.\r\n   *\r\n   * Some layout implementations may ignore vertical alignment.\r\n   */\r\n  export\r\n  function getVerticalAlignment(widget: Widget): VerticalAlignment {\r\n    return Private.verticalAlignmentProperty.get(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the vertical alignment for a widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the vertical alignment.\r\n   *\r\n   * #### Notes\r\n   * If the layout height allocated to a widget is larger than its max\r\n   * height, the vertical alignment controls how the widget is placed\r\n   * within the extra vertical space.\r\n   *\r\n   * If the allocated height is less than the widget's max height, the\r\n   * vertical alignment has no effect.\r\n   *\r\n   * Some layout implementations may ignore vertical alignment.\r\n   *\r\n   * Changing the horizontal alignment will post an `update-request`\r\n   * message to widget's parent, provided the parent has a layout\r\n   * installed.\r\n   */\r\n  export\r\n  function setVerticalAlignment(widget: Widget, value: VerticalAlignment): void {\r\n    Private.verticalAlignmentProperty.set(widget, value);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * An object which assists in the absolute layout of widgets.\r\n *\r\n * #### Notes\r\n * This class is useful when implementing a layout which arranges its\r\n * widgets using absolute positioning.\r\n *\r\n * This class is used by nearly all of the built-in lumino layouts.\r\n */\r\nexport\r\nclass LayoutItem implements IDisposable {\r\n  /**\r\n   * Construct a new layout item.\r\n   *\r\n   * @param widget - The widget to be managed by the item.\r\n   *\r\n   * #### Notes\r\n   * The widget will be set to absolute positioning.\r\n   */\r\n  constructor(widget: Widget) {\r\n    this.widget = widget;\r\n    this.widget.node.style.position = 'absolute';\r\n  }\r\n\r\n  /**\r\n   * Dispose of the the layout item.\r\n   *\r\n   * #### Notes\r\n   * This will reset the positioning of the widget.\r\n   */\r\n  dispose(): void {\r\n    // Do nothing if the item is already disposed.\r\n    if (this._disposed) {\r\n      return;\r\n    }\r\n\r\n    // Mark the item as disposed.\r\n    this._disposed = true;\r\n\r\n    // Reset the widget style.\r\n    let style = this.widget.node.style;\r\n    style.position = '';\r\n    style.top = '';\r\n    style.left = '';\r\n    style.width = '';\r\n    style.height = '';\r\n  }\r\n\r\n  /**\r\n   * The widget managed by the layout item.\r\n   */\r\n  readonly widget: Widget;\r\n\r\n  /**\r\n   * The computed minimum width of the widget.\r\n   *\r\n   * #### Notes\r\n   * This value can be updated by calling the `fit` method.\r\n   */\r\n  get minWidth(): number {\r\n    return this._minWidth;\r\n  }\r\n\r\n  /**\r\n   * The computed minimum height of the widget.\r\n   *\r\n   * #### Notes\r\n   * This value can be updated by calling the `fit` method.\r\n   */\r\n  get minHeight(): number {\r\n    return this._minHeight;\r\n  }\r\n\r\n  /**\r\n   * The computed maximum width of the widget.\r\n   *\r\n   * #### Notes\r\n   * This value can be updated by calling the `fit` method.\r\n   */\r\n  get maxWidth(): number {\r\n    return this._maxWidth;\r\n  }\r\n\r\n  /**\r\n   * The computed maximum height of the widget.\r\n   *\r\n   * #### Notes\r\n   * This value can be updated by calling the `fit` method.\r\n   */\r\n  get maxHeight(): number {\r\n    return this._maxHeight;\r\n  }\r\n\r\n  /**\r\n   * Whether the layout item is disposed.\r\n   */\r\n  get isDisposed(): boolean {\r\n    return this._disposed;\r\n  }\r\n\r\n  /**\r\n   * Whether the managed widget is hidden.\r\n   */\r\n  get isHidden(): boolean {\r\n    return this.widget.isHidden;\r\n  }\r\n\r\n  /**\r\n   * Whether the managed widget is visible.\r\n   */\r\n  get isVisible(): boolean {\r\n    return this.widget.isVisible;\r\n  }\r\n\r\n  /**\r\n   * Whether the managed widget is attached.\r\n   */\r\n  get isAttached(): boolean {\r\n    return this.widget.isAttached;\r\n  }\r\n\r\n  /**\r\n   * Update the computed size limits of the managed widget.\r\n   */\r\n  fit(): void {\r\n    let limits = ElementExt.sizeLimits(this.widget.node);\r\n    this._minWidth = limits.minWidth;\r\n    this._minHeight = limits.minHeight;\r\n    this._maxWidth = limits.maxWidth;\r\n    this._maxHeight = limits.maxHeight;\r\n  }\r\n\r\n  /**\r\n   * Update the position and size of the managed widget.\r\n   *\r\n   * @param left - The left edge position of the layout box.\r\n   *\r\n   * @param top - The top edge position of the layout box.\r\n   *\r\n   * @param width - The width of the layout box.\r\n   *\r\n   * @param height - The height of the layout box.\r\n   */\r\n  update(left: number, top: number, width: number, height: number): void {\r\n    // Clamp the size to the computed size limits.\r\n    let clampW = Math.max(this._minWidth, Math.min(width, this._maxWidth));\r\n    let clampH = Math.max(this._minHeight, Math.min(height, this._maxHeight));\r\n\r\n    // Adjust the left edge for the horizontal alignment, if needed.\r\n    if (clampW < width) {\r\n      switch (Layout.getHorizontalAlignment(this.widget)) {\r\n      case 'left':\r\n        break;\r\n      case 'center':\r\n        left += (width - clampW) / 2;\r\n        break;\r\n      case 'right':\r\n        left += width - clampW;\r\n        break;\r\n      default:\r\n        throw 'unreachable';\r\n      }\r\n    }\r\n\r\n    // Adjust the top edge for the vertical alignment, if needed.\r\n    if (clampH < height) {\r\n      switch (Layout.getVerticalAlignment(this.widget)) {\r\n      case 'top':\r\n        break;\r\n      case 'center':\r\n        top += (height - clampH) / 2;\r\n        break;\r\n      case 'bottom':\r\n        top += height - clampH;\r\n        break;\r\n      default:\r\n        throw 'unreachable';\r\n      }\r\n    }\r\n\r\n    // Set up the resize variables.\r\n    let resized = false;\r\n    let style = this.widget.node.style;\r\n\r\n    // Update the top edge of the widget if needed.\r\n    if (this._top !== top) {\r\n      this._top = top;\r\n      style.top = `${top}px`;\r\n    }\r\n\r\n    // Update the left edge of the widget if needed.\r\n    if (this._left !== left) {\r\n      this._left = left;\r\n      style.left = `${left}px`;\r\n    }\r\n\r\n    // Update the width of the widget if needed.\r\n    if (this._width !== clampW) {\r\n      resized = true;\r\n      this._width = clampW;\r\n      style.width = `${clampW}px`;\r\n    }\r\n\r\n    // Update the height of the widget if needed.\r\n    if (this._height !== clampH) {\r\n      resized = true;\r\n      this._height = clampH;\r\n      style.height = `${clampH}px`;\r\n    }\r\n\r\n    // Send a resize message to the widget if needed.\r\n    if (resized) {\r\n      let msg = new Widget.ResizeMessage(clampW, clampH);\r\n      MessageLoop.sendMessage(this.widget, msg);\r\n    }\r\n  }\r\n\r\n  private _top = NaN;\r\n  private _left = NaN;\r\n  private _width = NaN;\r\n  private _height = NaN;\r\n  private _minWidth = 0;\r\n  private _minHeight = 0;\r\n  private _maxWidth = Infinity;\r\n  private _maxHeight = Infinity;\r\n  private _disposed = false;\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * The attached property for a widget horizontal alignment.\r\n   */\r\n  export\r\n  const horizontalAlignmentProperty = new AttachedProperty<Widget, Layout.HorizontalAlignment>({\r\n    name: 'horizontalAlignment',\r\n    create: () => 'center',\r\n    changed: onAlignmentChanged\r\n  });\r\n\r\n  /**\r\n   * The attached property for a widget vertical alignment.\r\n   */\r\n  export\r\n  const verticalAlignmentProperty = new AttachedProperty<Widget, Layout.VerticalAlignment>({\r\n    name: 'verticalAlignment',\r\n    create: () => 'top',\r\n    changed: onAlignmentChanged\r\n  });\r\n\r\n  /**\r\n   * The change handler for the attached alignment properties.\r\n   */\r\n  function onAlignmentChanged(child: Widget): void {\r\n    if (child.parent && child.parent.layout) {\r\n      child.parent.update();\r\n    }\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, IIterator, each, iter\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  Layout\r\n} from './layout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A concrete layout implementation suitable for many use cases.\r\n *\r\n * #### Notes\r\n * This class is suitable as a base class for implementing a variety of\r\n * layouts, but can also be used directly with standard CSS to layout a\r\n * collection of widgets.\r\n */\r\nexport\r\nclass PanelLayout extends Layout {\r\n  /**\r\n   * Dispose of the resources held by the layout.\r\n   *\r\n   * #### Notes\r\n   * This will clear and dispose all widgets in the layout.\r\n   *\r\n   * All reimplementations should call the superclass method.\r\n   *\r\n   * This method is called automatically when the parent is disposed.\r\n   */\r\n  dispose(): void {\r\n    while (this._widgets.length > 0) {\r\n      this._widgets.pop()!.dispose();\r\n    }\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * A read-only array of the widgets in the layout.\r\n   */\r\n  get widgets(): ReadonlyArray<Widget> {\r\n    return this._widgets;\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the widgets in the layout.\r\n   *\r\n   * @returns A new iterator over the widgets in the layout.\r\n   */\r\n  iter(): IIterator<Widget> {\r\n    return iter(this._widgets);\r\n  }\r\n\r\n  /**\r\n   * Add a widget to the end of the layout.\r\n   *\r\n   * @param widget - The widget to add to the layout.\r\n   *\r\n   * #### Notes\r\n   * If the widget is already contained in the layout, it will be moved.\r\n   */\r\n  addWidget(widget: Widget): void {\r\n    this.insertWidget(this._widgets.length, widget);\r\n  }\r\n\r\n  /**\r\n   * Insert a widget into the layout at the specified index.\r\n   *\r\n   * @param index - The index at which to insert the widget.\r\n   *\r\n   * @param widget - The widget to insert into the layout.\r\n   *\r\n   * #### Notes\r\n   * The index will be clamped to the bounds of the widgets.\r\n   *\r\n   * If the widget is already added to the layout, it will be moved.\r\n   *\r\n   * #### Undefined Behavior\r\n   * An `index` which is non-integral.\r\n   */\r\n  insertWidget(index: number, widget: Widget): void {\r\n    // Remove the widget from its current parent. This is a no-op\r\n    // if the widget's parent is already the layout parent widget.\r\n    widget.parent = this.parent;\r\n\r\n    // Look up the current index of the widget.\r\n    let i = this._widgets.indexOf(widget);\r\n\r\n    // Clamp the insert index to the array bounds.\r\n    let j = Math.max(0, Math.min(index, this._widgets.length));\r\n\r\n    // If the widget is not in the array, insert it.\r\n    if (i === -1) {\r\n      // Insert the widget into the array.\r\n      ArrayExt.insert(this._widgets, j, widget);\r\n\r\n      // If the layout is parented, attach the widget to the DOM.\r\n      if (this.parent) {\r\n        this.attachWidget(j, widget);\r\n      }\r\n\r\n      // There is nothing more to do.\r\n      return;\r\n    }\r\n\r\n    // Otherwise, the widget exists in the array and should be moved.\r\n\r\n    // Adjust the index if the location is at the end of the array.\r\n    if (j === this._widgets.length) {\r\n      j--;\r\n    }\r\n\r\n    // Bail if there is no effective move.\r\n    if (i === j) {\r\n      return;\r\n    }\r\n\r\n    // Move the widget to the new location.\r\n    ArrayExt.move(this._widgets, i, j);\r\n\r\n    // If the layout is parented, move the widget in the DOM.\r\n    if (this.parent) {\r\n      this.moveWidget(i, j, widget);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove a widget from the layout.\r\n   *\r\n   * @param widget - The widget to remove from the layout.\r\n   *\r\n   * #### Notes\r\n   * A widget is automatically removed from the layout when its `parent`\r\n   * is set to `null`. This method should only be invoked directly when\r\n   * removing a widget from a layout which has yet to be installed on a\r\n   * parent widget.\r\n   *\r\n   * This method does *not* modify the widget's `parent`.\r\n   */\r\n  removeWidget(widget: Widget): void {\r\n    this.removeWidgetAt(this._widgets.indexOf(widget));\r\n  }\r\n\r\n  /**\r\n   * Remove the widget at a given index from the layout.\r\n   *\r\n   * @param index - The index of the widget to remove.\r\n   *\r\n   * #### Notes\r\n   * A widget is automatically removed from the layout when its `parent`\r\n   * is set to `null`. This method should only be invoked directly when\r\n   * removing a widget from a layout which has yet to be installed on a\r\n   * parent widget.\r\n   *\r\n   * This method does *not* modify the widget's `parent`.\r\n   *\r\n   * #### Undefined Behavior\r\n   * An `index` which is non-integral.\r\n   */\r\n  removeWidgetAt(index: number): void {\r\n    // Remove the widget from the array.\r\n    let widget = ArrayExt.removeAt(this._widgets, index);\r\n\r\n    // If the layout is parented, detach the widget from the DOM.\r\n    if (widget && this.parent) {\r\n      this.detachWidget(index, widget);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Perform layout initialization which requires the parent widget.\r\n   */\r\n  protected init(): void {\r\n    super.init();\r\n    each(this, (widget, index) => {\r\n      this.attachWidget(index, widget);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Attach a widget to the parent's DOM node.\r\n   *\r\n   * @param index - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to attach to the parent.\r\n   *\r\n   * #### Notes\r\n   * This method is called automatically by the panel layout at the\r\n   * appropriate time. It should not be called directly by user code.\r\n   *\r\n   * The default implementation adds the widgets's node to the parent's\r\n   * node at the proper location, and sends the appropriate attach\r\n   * messages to the widget if the parent is attached to the DOM.\r\n   *\r\n   * Subclasses may reimplement this method to control how the widget's\r\n   * node is added to the parent's node.\r\n   */\r\n  protected attachWidget(index: number, widget: Widget): void {\r\n    // Look up the next sibling reference node.\r\n    let ref = this.parent!.node.children[index];\r\n\r\n    // Send a `'before-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    }\r\n\r\n    // Insert the widget's node before the sibling.\r\n    this.parent!.node.insertBefore(widget.node, ref);\r\n\r\n    // Send an `'after-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Move a widget in the parent's DOM node.\r\n   *\r\n   * @param fromIndex - The previous index of the widget in the layout.\r\n   *\r\n   * @param toIndex - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to move in the parent.\r\n   *\r\n   * #### Notes\r\n   * This method is called automatically by the panel layout at the\r\n   * appropriate time. It should not be called directly by user code.\r\n   *\r\n   * The default implementation moves the widget's node to the proper\r\n   * location in the parent's node and sends the appropriate attach and\r\n   * detach messages to the widget if the parent is attached to the DOM.\r\n   *\r\n   * Subclasses may reimplement this method to control how the widget's\r\n   * node is moved in the parent's node.\r\n   */\r\n  protected moveWidget(fromIndex: number, toIndex: number, widget: Widget): void {\r\n    // Send a `'before-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    }\r\n\r\n    // Remove the widget's node from the parent.\r\n    this.parent!.node.removeChild(widget.node);\r\n\r\n    // Send an `'after-detach'` and  message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n    }\r\n\r\n    // Look up the next sibling reference node.\r\n    let ref = this.parent!.node.children[toIndex];\r\n\r\n    // Send a `'before-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    }\r\n\r\n    // Insert the widget's node before the sibling.\r\n    this.parent!.node.insertBefore(widget.node, ref);\r\n\r\n    // Send an `'after-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Detach a widget from the parent's DOM node.\r\n   *\r\n   * @param index - The previous index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to detach from the parent.\r\n   *\r\n   * #### Notes\r\n   * This method is called automatically by the panel layout at the\r\n   * appropriate time. It should not be called directly by user code.\r\n   *\r\n   * The default implementation removes the widget's node from the\r\n   * parent's node, and sends the appropriate detach messages to the\r\n   * widget if the parent is attached to the DOM.\r\n   *\r\n   * Subclasses may reimplement this method to control how the widget's\r\n   * node is removed from the parent's node.\r\n   */\r\n  protected detachWidget(index: number, widget: Widget): void {\r\n    // Send a `'before-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    }\r\n\r\n    // Remove the widget's node from the parent.\r\n    this.parent!.node.removeChild(widget.node);\r\n\r\n    // Send an `'after-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n    }\r\n  }\r\n\r\n  private _widgets: Widget[] = [];\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, each\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  AttachedProperty\r\n} from '@lumino/properties';\r\n\r\nimport {\r\n  BoxEngine, BoxSizer\r\n} from './boxengine';\r\n\r\nimport {\r\n  LayoutItem\r\n} from './layout';\r\n\r\nimport {\r\n  PanelLayout\r\n} from './panellayout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A layout which arranges its widgets in a single row or column.\r\n */\r\nexport\r\nclass BoxLayout extends PanelLayout {\r\n  /**\r\n   * Construct a new box layout.\r\n   *\r\n   * @param options - The options for initializing the layout.\r\n   */\r\n  constructor(options: BoxLayout.IOptions = {}) {\r\n    super();\r\n    if (options.direction !== undefined) {\r\n      this._direction = options.direction;\r\n    }\r\n    if (options.alignment !== undefined) {\r\n      this._alignment = options.alignment;\r\n    }\r\n    if (options.spacing !== undefined) {\r\n      this._spacing = Private.clampSpacing(options.spacing);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the layout.\r\n   */\r\n  dispose(): void {\r\n    // Dispose of the layout items.\r\n    each(this._items, item => { item.dispose(); });\r\n\r\n    // Clear the layout state.\r\n    this._box = null;\r\n    this._items.length = 0;\r\n    this._sizers.length = 0;\r\n\r\n    // Dispose of the rest of the layout.\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * Get the layout direction for the box layout.\r\n   */\r\n  get direction(): BoxLayout.Direction {\r\n    return this._direction;\r\n  }\r\n\r\n  /**\r\n   * Set the layout direction for the box layout.\r\n   */\r\n  set direction(value: BoxLayout.Direction) {\r\n    if (this._direction === value) {\r\n      return;\r\n    }\r\n    this._direction = value;\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n    this.parent.dataset['direction'] = value;\r\n    this.parent.fit();\r\n  }\r\n\r\n  /**\r\n   * Get the content alignment for the box layout.\r\n   *\r\n   * #### Notes\r\n   * This is the alignment of the widgets in the layout direction.\r\n   *\r\n   * The alignment has no effect if the widgets can expand to fill the\r\n   * entire box layout.\r\n   */\r\n  get alignment(): BoxLayout.Alignment {\r\n    return this._alignment;\r\n  }\r\n\r\n  /**\r\n   * Set the content alignment for the box layout.\r\n   *\r\n   * #### Notes\r\n   * This is the alignment of the widgets in the layout direction.\r\n   *\r\n   * The alignment has no effect if the widgets can expand to fill the\r\n   * entire box layout.\r\n   */\r\n  set alignment(value: BoxLayout.Alignment) {\r\n    if (this._alignment === value) {\r\n      return;\r\n    }\r\n    this._alignment = value;\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n    this.parent.dataset['alignment'] = value;\r\n    this.parent.update();\r\n  }\r\n\r\n  /**\r\n   * Get the inter-element spacing for the box layout.\r\n   */\r\n  get spacing(): number {\r\n    return this._spacing;\r\n  }\r\n\r\n  /**\r\n   * Set the inter-element spacing for the box layout.\r\n   */\r\n  set spacing(value: number) {\r\n    value = Private.clampSpacing(value);\r\n    if (this._spacing === value) {\r\n      return;\r\n    }\r\n    this._spacing = value;\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n    this.parent.fit();\r\n  }\r\n\r\n  /**\r\n   * Perform layout initialization which requires the parent widget.\r\n   */\r\n  protected init(): void {\r\n    this.parent!.dataset['direction'] = this.direction;\r\n    this.parent!.dataset['alignment'] = this.alignment;\r\n    super.init();\r\n  }\r\n\r\n  /**\r\n   * Attach a widget to the parent's DOM node.\r\n   *\r\n   * @param index - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to attach to the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected attachWidget(index: number, widget: Widget): void {\r\n    // Create and add a new layout item for the widget.\r\n    ArrayExt.insert(this._items, index, new LayoutItem(widget));\r\n\r\n    // Create and add a new sizer for the widget.\r\n    ArrayExt.insert(this._sizers, index, new BoxSizer());\r\n\r\n    // Send a `'before-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    }\r\n\r\n    // Add the widget's node to the parent.\r\n    this.parent!.node.appendChild(widget.node);\r\n\r\n    // Send an `'after-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n    }\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * Move a widget in the parent's DOM node.\r\n   *\r\n   * @param fromIndex - The previous index of the widget in the layout.\r\n   *\r\n   * @param toIndex - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to move in the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected moveWidget(fromIndex: number, toIndex: number, widget: Widget): void {\r\n    // Move the layout item for the widget.\r\n    ArrayExt.move(this._items, fromIndex, toIndex);\r\n\r\n    // Move the sizer for the widget.\r\n    ArrayExt.move(this._sizers, fromIndex, toIndex);\r\n\r\n    // Post an update request for the parent widget.\r\n    this.parent!.update();\r\n  }\r\n\r\n  /**\r\n   * Detach a widget from the parent's DOM node.\r\n   *\r\n   * @param index - The previous index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to detach from the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected detachWidget(index: number, widget: Widget): void {\r\n    // Remove the layout item for the widget.\r\n    let item = ArrayExt.removeAt(this._items, index);\r\n\r\n    // Remove the sizer for the widget.\r\n    ArrayExt.removeAt(this._sizers, index);\r\n\r\n    // Send a `'before-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    }\r\n\r\n    // Remove the widget's node from the parent.\r\n    this.parent!.node.removeChild(widget.node);\r\n\r\n    // Send an `'after-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n    }\r\n\r\n    // Dispose of the layout item.\r\n    item!.dispose();\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-show'` message.\r\n   */\r\n  protected onBeforeShow(msg: Message): void {\r\n    super.onBeforeShow(msg);\r\n    this.parent!.update();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    super.onBeforeAttach(msg);\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-shown'` message.\r\n   */\r\n  protected onChildShown(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-hidden'` message.\r\n   */\r\n  protected onChildHidden(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'resize'` message.\r\n   */\r\n  protected onResize(msg: Widget.ResizeMessage): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(msg.width, msg.height);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(-1, -1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'fit-request'` message.\r\n   */\r\n  protected onFitRequest(msg: Message): void {\r\n    if (this.parent!.isAttached) {\r\n      this._fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fit the layout to the total size required by the widgets.\r\n   */\r\n  private _fit(): void {\r\n    // Compute the visible item count.\r\n    let nVisible = 0;\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      nVisible += +!this._items[i].isHidden;\r\n    }\r\n\r\n    // Update the fixed space for the visible items.\r\n    this._fixed = this._spacing * Math.max(0, nVisible - 1);\r\n\r\n    // Setup the computed minimum size.\r\n    let horz = Private.isHorizontal(this._direction);\r\n    let minW = horz ? this._fixed : 0;\r\n    let minH = horz ? 0 : this._fixed;\r\n\r\n    // Update the sizers and computed minimum size.\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      // Fetch the item and corresponding box sizer.\r\n      let item = this._items[i];\r\n      let sizer = this._sizers[i];\r\n\r\n      // If the item is hidden, it should consume zero size.\r\n      if (item.isHidden) {\r\n        sizer.minSize = 0;\r\n        sizer.maxSize = 0;\r\n        continue;\r\n      }\r\n\r\n      // Update the size limits for the item.\r\n      item.fit();\r\n\r\n      // Update the size basis and stretch factor.\r\n      sizer.sizeHint = BoxLayout.getSizeBasis(item.widget);\r\n      sizer.stretch = BoxLayout.getStretch(item.widget);\r\n\r\n      // Update the sizer limits and computed min size.\r\n      if (horz) {\r\n        sizer.minSize = item.minWidth;\r\n        sizer.maxSize = item.maxWidth;\r\n        minW += item.minWidth;\r\n        minH = Math.max(minH, item.minHeight);\r\n      } else {\r\n        sizer.minSize = item.minHeight;\r\n        sizer.maxSize = item.maxHeight;\r\n        minH += item.minHeight;\r\n        minW = Math.max(minW, item.minWidth);\r\n      }\r\n    }\r\n\r\n    // Update the box sizing and add it to the computed min size.\r\n    let box = this._box = ElementExt.boxSizing(this.parent!.node);\r\n    minW += box.horizontalSum;\r\n    minH += box.verticalSum;\r\n\r\n    // Update the parent's min size constraints.\r\n    let style = this.parent!.node.style;\r\n    style.minWidth = `${minW}px`;\r\n    style.minHeight = `${minH}px`;\r\n\r\n    // Set the dirty flag to ensure only a single update occurs.\r\n    this._dirty = true;\r\n\r\n    // Notify the ancestor that it should fit immediately. This may\r\n    // cause a resize of the parent, fulfilling the required update.\r\n    if (this.parent!.parent) {\r\n      MessageLoop.sendMessage(this.parent!.parent!, Widget.Msg.FitRequest);\r\n    }\r\n\r\n    // If the dirty flag is still set, the parent was not resized.\r\n    // Trigger the required update on the parent widget immediately.\r\n    if (this._dirty) {\r\n      MessageLoop.sendMessage(this.parent!, Widget.Msg.UpdateRequest);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the layout position and size of the widgets.\r\n   *\r\n   * The parent offset dimensions should be `-1` if unknown.\r\n   */\r\n  private _update(offsetWidth: number, offsetHeight: number): void {\r\n    // Clear the dirty flag to indicate the update occurred.\r\n    this._dirty = false;\r\n\r\n    // Compute the visible item count.\r\n    let nVisible = 0;\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      nVisible += +!this._items[i].isHidden;\r\n    }\r\n\r\n    // Bail early if there are no visible items to layout.\r\n    if (nVisible === 0) {\r\n      return;\r\n    }\r\n\r\n    // Measure the parent if the offset dimensions are unknown.\r\n    if (offsetWidth < 0) {\r\n      offsetWidth = this.parent!.node.offsetWidth;\r\n    }\r\n    if (offsetHeight < 0) {\r\n      offsetHeight = this.parent!.node.offsetHeight;\r\n    }\r\n\r\n    // Ensure the parent box sizing data is computed.\r\n    if (!this._box) {\r\n      this._box = ElementExt.boxSizing(this.parent!.node);\r\n    }\r\n\r\n    // Compute the layout area adjusted for border and padding.\r\n    let top = this._box.paddingTop;\r\n    let left = this._box.paddingLeft;\r\n    let width = offsetWidth - this._box.horizontalSum;\r\n    let height = offsetHeight - this._box.verticalSum;\r\n\r\n    // Distribute the layout space and adjust the start position.\r\n    let delta: number;\r\n    switch (this._direction) {\r\n    case 'left-to-right':\r\n      delta = BoxEngine.calc(this._sizers, Math.max(0, width - this._fixed));\r\n      break;\r\n    case 'top-to-bottom':\r\n      delta = BoxEngine.calc(this._sizers, Math.max(0, height - this._fixed));\r\n      break;\r\n    case 'right-to-left':\r\n      delta = BoxEngine.calc(this._sizers, Math.max(0, width - this._fixed));\r\n      left += width;\r\n      break;\r\n    case 'bottom-to-top':\r\n      delta = BoxEngine.calc(this._sizers, Math.max(0, height - this._fixed));\r\n      top += height;\r\n      break;\r\n    default:\r\n      throw 'unreachable';\r\n    }\r\n\r\n    // Setup the variables for justification and alignment offset.\r\n    let extra = 0;\r\n    let offset = 0;\r\n\r\n    // Account for alignment if there is extra layout space.\r\n    if (delta > 0) {\r\n      switch (this._alignment) {\r\n      case 'start':\r\n        break;\r\n      case 'center':\r\n        extra = 0;\r\n        offset = delta / 2;\r\n        break;\r\n      case 'end':\r\n        extra = 0;\r\n        offset = delta;\r\n        break;\r\n      case 'justify':\r\n        extra = delta / nVisible;\r\n        offset = 0;\r\n        break;\r\n      default:\r\n        throw 'unreachable';\r\n      }\r\n    }\r\n\r\n    // Layout the items using the computed box sizes.\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      // Fetch the item.\r\n      let item = this._items[i];\r\n\r\n      // Ignore hidden items.\r\n      if (item.isHidden) {\r\n        continue;\r\n      }\r\n\r\n      // Fetch the computed size for the widget.\r\n      let size = this._sizers[i].size;\r\n\r\n      // Update the widget geometry and advance the relevant edge.\r\n      switch (this._direction) {\r\n      case 'left-to-right':\r\n        item.update(left + offset, top, size + extra, height);\r\n        left += size + extra + this._spacing;\r\n        break;\r\n      case 'top-to-bottom':\r\n        item.update(left, top + offset, width, size + extra);\r\n        top += size + extra + this._spacing;\r\n        break;\r\n      case 'right-to-left':\r\n        item.update(left - offset - size - extra, top, size + extra, height);\r\n        left -= size + extra + this._spacing;\r\n        break;\r\n      case 'bottom-to-top':\r\n        item.update(left, top - offset - size - extra, width, size + extra);\r\n        top -= size + extra + this._spacing;\r\n        break;\r\n      default:\r\n        throw 'unreachable';\r\n      }\r\n    }\r\n  }\r\n\r\n  private _fixed = 0;\r\n  private _spacing = 4;\r\n  private _dirty = false;\r\n  private _sizers: BoxSizer[] = [];\r\n  private _items: LayoutItem[] = [];\r\n  private _box: ElementExt.IBoxSizing | null = null;\r\n  private _alignment: BoxLayout.Alignment = 'start';\r\n  private _direction: BoxLayout.Direction = 'top-to-bottom';\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `BoxLayout` class statics.\r\n */\r\nexport\r\nnamespace BoxLayout {\r\n  /**\r\n   * A type alias for a box layout direction.\r\n   */\r\n  export\r\n  type Direction = (\r\n    'left-to-right' | 'right-to-left' | 'top-to-bottom' | 'bottom-to-top'\r\n  );\r\n\r\n  /**\r\n   * A type alias for a box layout alignment.\r\n   */\r\n  export\r\n  type Alignment = 'start' | 'center' | 'end' | 'justify';\r\n\r\n  /**\r\n   * An options object for initializing a box layout.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The direction of the layout.\r\n     *\r\n     * The default is `'top-to-bottom'`.\r\n     */\r\n    direction?: Direction;\r\n\r\n    /**\r\n     * The content alignment of the layout.\r\n     *\r\n     * The default is `'start'`.\r\n     */\r\n    alignment?: Alignment;\r\n\r\n    /**\r\n     * The spacing between items in the layout.\r\n     *\r\n     * The default is `4`.\r\n     */\r\n    spacing?: number;\r\n  }\r\n\r\n  /**\r\n   * Get the box layout stretch factor for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The box layout stretch factor for the widget.\r\n   */\r\n  export\r\n  function getStretch(widget: Widget): number {\r\n    return Private.stretchProperty.get(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the box layout stretch factor for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the stretch factor.\r\n   */\r\n  export\r\n  function setStretch(widget: Widget, value: number): void {\r\n    Private.stretchProperty.set(widget, value);\r\n  }\r\n\r\n  /**\r\n   * Get the box layout size basis for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The box layout size basis for the widget.\r\n   */\r\n  export\r\n  function getSizeBasis(widget: Widget): number {\r\n    return Private.sizeBasisProperty.get(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the box layout size basis for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the size basis.\r\n   */\r\n  export\r\n  function setSizeBasis(widget: Widget, value: number): void {\r\n    Private.sizeBasisProperty.set(widget, value);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * The property descriptor for a widget stretch factor.\r\n   */\r\n  export\r\n  const stretchProperty = new AttachedProperty<Widget, number>({\r\n    name: 'stretch',\r\n    create: () => 0,\r\n    coerce: (owner, value) => Math.max(0, Math.floor(value)),\r\n    changed: onChildSizingChanged\r\n  });\r\n\r\n  /**\r\n   * The property descriptor for a widget size basis.\r\n   */\r\n  export\r\n  const sizeBasisProperty = new AttachedProperty<Widget, number>({\r\n    name: 'sizeBasis',\r\n    create: () => 0,\r\n    coerce: (owner, value) => Math.max(0, Math.floor(value)),\r\n    changed: onChildSizingChanged\r\n  });\r\n\r\n  /**\r\n   * Test whether a direction has horizontal orientation.\r\n   */\r\n  export\r\n  function isHorizontal(dir: BoxLayout.Direction): boolean {\r\n    return dir === 'left-to-right' || dir === 'right-to-left';\r\n  }\r\n\r\n  /**\r\n   * Clamp a spacing value to an integer >= 0.\r\n   */\r\n  export\r\n  function clampSpacing(value: number): number {\r\n    return Math.max(0, Math.floor(value));\r\n  }\r\n\r\n  /**\r\n   * The change handler for the attached sizing properties.\r\n   */\r\n  function onChildSizingChanged(child: Widget): void {\r\n    if (child.parent && child.parent.layout instanceof BoxLayout) {\r\n      child.parent.fit();\r\n    }\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  PanelLayout\r\n} from './panellayout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A simple and convenient panel widget class.\r\n *\r\n * #### Notes\r\n * This class is suitable as a base class for implementing a variety of\r\n * convenience panel widgets, but can also be used directly with CSS to\r\n * arrange a collection of widgets.\r\n *\r\n * This class provides a convenience wrapper around a [[PanelLayout]].\r\n */\r\nexport\r\nclass Panel extends Widget {\r\n  /**\r\n   * Construct a new panel.\r\n   *\r\n   * @param options - The options for initializing the panel.\r\n   */\r\n  constructor(options: Panel.IOptions = {}) {\r\n    super();\r\n    this.addClass('lm-Panel');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-Panel');\r\n    /* </DEPRECATED> */\r\n    this.layout = Private.createLayout(options);\r\n  }\r\n\r\n  /**\r\n   * A read-only array of the widgets in the panel.\r\n   */\r\n  get widgets(): ReadonlyArray<Widget> {\r\n    return (this.layout as PanelLayout).widgets;\r\n  }\r\n\r\n  /**\r\n   * Add a widget to the end of the panel.\r\n   *\r\n   * @param widget - The widget to add to the panel.\r\n   *\r\n   * #### Notes\r\n   * If the widget is already contained in the panel, it will be moved.\r\n   */\r\n  addWidget(widget: Widget): void {\r\n    (this.layout as PanelLayout).addWidget(widget);\r\n  }\r\n\r\n  /**\r\n   * Insert a widget at the specified index.\r\n   *\r\n   * @param index - The index at which to insert the widget.\r\n   *\r\n   * @param widget - The widget to insert into to the panel.\r\n   *\r\n   * #### Notes\r\n   * If the widget is already contained in the panel, it will be moved.\r\n   */\r\n  insertWidget(index: number, widget: Widget): void {\r\n    (this.layout as PanelLayout).insertWidget(index, widget);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `Panel` class statics.\r\n */\r\nexport\r\nnamespace Panel {\r\n  /**\r\n   * An options object for creating a panel.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The panel layout to use for the panel.\r\n     *\r\n     * The default is a new `PanelLayout`.\r\n     */\r\n    layout?: PanelLayout;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * Create a panel layout for the given panel options.\r\n   */\r\n  export\r\n  function createLayout(options: Panel.IOptions): PanelLayout {\r\n    return options.layout || new PanelLayout();\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  BoxLayout\r\n} from './boxlayout';\r\n\r\nimport {\r\n  Panel\r\n} from './panel';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A panel which arranges its widgets in a single row or column.\r\n *\r\n * #### Notes\r\n * This class provides a convenience wrapper around a [[BoxLayout]].\r\n */\r\nexport\r\nclass BoxPanel extends Panel {\r\n  /**\r\n   * Construct a new box panel.\r\n   *\r\n   * @param options - The options for initializing the box panel.\r\n   */\r\n  constructor(options: BoxPanel.IOptions = {}) {\r\n    super({ layout: Private.createLayout(options) });\r\n    this.addClass('lm-BoxPanel');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-BoxPanel');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * Get the layout direction for the box panel.\r\n   */\r\n  get direction(): BoxPanel.Direction {\r\n    return (this.layout as BoxLayout).direction;\r\n  }\r\n\r\n  /**\r\n   * Set the layout direction for the box panel.\r\n   */\r\n  set direction(value: BoxPanel.Direction) {\r\n    (this.layout as BoxLayout).direction = value;\r\n  }\r\n\r\n  /**\r\n   * Get the content alignment for the box panel.\r\n   *\r\n   * #### Notes\r\n   * This is the alignment of the widgets in the layout direction.\r\n   *\r\n   * The alignment has no effect if the widgets can expand to fill the\r\n   * entire box layout.\r\n   */\r\n  get alignment(): BoxPanel.Alignment {\r\n    return (this.layout as BoxLayout).alignment;\r\n  }\r\n\r\n  /**\r\n   * Set the content alignment for the box panel.\r\n   *\r\n   * #### Notes\r\n   * This is the alignment of the widgets in the layout direction.\r\n   *\r\n   * The alignment has no effect if the widgets can expand to fill the\r\n   * entire box layout.\r\n   */\r\n  set alignment(value: BoxPanel.Alignment) {\r\n    (this.layout as BoxLayout).alignment = value;\r\n  }\r\n\r\n  /**\r\n   * Get the inter-element spacing for the box panel.\r\n   */\r\n  get spacing(): number {\r\n    return (this.layout as BoxLayout).spacing;\r\n  }\r\n\r\n  /**\r\n   * Set the inter-element spacing for the box panel.\r\n   */\r\n  set spacing(value: number) {\r\n    (this.layout as BoxLayout).spacing = value;\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-added'` message.\r\n   */\r\n  protected onChildAdded(msg: Widget.ChildMessage): void {\r\n    msg.child.addClass('lm-BoxPanel-child');\r\n    /* <DEPRECATED> */\r\n    msg.child.addClass('p-BoxPanel-child');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-removed'` message.\r\n   */\r\n  protected onChildRemoved(msg: Widget.ChildMessage): void {\r\n    msg.child.removeClass('lm-BoxPanel-child');\r\n    /* <DEPRECATED> */\r\n    msg.child.removeClass('p-BoxPanel-child');\r\n    /* </DEPRECATED> */\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `BoxPanel` class statics.\r\n */\r\nexport\r\nnamespace BoxPanel {\r\n  /**\r\n   * A type alias for a box panel direction.\r\n   */\r\n  export\r\n  type Direction = BoxLayout.Direction;\r\n\r\n  /**\r\n   * A type alias for a box panel alignment.\r\n   */\r\n  export\r\n  type Alignment = BoxLayout.Alignment;\r\n\r\n  /**\r\n   * An options object for initializing a box panel.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The layout direction of the panel.\r\n     *\r\n     * The default is `'top-to-bottom'`.\r\n     */\r\n    direction?: Direction;\r\n\r\n    /**\r\n     * The content alignment of the panel.\r\n     *\r\n     * The default is `'start'`.\r\n     */\r\n    alignment?: Alignment;\r\n\r\n    /**\r\n     * The spacing between items in the panel.\r\n     *\r\n     * The default is `4`.\r\n     */\r\n    spacing?: number;\r\n\r\n    /**\r\n     * The box layout to use for the box panel.\r\n     *\r\n     * If this is provided, the other options are ignored.\r\n     *\r\n     * The default is a new `BoxLayout`.\r\n     */\r\n    layout?: BoxLayout;\r\n  }\r\n\r\n  /**\r\n   * Get the box panel stretch factor for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The box panel stretch factor for the widget.\r\n   */\r\n  export\r\n  function getStretch(widget: Widget): number {\r\n    return BoxLayout.getStretch(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the box panel stretch factor for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the stretch factor.\r\n   */\r\n  export\r\n  function setStretch(widget: Widget, value: number): void {\r\n    BoxLayout.setStretch(widget, value);\r\n  }\r\n\r\n  /**\r\n   * Get the box panel size basis for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The box panel size basis for the widget.\r\n   */\r\n  export\r\n  function getSizeBasis(widget: Widget): number {\r\n    return BoxLayout.getSizeBasis(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the box panel size basis for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the size basis.\r\n   */\r\n  export\r\n  function setSizeBasis(widget: Widget, value: number): void {\r\n    BoxLayout.setSizeBasis(widget, value);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * Create a box layout for the given panel options.\r\n   */\r\n  export\r\n  function createLayout(options: BoxPanel.IOptions): BoxLayout {\r\n    return options.layout || new BoxLayout(options);\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, StringExt\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  JSONExt, ReadonlyJSONObject\r\n} from '@lumino/coreutils';\r\n\r\nimport {\r\n  CommandRegistry\r\n} from '@lumino/commands';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Message\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  ElementDataset, VirtualDOM, VirtualElement, h\r\n} from '@lumino/virtualdom';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A widget which displays command items as a searchable palette.\r\n */\r\nexport\r\nclass CommandPalette extends Widget {\r\n  /**\r\n   * Construct a new command palette.\r\n   *\r\n   * @param options - The options for initializing the palette.\r\n   */\r\n  constructor(options: CommandPalette.IOptions) {\r\n    super({ node: Private.createNode() });\r\n    this.addClass('lm-CommandPalette');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-CommandPalette');\r\n    /* </DEPRECATED> */\r\n    this.setFlag(Widget.Flag.DisallowLayout);\r\n    this.commands = options.commands;\r\n    this.renderer = options.renderer || CommandPalette.defaultRenderer;\r\n    this.commands.commandChanged.connect(this._onGenericChange, this);\r\n    this.commands.keyBindingChanged.connect(this._onGenericChange, this);\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the widget.\r\n   */\r\n  dispose(): void {\r\n    this._items.length = 0;\r\n    this._results = null;\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * The command registry used by the command palette.\r\n   */\r\n  readonly commands: CommandRegistry;\r\n\r\n  /**\r\n   * The renderer used by the command palette.\r\n   */\r\n  readonly renderer: CommandPalette.IRenderer;\r\n\r\n  /**\r\n   * The command palette search node.\r\n   *\r\n   * #### Notes\r\n   * This is the node which contains the search-related elements.\r\n   */\r\n  get searchNode(): HTMLDivElement {\r\n    return this.node.getElementsByClassName('lm-CommandPalette-search')[0] as HTMLDivElement;\r\n  }\r\n\r\n  /**\r\n   * The command palette input node.\r\n   *\r\n   * #### Notes\r\n   * This is the actual input node for the search area.\r\n   */\r\n  get inputNode(): HTMLInputElement {\r\n    return this.node.getElementsByClassName('lm-CommandPalette-input')[0] as HTMLInputElement;\r\n  }\r\n\r\n  /**\r\n   * The command palette content node.\r\n   *\r\n   * #### Notes\r\n   * This is the node which holds the command item nodes.\r\n   *\r\n   * Modifying this node directly can lead to undefined behavior.\r\n   */\r\n  get contentNode(): HTMLUListElement {\r\n    return this.node.getElementsByClassName('lm-CommandPalette-content')[0] as HTMLUListElement;\r\n  }\r\n\r\n  /**\r\n   * A read-only array of the command items in the palette.\r\n   */\r\n  get items(): ReadonlyArray<CommandPalette.IItem> {\r\n    return this._items;\r\n  }\r\n\r\n  /**\r\n   * Add a command item to the command palette.\r\n   *\r\n   * @param options - The options for creating the command item.\r\n   *\r\n   * @returns The command item added to the palette.\r\n   */\r\n  addItem(options: CommandPalette.IItemOptions): CommandPalette.IItem {\r\n    // Create a new command item for the options.\r\n    let item = Private.createItem(this.commands, options);\r\n\r\n    // Add the item to the array.\r\n    this._items.push(item);\r\n\r\n    // Refresh the search results.\r\n    this.refresh();\r\n\r\n    // Return the item added to the palette.\r\n    return item;\r\n  }\r\n\r\n  /**\r\n   * Adds command items to the command palette.\r\n   *\r\n   * @param items - An array of options for creating each command item.\r\n   *\r\n   * @returns The command items added to the palette.\r\n   */\r\n  addItems(items: CommandPalette.IItemOptions[]): CommandPalette.IItem[] {\r\n    const newItems = items.map(item => Private.createItem(this.commands, item));\r\n    newItems.forEach(item => this._items.push(item));\r\n    this.refresh();\r\n    return newItems;\r\n  }\r\n\r\n  /**\r\n   * Remove an item from the command palette.\r\n   *\r\n   * @param item - The item to remove from the palette.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the item is not in the palette.\r\n   */\r\n  removeItem(item: CommandPalette.IItem): void {\r\n    this.removeItemAt(this._items.indexOf(item));\r\n  }\r\n\r\n  /**\r\n   * Remove the item at a given index from the command palette.\r\n   *\r\n   * @param index - The index of the item to remove.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the index is out of range.\r\n   */\r\n  removeItemAt(index: number): void {\r\n    // Remove the item from the array.\r\n    let item = ArrayExt.removeAt(this._items, index);\r\n\r\n    // Bail if the index is out of range.\r\n    if (!item) {\r\n      return;\r\n    }\r\n\r\n    // Refresh the search results.\r\n    this.refresh();\r\n  }\r\n\r\n  /**\r\n   * Remove all items from the command palette.\r\n   */\r\n  clearItems(): void {\r\n    // Bail if there is nothing to remove.\r\n    if (this._items.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Clear the array of items.\r\n    this._items.length = 0;\r\n\r\n    // Refresh the search results.\r\n    this.refresh();\r\n  }\r\n\r\n  /**\r\n   * Clear the search results and schedule an update.\r\n   *\r\n   * #### Notes\r\n   * This should be called whenever the search results of the palette\r\n   * should be updated.\r\n   *\r\n   * This is typically called automatically by the palette as needed,\r\n   * but can be called manually if the input text is programatically\r\n   * changed.\r\n   *\r\n   * The rendered results are updated asynchronously.\r\n   */\r\n  refresh(): void {\r\n    this._results = null;\r\n    if(this.inputNode.value !== '') {\r\n      let clear = this.node.getElementsByClassName('lm-close-icon')[0] as HTMLInputElement;\r\n      clear.style.display = 'inherit'\r\n    }\r\n    else {\r\n      let clear = this.node.getElementsByClassName('lm-close-icon')[0] as HTMLInputElement;\r\n      clear.style.display = 'none'\r\n    }\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Handle the DOM events for the command palette.\r\n   *\r\n   * @param event - The DOM event sent to the command palette.\r\n   *\r\n   * #### Notes\r\n   * This method implements the DOM `EventListener` interface and is\r\n   * called in response to events on the command palette's DOM node.\r\n   * It should not be called directly by user code.\r\n   */\r\n  handleEvent(event: Event): void {\r\n    switch (event.type) {\r\n    case 'click':\r\n      this._evtClick(event as MouseEvent);\r\n      break;\r\n    case 'keydown':\r\n      this._evtKeyDown(event as KeyboardEvent);\r\n      break;\r\n    case 'input':\r\n      this.refresh();\r\n      break;\r\n    case 'focus':\r\n    case 'blur':\r\n      this._toggleFocused();\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    this.node.addEventListener('click', this);\r\n    this.node.addEventListener('keydown', this);\r\n    this.node.addEventListener('input', this);\r\n    this.node.addEventListener('focus', this, true);\r\n    this.node.addEventListener('blur', this, true);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-detach'` message.\r\n   */\r\n  protected onAfterDetach(msg: Message): void {\r\n    this.node.removeEventListener('click', this);\r\n    this.node.removeEventListener('keydown', this);\r\n    this.node.removeEventListener('input', this);\r\n    this.node.removeEventListener('focus', this, true);\r\n    this.node.removeEventListener('blur', this, true);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'activate-request'` message.\r\n   */\r\n  protected onActivateRequest(msg: Message): void {\r\n    if (this.isAttached) {\r\n      let input = this.inputNode;\r\n      input.focus();\r\n      input.select();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    // Fetch the current query text and content node.\r\n    let query = this.inputNode.value;\r\n    let contentNode = this.contentNode;\r\n\r\n    // Ensure the search results are generated.\r\n    let results = this._results;\r\n    if (!results) {\r\n      // Generate and store the new search results.\r\n      results = this._results = Private.search(this._items, query);\r\n\r\n      // Reset the active index.\r\n      this._activeIndex = (\r\n        query ? ArrayExt.findFirstIndex(results, Private.canActivate) : -1\r\n      );\r\n    }\r\n\r\n    // If there is no query and no results, clear the content.\r\n    if (!query && results.length === 0) {\r\n      VirtualDOM.render(null, contentNode);\r\n      return;\r\n    }\r\n\r\n    // If the is a query but no results, render the empty message.\r\n    if (query && results.length === 0) {\r\n      let content = this.renderer.renderEmptyMessage({ query });\r\n      VirtualDOM.render(content, contentNode);\r\n      return;\r\n    }\r\n\r\n    // Create the render content for the search results.\r\n    let renderer = this.renderer;\r\n    let activeIndex = this._activeIndex;\r\n    let content = new Array<VirtualElement>(results.length);\r\n    for (let i = 0, n = results.length; i < n; ++i) {\r\n      let result = results[i];\r\n      if (result.type === 'header') {\r\n        let indices = result.indices;\r\n        let category = result.category;\r\n        content[i] = renderer.renderHeader({ category, indices });\r\n      } else {\r\n        let item = result.item;\r\n        let indices = result.indices;\r\n        let active = i === activeIndex;\r\n        content[i] = renderer.renderItem({ item, indices, active });\r\n      }\r\n    }\r\n\r\n    // Render the search result content.\r\n    VirtualDOM.render(content, contentNode);\r\n\r\n    // Adjust the scroll position as needed.\r\n    if (activeIndex < 0 || activeIndex >= results.length) {\r\n      contentNode.scrollTop = 0;\r\n    } else {\r\n      let element = contentNode.children[activeIndex];\r\n      ElementExt.scrollIntoViewIfNeeded(contentNode, element);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'click'` event for the command palette.\r\n   */\r\n  private _evtClick(event: MouseEvent): void {\r\n    // Bail if the click is not the left button.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Clear input if the target is clear button\r\n    if((event.target as HTMLElement).classList.contains(\"lm-close-icon\")) {\r\n      this.inputNode.value = '';\r\n      this.refresh();\r\n      return;\r\n    }\r\n\r\n    // Find the index of the item which was clicked.\r\n    let index = ArrayExt.findFirstIndex(this.contentNode.children, node => {\r\n      return node.contains(event.target as HTMLElement);\r\n    });\r\n\r\n    // Bail if the click was not on an item.\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    // Kill the event when a content item is clicked.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Execute the item if possible.\r\n    this._execute(index);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'keydown'` event for the command palette.\r\n   */\r\n  private _evtKeyDown(event: KeyboardEvent): void {\r\n    if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) {\r\n      return;\r\n    }\r\n    switch (event.keyCode) {\r\n    case 13:  // Enter\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      this._execute(this._activeIndex);\r\n      break;\r\n    case 38:  // Up Arrow\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      this._activatePreviousItem();\r\n      break;\r\n    case 40:  // Down Arrow\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      this._activateNextItem();\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Activate the next enabled command item.\r\n   */\r\n  private _activateNextItem(): void {\r\n    // Bail if there are no search results.\r\n    if (!this._results || this._results.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Find the next enabled item index.\r\n    let ai = this._activeIndex;\r\n    let n = this._results.length;\r\n    let start = ai < n - 1 ? ai + 1 : 0;\r\n    let stop = start === 0 ? n - 1 : start - 1;\r\n    this._activeIndex = ArrayExt.findFirstIndex(\r\n      this._results, Private.canActivate, start, stop\r\n    );\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Activate the previous enabled command item.\r\n   */\r\n  private _activatePreviousItem(): void {\r\n    // Bail if there are no search results.\r\n    if (!this._results || this._results.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Find the previous enabled item index.\r\n    let ai = this._activeIndex;\r\n    let n = this._results.length;\r\n    let start = ai <= 0 ? n - 1 : ai - 1;\r\n    let stop = start === n - 1 ? 0 : start + 1;\r\n    this._activeIndex = ArrayExt.findLastIndex(\r\n      this._results, Private.canActivate, start, stop\r\n    );\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Execute the command item at the given index, if possible.\r\n   */\r\n  private _execute(index: number): void {\r\n    // Bail if there are no search results.\r\n    if (!this._results) {\r\n      return;\r\n    }\r\n\r\n    // Bail if the index is out of range.\r\n    let part = this._results[index];\r\n    if (!part) {\r\n      return;\r\n    }\r\n\r\n    // Update the search text if the item is a header.\r\n    if (part.type === 'header') {\r\n      let input = this.inputNode;\r\n      input.value = `${part.category.toLowerCase()} `;\r\n      input.focus();\r\n      this.refresh();\r\n      return;\r\n    }\r\n\r\n    // Bail if item is not enabled.\r\n    if (!part.item.isEnabled) {\r\n      return;\r\n    }\r\n\r\n    // Execute the item.\r\n    this.commands.execute(part.item.command, part.item.args);\r\n\r\n    // Clear the query text.\r\n    this.inputNode.value = '';\r\n\r\n    // Refresh the search results.\r\n    this.refresh();\r\n  }\r\n\r\n  /**\r\n   * Toggle the focused modifier based on the input node focus state.\r\n   */\r\n  private _toggleFocused(): void {\r\n    let focused = document.activeElement === this.inputNode;\r\n    this.toggleClass('lm-mod-focused', focused);\r\n    /* <DEPRECATED> */\r\n    this.toggleClass('p-mod-focused', focused);\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * A signal handler for generic command changes.\r\n   */\r\n  private _onGenericChange(): void {\r\n    this.refresh();\r\n  }\r\n\r\n  private _activeIndex = -1;\r\n  private _items: CommandPalette.IItem[] = [];\r\n  private _results: Private.SearchResult[] | null = null;\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `CommandPalette` class statics.\r\n */\r\nexport\r\nnamespace CommandPalette {\r\n  /**\r\n   * An options object for creating a command palette.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The command registry for use with the command palette.\r\n     */\r\n    commands: CommandRegistry;\r\n\r\n    /**\r\n     * A custom renderer for use with the command palette.\r\n     *\r\n     * The default is a shared renderer instance.\r\n     */\r\n    renderer?: IRenderer;\r\n  }\r\n\r\n  /**\r\n   * An options object for creating a command item.\r\n   */\r\n  export\r\n  interface IItemOptions {\r\n    /**\r\n     * The category for the item.\r\n     */\r\n    category: string;\r\n\r\n    /**\r\n     * The command to execute when the item is triggered.\r\n     */\r\n    command: string;\r\n\r\n    /**\r\n     * The arguments for the command.\r\n     *\r\n     * The default value is an empty object.\r\n     */\r\n    args?: ReadonlyJSONObject;\r\n\r\n    /**\r\n     * The rank for the command item.\r\n     *\r\n     * The rank is used as a tie-breaker when ordering command items\r\n     * for display. Items are sorted in the following order:\r\n     *   1. Text match (lower is better)\r\n     *   2. Category (locale order)\r\n     *   3. Rank (lower is better)\r\n     *   4. Label (locale order)\r\n     *\r\n     * The default rank is `Infinity`.\r\n     */\r\n    rank?: number;\r\n  }\r\n\r\n  /**\r\n   * An object which represents an item in a command palette.\r\n   *\r\n   * #### Notes\r\n   * Item objects are created automatically by a command palette.\r\n   */\r\n  export\r\n  interface IItem {\r\n    /**\r\n     * The command to execute when the item is triggered.\r\n     */\r\n    readonly command: string;\r\n\r\n    /**\r\n     * The arguments for the command.\r\n     */\r\n    readonly args: ReadonlyJSONObject;\r\n\r\n    /**\r\n     * The category for the command item.\r\n     */\r\n    readonly category: string;\r\n\r\n    /**\r\n     * The rank for the command item.\r\n     */\r\n    readonly rank: number;\r\n\r\n    /**\r\n     * The display label for the command item.\r\n     */\r\n    readonly label: string;\r\n\r\n    /**\r\n     * The display caption for the command item.\r\n     */\r\n    readonly caption: string;\r\n\r\n    /**\r\n     * The icon renderer for the command item.\r\n     */\r\n    readonly icon: VirtualElement.IRenderer | undefined\r\n    /* <DEPRECATED> */ | string /* </DEPRECATED> */;\r\n\r\n    /**\r\n     * The icon class for the command item.\r\n     */\r\n    readonly iconClass: string;\r\n\r\n    /**\r\n     * The icon label for the command item.\r\n     */\r\n    readonly iconLabel: string;\r\n\r\n    /**\r\n     * The extra class name for the command item.\r\n     */\r\n    readonly className: string;\r\n\r\n    /**\r\n     * The dataset for the command item.\r\n     */\r\n    readonly dataset: CommandRegistry.Dataset;\r\n\r\n    /**\r\n     * Whether the command item is enabled.\r\n     */\r\n    readonly isEnabled: boolean;\r\n\r\n    /**\r\n     * Whether the command item is toggled.\r\n     */\r\n    readonly isToggled: boolean;\r\n\r\n    /**\r\n     * Whether the command item is toggleable.\r\n     */\r\n    readonly isToggleable: boolean;\r\n\r\n    /**\r\n     * Whether the command item is visible.\r\n     */\r\n    readonly isVisible: boolean;\r\n\r\n    /**\r\n     * The key binding for the command item.\r\n     */\r\n    readonly keyBinding: CommandRegistry.IKeyBinding | null;\r\n  }\r\n\r\n  /**\r\n   * The render data for a command palette header.\r\n   */\r\n  export\r\n  interface IHeaderRenderData {\r\n    /**\r\n     * The category of the header.\r\n     */\r\n    readonly category: string;\r\n\r\n    /**\r\n     * The indices of the matched characters in the category.\r\n     */\r\n    readonly indices: ReadonlyArray<number> | null;\r\n  }\r\n\r\n  /**\r\n   * The render data for a command palette item.\r\n   */\r\n  export\r\n  interface IItemRenderData {\r\n    /**\r\n     * The command palette item to render.\r\n     */\r\n    readonly item: IItem;\r\n\r\n    /**\r\n     * The indices of the matched characters in the label.\r\n     */\r\n    readonly indices: ReadonlyArray<number> | null;\r\n\r\n    /**\r\n     * Whether the item is the active item.\r\n     */\r\n    readonly active: boolean;\r\n  }\r\n\r\n  /**\r\n   * The render data for a command palette empty message.\r\n   */\r\n  export\r\n  interface IEmptyMessageRenderData {\r\n    /**\r\n     * The query which failed to match any commands.\r\n     */\r\n    query: string;\r\n  }\r\n\r\n  /**\r\n   * A renderer for use with a command palette.\r\n   */\r\n  export\r\n  interface IRenderer {\r\n    /**\r\n     * Render the virtual element for a command palette header.\r\n     *\r\n     * @param data - The data to use for rendering the header.\r\n     *\r\n     * @returns A virtual element representing the header.\r\n     */\r\n    renderHeader(data: IHeaderRenderData): VirtualElement;\r\n\r\n    /**\r\n     * Render the virtual element for a command palette item.\r\n     *\r\n     * @param data - The data to use for rendering the item.\r\n     *\r\n     * @returns A virtual element representing the item.\r\n     *\r\n     * #### Notes\r\n     * The command palette will not render invisible items.\r\n     */\r\n    renderItem(data: IItemRenderData): VirtualElement;\r\n\r\n    /**\r\n     * Render the empty results message for a command palette.\r\n     *\r\n     * @param data - The data to use for rendering the message.\r\n     *\r\n     * @returns A virtual element representing the message.\r\n     */\r\n    renderEmptyMessage(data: IEmptyMessageRenderData): VirtualElement;\r\n  }\r\n\r\n  /**\r\n   * The default implementation of `IRenderer`.\r\n   */\r\n  export\r\n  class Renderer implements IRenderer {\r\n    /**\r\n     * Render the virtual element for a command palette header.\r\n     *\r\n     * @param data - The data to use for rendering the header.\r\n     *\r\n     * @returns A virtual element representing the header.\r\n     */\r\n    renderHeader(data: IHeaderRenderData): VirtualElement {\r\n      let content = this.formatHeader(data);\r\n      return h.li({ className:\r\n        'lm-CommandPalette-header'\r\n          /* <DEPRECATED> */\r\n          + ' p-CommandPalette-header'\r\n          /* </DEPRECATED> */\r\n      }, content);\r\n    }\r\n\r\n    /**\r\n     * Render the virtual element for a command palette item.\r\n     *\r\n     * @param data - The data to use for rendering the item.\r\n     *\r\n     * @returns A virtual element representing the item.\r\n     */\r\n    renderItem(data: IItemRenderData): VirtualElement {\r\n      let className = this.createItemClass(data);\r\n      let dataset = this.createItemDataset(data);\r\n      if (data.item.isToggleable) {\r\n        return (\r\n          h.li({\r\n            className,\r\n            dataset,\r\n            role: 'checkbox',\r\n            'aria-checked': `${data.item.isToggled}`\r\n          },\r\n          this.renderItemIcon(data),\r\n          this.renderItemContent(data),\r\n          this.renderItemShortcut(data))\r\n        )\r\n      }\r\n      return (\r\n        h.li({\r\n            className,\r\n            dataset\r\n          },\r\n          this.renderItemIcon(data),\r\n          this.renderItemContent(data),\r\n          this.renderItemShortcut(data),\r\n        )\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Render the empty results message for a command palette.\r\n     *\r\n     * @param data - The data to use for rendering the message.\r\n     *\r\n     * @returns A virtual element representing the message.\r\n     */\r\n    renderEmptyMessage(data: IEmptyMessageRenderData): VirtualElement {\r\n      let content = this.formatEmptyMessage(data);\r\n      return h.li({\r\n        className: 'lm-CommandPalette-emptyMessage'\r\n          /* <DEPRECATED> */\r\n          + ' p-CommandPalette-emptyMessage'\r\n          /* </DEPRECATED> */\r\n      }, content);\r\n    }\r\n\r\n    /**\r\n     * Render the icon for a command palette item.\r\n     *\r\n     * @param data - The data to use for rendering the icon.\r\n     *\r\n     * @returns A virtual element representing the icon.\r\n     */\r\n    renderItemIcon(data: IItemRenderData): VirtualElement {\r\n      let className = this.createIconClass(data);\r\n\r\n      /* <DEPRECATED> */\r\n      if (typeof data.item.icon === 'string') {\r\n        return h.div({className}, data.item.iconLabel);\r\n      }\r\n      /* </DEPRECATED> */\r\n\r\n      // if data.item.icon is undefined, it will be ignored\r\n      return h.div({className}, data.item.icon!, data.item.iconLabel);\r\n    }\r\n\r\n    /**\r\n     * Render the content for a command palette item.\r\n     *\r\n     * @param data - The data to use for rendering the content.\r\n     *\r\n     * @returns A virtual element representing the content.\r\n     */\r\n    renderItemContent(data: IItemRenderData): VirtualElement {\r\n      return (\r\n        h.div({\r\n          className: 'lm-CommandPalette-itemContent'\r\n            /* <DEPRECATED> */\r\n            + ' p-CommandPalette-itemContent'\r\n            /* </DEPRECATED> */\r\n        },\r\n          this.renderItemLabel(data),\r\n          this.renderItemCaption(data)\r\n        )\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Render the label for a command palette item.\r\n     *\r\n     * @param data - The data to use for rendering the label.\r\n     *\r\n     * @returns A virtual element representing the label.\r\n     */\r\n    renderItemLabel(data: IItemRenderData): VirtualElement {\r\n      let content = this.formatItemLabel(data);\r\n      return h.div({\r\n        className: 'lm-CommandPalette-itemLabel'\r\n          /* <DEPRECATED> */\r\n          + ' p-CommandPalette-itemLabel'\r\n          /* </DEPRECATED> */\r\n      }, content);\r\n    }\r\n\r\n    /**\r\n     * Render the caption for a command palette item.\r\n     *\r\n     * @param data - The data to use for rendering the caption.\r\n     *\r\n     * @returns A virtual element representing the caption.\r\n     */\r\n    renderItemCaption(data: IItemRenderData): VirtualElement {\r\n      let content = this.formatItemCaption(data);\r\n      return h.div({\r\n        className: 'lm-CommandPalette-itemCaption'\r\n          /* <DEPRECATED> */\r\n          + ' p-CommandPalette-itemCaption'\r\n          /* </DEPRECATED> */\r\n      }, content);\r\n    }\r\n\r\n    /**\r\n     * Render the shortcut for a command palette item.\r\n     *\r\n     * @param data - The data to use for rendering the shortcut.\r\n     *\r\n     * @returns A virtual element representing the shortcut.\r\n     */\r\n    renderItemShortcut(data: IItemRenderData): VirtualElement {\r\n      let content = this.formatItemShortcut(data);\r\n      return h.div({\r\n        className: 'lm-CommandPalette-itemShortcut'\r\n          /* <DEPRECATED> */\r\n          + ' p-CommandPalette-itemShortcut'\r\n          /* </DEPRECATED> */\r\n      }, content);\r\n    }\r\n\r\n    /**\r\n     * Create the class name for the command palette item.\r\n     *\r\n     * @param data - The data to use for the class name.\r\n     *\r\n     * @returns The full class name for the command palette item.\r\n     */\r\n    createItemClass(data: IItemRenderData): string {\r\n      // Set up the initial class name.\r\n      let name = 'lm-CommandPalette-item';\r\n      /* <DEPRECATED> */\r\n      name += ' p-CommandPalette-item';\r\n      /* </DEPRECATED> */\r\n\r\n      // Add the boolean state classes.\r\n      if (!data.item.isEnabled) {\r\n        name += ' lm-mod-disabled';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-disabled';\r\n        /* </DEPRECATED> */\r\n      }\r\n      if (data.item.isToggled) {\r\n        name += ' lm-mod-toggled';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-toggled';\r\n        /* </DEPRECATED> */\r\n      }\r\n      if (data.active) {\r\n        name += ' lm-mod-active';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-active';\r\n        /* </DEPRECATED> */\r\n      }\r\n\r\n      // Add the extra class.\r\n      let extra = data.item.className;\r\n      if (extra) {\r\n        name += ` ${extra}`;\r\n      }\r\n\r\n      // Return the complete class name.\r\n      return name;\r\n    }\r\n\r\n    /**\r\n     * Create the dataset for the command palette item.\r\n     *\r\n     * @param data - The data to use for creating the dataset.\r\n     *\r\n     * @returns The dataset for the command palette item.\r\n     */\r\n    createItemDataset(data: IItemRenderData): ElementDataset {\r\n      return { ...data.item.dataset, command: data.item.command };\r\n    }\r\n\r\n    /**\r\n     * Create the class name for the command item icon.\r\n     *\r\n     * @param data - The data to use for the class name.\r\n     *\r\n     * @returns The full class name for the item icon.\r\n     */\r\n    createIconClass(data: IItemRenderData): string {\r\n      let name = 'lm-CommandPalette-itemIcon';\r\n      /* <DEPRECATED> */\r\n      name += ' p-CommandPalette-itemIcon';\r\n      /* </DEPRECATED> */\r\n      let extra = data.item.iconClass;\r\n      return extra ? `${name} ${extra}` : name;\r\n    }\r\n\r\n    /**\r\n     * Create the render content for the header node.\r\n     *\r\n     * @param data - The data to use for the header content.\r\n     *\r\n     * @returns The content to add to the header node.\r\n     */\r\n    formatHeader(data: IHeaderRenderData): h.Child {\r\n      if (!data.indices || data.indices.length === 0) {\r\n        return data.category;\r\n      }\r\n      return StringExt.highlight(data.category, data.indices, h.mark);\r\n    }\r\n\r\n    /**\r\n     * Create the render content for the empty message node.\r\n     *\r\n     * @param data - The data to use for the empty message content.\r\n     *\r\n     * @returns The content to add to the empty message node.\r\n     */\r\n    formatEmptyMessage(data: IEmptyMessageRenderData): h.Child {\r\n      return `No commands found that match '${data.query}'`;\r\n    }\r\n\r\n    /**\r\n     * Create the render content for the item shortcut node.\r\n     *\r\n     * @param data - The data to use for the shortcut content.\r\n     *\r\n     * @returns The content to add to the shortcut node.\r\n     */\r\n    formatItemShortcut(data: IItemRenderData): h.Child {\r\n      let kb = data.item.keyBinding;\r\n      return kb ? kb.keys.map(CommandRegistry.formatKeystroke).join(', ') : null;\r\n    }\r\n\r\n    /**\r\n     * Create the render content for the item label node.\r\n     *\r\n     * @param data - The data to use for the label content.\r\n     *\r\n     * @returns The content to add to the label node.\r\n     */\r\n    formatItemLabel(data: IItemRenderData): h.Child {\r\n      if (!data.indices || data.indices.length === 0) {\r\n        return data.item.label;\r\n      }\r\n      return StringExt.highlight(data.item.label, data.indices, h.mark);\r\n    }\r\n\r\n    /**\r\n     * Create the render content for the item caption node.\r\n     *\r\n     * @param data - The data to use for the caption content.\r\n     *\r\n     * @returns The content to add to the caption node.\r\n     */\r\n    formatItemCaption(data: IItemRenderData): h.Child {\r\n      return data.item.caption;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The default `Renderer` instance.\r\n   */\r\n  export\r\n  const defaultRenderer = new Renderer();\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * Create the DOM node for a command palette.\r\n   */\r\n  export\r\n  function createNode(): HTMLDivElement {\r\n    let node = document.createElement('div');\r\n    let search = document.createElement('div');\r\n    let wrapper = document.createElement('div');\r\n    let input = document.createElement('input');\r\n    let content = document.createElement('ul');\r\n    let clear = document.createElement('button');\r\n    search.className = 'lm-CommandPalette-search';\r\n    wrapper.className = 'lm-CommandPalette-wrapper';\r\n    input.className = 'lm-CommandPalette-input';\r\n    clear.className = 'lm-close-icon';\r\n\r\n    content.className = 'lm-CommandPalette-content';\r\n    /* <DEPRECATED> */\r\n    search.classList.add('p-CommandPalette-search');\r\n    wrapper.classList.add('p-CommandPalette-wrapper');\r\n    input.classList.add('p-CommandPalette-input');\r\n    content.classList.add('p-CommandPalette-content');\r\n    /* </DEPRECATED> */\r\n    input.spellcheck = false;\r\n    wrapper.appendChild(input);\r\n    wrapper.appendChild(clear);\r\n    search.appendChild(wrapper);\r\n    node.appendChild(search);\r\n    node.appendChild(content);\r\n    return node;\r\n  }\r\n\r\n  /**\r\n   * Create a new command item from a command registry and options.\r\n   */\r\n  export\r\n  function createItem(commands: CommandRegistry, options: CommandPalette.IItemOptions): CommandPalette.IItem {\r\n    return new CommandItem(commands, options);\r\n  }\r\n\r\n  /**\r\n   * A search result object for a header label.\r\n   */\r\n  export\r\n  interface IHeaderResult {\r\n    /**\r\n     * The discriminated type of the object.\r\n     */\r\n    readonly type: 'header';\r\n\r\n    /**\r\n     * The category for the header.\r\n     */\r\n    readonly category: string;\r\n\r\n    /**\r\n     * The indices of the matched category characters.\r\n     */\r\n    readonly indices: ReadonlyArray<number> | null;\r\n  }\r\n\r\n  /**\r\n   * A search result object for a command item.\r\n   */\r\n  export\r\n  interface IItemResult {\r\n    /**\r\n     * The discriminated type of the object.\r\n     */\r\n    readonly type: 'item';\r\n\r\n    /**\r\n     * The command item which was matched.\r\n     */\r\n    readonly item: CommandPalette.IItem;\r\n\r\n    /**\r\n     * The indices of the matched label characters.\r\n     */\r\n    readonly indices: ReadonlyArray<number> | null;\r\n  }\r\n\r\n  /**\r\n   * A type alias for a search result item.\r\n   */\r\n  export\r\n  type SearchResult = IHeaderResult | IItemResult;\r\n\r\n  /**\r\n   * Search an array of command items for fuzzy matches.\r\n   */\r\n  export\r\n  function search(items: CommandPalette.IItem[], query: string): SearchResult[] {\r\n    // Fuzzy match the items for the query.\r\n    let scores = matchItems(items, query);\r\n\r\n    // Sort the items based on their score.\r\n    scores.sort(scoreCmp);\r\n\r\n    // Create the results for the search.\r\n    return createResults(scores);\r\n  }\r\n\r\n  /**\r\n   * Test whether a result item can be activated.\r\n   */\r\n  export\r\n  function canActivate(result: SearchResult): boolean {\r\n    return result.type === 'item' && result.item.isEnabled;\r\n  }\r\n\r\n  /**\r\n   * Normalize a category for a command item.\r\n   */\r\n  function normalizeCategory(category: string): string {\r\n    return category.trim().replace(/\\s+/g, ' ');\r\n  }\r\n\r\n  /**\r\n   * Normalize the query text for a fuzzy search.\r\n   */\r\n  function normalizeQuery(text: string): string {\r\n    return text.replace(/\\s+/g, '').toLowerCase();\r\n  }\r\n\r\n  /**\r\n   * An enum of the supported match types.\r\n   */\r\n  const enum MatchType { Label, Category, Split, Default }\r\n\r\n  /**\r\n   * A text match score with associated command item.\r\n   */\r\n  interface IScore {\r\n    /**\r\n     * The numerical type for the text match.\r\n     */\r\n    matchType: MatchType;\r\n\r\n    /**\r\n     * The numerical score for the text match.\r\n     */\r\n    score: number;\r\n\r\n    /**\r\n     * The indices of the matched category characters.\r\n     */\r\n    categoryIndices: number[] | null;\r\n\r\n    /**\r\n     * The indices of the matched label characters.\r\n     */\r\n    labelIndices: number[] | null;\r\n\r\n    /**\r\n     * The command item associated with the match.\r\n     */\r\n    item: CommandPalette.IItem;\r\n  }\r\n\r\n  /**\r\n   * Perform a fuzzy match on an array of command items.\r\n   */\r\n  function matchItems(items: CommandPalette.IItem[], query: string): IScore[] {\r\n    // Normalize the query text to lower case with no whitespace.\r\n    query = normalizeQuery(query);\r\n\r\n    // Create the array to hold the scores.\r\n    let scores: IScore[] = [];\r\n\r\n    // Iterate over the items and match against the query.\r\n    for (let i = 0, n = items.length; i < n; ++i) {\r\n      // Ignore items which are not visible.\r\n      let item = items[i];\r\n      if (!item.isVisible) {\r\n        continue;\r\n      }\r\n\r\n      // If the query is empty, all items are matched by default.\r\n      if (!query) {\r\n        scores.push({\r\n          matchType: MatchType.Default,\r\n          categoryIndices: null,\r\n          labelIndices: null,\r\n          score: 0, item\r\n        });\r\n        continue;\r\n      }\r\n\r\n      // Run the fuzzy search for the item and query.\r\n      let score = fuzzySearch(item, query);\r\n\r\n      // Ignore the item if it is not a match.\r\n      if (!score) {\r\n        continue;\r\n      }\r\n\r\n      // Penalize disabled items.\r\n      // TODO - push disabled items all the way down in sort cmp?\r\n      if (!item.isEnabled) {\r\n        score.score += 1000;\r\n      }\r\n\r\n      // Add the score to the results.\r\n      scores.push(score);\r\n    }\r\n\r\n    // Return the final array of scores.\r\n    return scores;\r\n  }\r\n\r\n  /**\r\n   * Perform a fuzzy search on a single command item.\r\n   */\r\n  function fuzzySearch(item: CommandPalette.IItem, query: string): IScore | null {\r\n    // Create the source text to be searched.\r\n    let category = item.category.toLowerCase();\r\n    let label = item.label.toLowerCase();\r\n    let source = `${category} ${label}`;\r\n\r\n    // Set up the match score and indices array.\r\n    let score = Infinity;\r\n    let indices: number[] | null = null;\r\n\r\n    // The regex for search word boundaries\r\n    let rgx = /\\b\\w/g;\r\n\r\n    // Search the source by word boundary.\r\n    while (true) {\r\n      // Find the next word boundary in the source.\r\n      let rgxMatch = rgx.exec(source);\r\n\r\n      // Break if there is no more source context.\r\n      if (!rgxMatch) {\r\n        break;\r\n      }\r\n\r\n      // Run the string match on the relevant substring.\r\n      let match = StringExt.matchSumOfDeltas(source, query, rgxMatch.index);\r\n\r\n      // Break if there is no match.\r\n      if (!match) {\r\n        break;\r\n      }\r\n\r\n      // Update the match if the score is better.\r\n      if (match && match.score <= score) {\r\n        score = match.score;\r\n        indices = match.indices;\r\n      }\r\n    }\r\n\r\n    // Bail if there was no match.\r\n    if (!indices || score === Infinity) {\r\n      return null;\r\n    }\r\n\r\n    // Compute the pivot index between category and label text.\r\n    let pivot = category.length + 1;\r\n\r\n    // Find the slice index to separate matched indices.\r\n    let j = ArrayExt.lowerBound(indices, pivot, (a, b) => a - b);\r\n\r\n    // Extract the matched category and label indices.\r\n    let categoryIndices = indices.slice(0, j);\r\n    let labelIndices = indices.slice(j);\r\n\r\n    // Adjust the label indices for the pivot offset.\r\n    for (let i = 0, n = labelIndices.length; i < n; ++i) {\r\n      labelIndices[i] -= pivot;\r\n    }\r\n\r\n    // Handle a pure label match.\r\n    if (categoryIndices.length === 0) {\r\n      return {\r\n        matchType: MatchType.Label,\r\n        categoryIndices: null,\r\n        labelIndices,\r\n        score, item\r\n      };\r\n    }\r\n\r\n    // Handle a pure category match.\r\n    if (labelIndices.length === 0) {\r\n      return {\r\n        matchType: MatchType.Category,\r\n        categoryIndices,\r\n        labelIndices: null,\r\n        score, item\r\n      };\r\n    }\r\n\r\n    // Handle a split match.\r\n    return {\r\n      matchType: MatchType.Split,\r\n      categoryIndices,\r\n      labelIndices,\r\n      score, item\r\n    };\r\n  }\r\n\r\n  /**\r\n   * A sort comparison function for a match score.\r\n   */\r\n  function scoreCmp(a: IScore, b: IScore): number {\r\n    // First compare based on the match type\r\n    let m1 = a.matchType - b.matchType;\r\n    if (m1 !== 0) {\r\n      return m1;\r\n    }\r\n\r\n    // Otherwise, compare based on the match score.\r\n    let d1 = a.score - b.score;\r\n    if (d1 !== 0) {\r\n      return d1;\r\n    }\r\n\r\n    // Find the match index based on the match type.\r\n    let i1 = 0;\r\n    let i2 = 0;\r\n    switch (a.matchType) {\r\n    case MatchType.Label:\r\n      i1 = a.labelIndices![0];\r\n      i2 = b.labelIndices![0];\r\n      break;\r\n    case MatchType.Category:\r\n    case MatchType.Split:\r\n      i1 = a.categoryIndices![0];\r\n      i2 = b.categoryIndices![0];\r\n      break;\r\n    }\r\n\r\n    // Compare based on the match index.\r\n    if (i1 !== i2) {\r\n      return i1 - i2;\r\n    }\r\n\r\n    // Otherwise, compare by category.\r\n    let d2 = a.item.category.localeCompare(b.item.category);\r\n    if (d2 !== 0) {\r\n      return d2;\r\n    }\r\n\r\n    // Otherwise, compare by rank.\r\n    let r1 = a.item.rank;\r\n    let r2 = b.item.rank;\r\n    if (r1 !== r2) {\r\n      return r1 < r2 ? -1 : 1;  // Infinity safe\r\n    }\r\n\r\n    // Finally, compare by label.\r\n    return a.item.label.localeCompare(b.item.label);\r\n  }\r\n\r\n  /**\r\n   * Create the results from an array of sorted scores.\r\n   */\r\n  function createResults(scores: IScore[]): SearchResult[] {\r\n    // Set up an array to track which scores have been visited.\r\n    let visited = new Array(scores.length);\r\n    ArrayExt.fill(visited, false);\r\n\r\n    // Set up the search results array.\r\n    let results: SearchResult[] = [];\r\n\r\n    // Iterate over each score in the array.\r\n    for (let i = 0, n = scores.length; i < n; ++i) {\r\n      // Ignore a score which has already been processed.\r\n      if (visited[i]) {\r\n        continue;\r\n      }\r\n\r\n      // Extract the current item and indices.\r\n      let { item, categoryIndices } = scores[i];\r\n\r\n      // Extract the category for the current item.\r\n      let category = item.category;\r\n\r\n      // Add the header result for the category.\r\n      results.push({ type: 'header', category, indices: categoryIndices });\r\n\r\n      // Find the rest of the scores with the same category.\r\n      for (let j = i; j < n; ++j) {\r\n        // Ignore a score which has already been processed.\r\n        if (visited[j]) {\r\n          continue;\r\n        }\r\n\r\n        // Extract the data for the current score.\r\n        let { item, labelIndices } = scores[j];\r\n\r\n        // Ignore an item with a different category.\r\n        if (item.category !== category) {\r\n          continue;\r\n        }\r\n\r\n        // Create the item result for the score.\r\n        results.push({ type: 'item', item, indices: labelIndices });\r\n\r\n        // Mark the score as processed.\r\n        visited[j] = true;\r\n      }\r\n    }\r\n\r\n    // Return the final results.\r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * A concrete implementation of `CommandPalette.IItem`.\r\n   */\r\n  class CommandItem implements CommandPalette.IItem {\r\n    /**\r\n     * Construct a new command item.\r\n     */\r\n    constructor(commands: CommandRegistry, options: CommandPalette.IItemOptions) {\r\n      this._commands = commands;\r\n      this.category = normalizeCategory(options.category);\r\n      this.command = options.command;\r\n      this.args = options.args || JSONExt.emptyObject;\r\n      this.rank = options.rank !== undefined ? options.rank : Infinity;\r\n    }\r\n\r\n    /**\r\n     * The category for the command item.\r\n     */\r\n    readonly category: string;\r\n\r\n    /**\r\n     * The command to execute when the item is triggered.\r\n     */\r\n    readonly command: string;\r\n\r\n    /**\r\n     * The arguments for the command.\r\n     */\r\n    readonly args: ReadonlyJSONObject;\r\n\r\n    /**\r\n     * The rank for the command item.\r\n     */\r\n    readonly rank: number;\r\n\r\n    /**\r\n     * The display label for the command item.\r\n     */\r\n    get label(): string {\r\n      return this._commands.label(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * The icon renderer for the command item.\r\n     */\r\n    get icon(): VirtualElement.IRenderer | undefined\r\n    /* <DEPRECATED> */ | string /* </DEPRECATED> */\r\n    {\r\n      return this._commands.icon(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * The icon class for the command item.\r\n     */\r\n    get iconClass(): string {\r\n      return this._commands.iconClass(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * The icon label for the command item.\r\n     */\r\n    get iconLabel(): string {\r\n      return this._commands.iconLabel(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * The display caption for the command item.\r\n     */\r\n    get caption(): string {\r\n      return this._commands.caption(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * The extra class name for the command item.\r\n     */\r\n    get className(): string {\r\n      return this._commands.className(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * The dataset for the command item.\r\n     */\r\n    get dataset(): CommandRegistry.Dataset {\r\n      return this._commands.dataset(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * Whether the command item is enabled.\r\n     */\r\n    get isEnabled(): boolean {\r\n      return this._commands.isEnabled(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * Whether the command item is toggled.\r\n     */\r\n    get isToggled(): boolean {\r\n      return this._commands.isToggled(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * Whether the command item is toggleable.\r\n     */\r\n    get isToggleable(): boolean {\r\n      return this._commands.isToggleable(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * Whether the command item is visible.\r\n     */\r\n    get isVisible(): boolean {\r\n      return this._commands.isVisible(this.command, this.args);\r\n    }\r\n\r\n    /**\r\n     * The key binding for the command item.\r\n     */\r\n    get keyBinding(): CommandRegistry.IKeyBinding | null {\r\n      let { command, args } = this;\r\n      return ArrayExt.findLastValue(this._commands.keyBindings, kb => {\r\n        return kb.command === command && JSONExt.deepEqual(kb.args, args);\r\n      }) || null;\r\n    }\r\n\r\n    private _commands: CommandRegistry;\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  CommandRegistry\r\n} from '@lumino/commands';\r\n\r\nimport {\r\n  JSONExt, ReadonlyJSONObject\r\n} from '@lumino/coreutils';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  getKeyboardLayout\r\n} from '@lumino/keyboard';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  ARIAAttrNames, ElementARIAAttrs, ElementDataset, VirtualDOM, VirtualElement, h\r\n} from '@lumino/virtualdom';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A widget which displays items as a canonical menu.\r\n */\r\nexport\r\nclass Menu extends Widget {\r\n  /**\r\n   * Construct a new menu.\r\n   *\r\n   * @param options - The options for initializing the menu.\r\n   */\r\n  constructor(options: Menu.IOptions) {\r\n    super({ node: Private.createNode() });\r\n    this.addClass('lm-Menu');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-Menu');\r\n    /* </DEPRECATED> */\r\n    this.setFlag(Widget.Flag.DisallowLayout);\r\n    this.commands = options.commands;\r\n    this.renderer = options.renderer || Menu.defaultRenderer;\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the menu.\r\n   */\r\n  dispose(): void {\r\n    this.close();\r\n    this._items.length = 0;\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * A signal emitted just before the menu is closed.\r\n   *\r\n   * #### Notes\r\n   * This signal is emitted when the menu receives a `'close-request'`\r\n   * message, just before it removes itself from the DOM.\r\n   *\r\n   * This signal is not emitted if the menu is already detached from\r\n   * the DOM when it receives the `'close-request'` message.\r\n   */\r\n  get aboutToClose(): ISignal<this, void> {\r\n    return this._aboutToClose;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when a new menu is requested by the user.\r\n   *\r\n   * #### Notes\r\n   * This signal is emitted whenever the user presses the right or left\r\n   * arrow keys, and a submenu cannot be opened or closed in response.\r\n   *\r\n   * This signal is useful when implementing menu bars in order to open\r\n   * the next or previous menu in response to a user key press.\r\n   *\r\n   * This signal is only emitted for the root menu in a hierarchy.\r\n   */\r\n  get menuRequested(): ISignal<this, 'next' | 'previous'> {\r\n    return this._menuRequested;\r\n  }\r\n\r\n  /**\r\n   * The command registry used by the menu.\r\n   */\r\n  readonly commands: CommandRegistry;\r\n\r\n  /**\r\n   * The renderer used by the menu.\r\n   */\r\n  readonly renderer: Menu.IRenderer;\r\n\r\n  /**\r\n   * The parent menu of the menu.\r\n   *\r\n   * #### Notes\r\n   * This is `null` unless the menu is an open submenu.\r\n   */\r\n  get parentMenu(): Menu | null {\r\n    return this._parentMenu;\r\n  }\r\n\r\n  /**\r\n   * The child menu of the menu.\r\n   *\r\n   * #### Notes\r\n   * This is `null` unless the menu has an open submenu.\r\n   */\r\n  get childMenu(): Menu | null {\r\n    return this._childMenu;\r\n  }\r\n\r\n  /**\r\n   * The root menu of the menu hierarchy.\r\n   */\r\n  get rootMenu(): Menu {\r\n    let menu: Menu = this;\r\n    while (menu._parentMenu) {\r\n      menu = menu._parentMenu;\r\n    }\r\n    return menu;\r\n  }\r\n\r\n  /**\r\n   * The leaf menu of the menu hierarchy.\r\n   */\r\n  get leafMenu(): Menu {\r\n    let menu: Menu = this;\r\n    while (menu._childMenu) {\r\n      menu = menu._childMenu;\r\n    }\r\n    return menu;\r\n  }\r\n\r\n  /**\r\n   * The menu content node.\r\n   *\r\n   * #### Notes\r\n   * This is the node which holds the menu item nodes.\r\n   *\r\n   * Modifying this node directly can lead to undefined behavior.\r\n   */\r\n  get contentNode(): HTMLUListElement {\r\n    return this.node.getElementsByClassName('lm-Menu-content')[0] as HTMLUListElement;\r\n  }\r\n\r\n  /**\r\n   * Get the currently active menu item.\r\n   */\r\n  get activeItem(): Menu.IItem | null {\r\n    return this._items[this._activeIndex] || null;\r\n  }\r\n\r\n  /**\r\n   * Set the currently active menu item.\r\n   *\r\n   * #### Notes\r\n   * If the item cannot be activated, the item will be set to `null`.\r\n   */\r\n  set activeItem(value: Menu.IItem | null) {\r\n    this.activeIndex = value ? this._items.indexOf(value) : -1;\r\n  }\r\n\r\n  /**\r\n   * Get the index of the currently active menu item.\r\n   *\r\n   * #### Notes\r\n   * This will be `-1` if no menu item is active.\r\n   */\r\n  get activeIndex(): number {\r\n    return this._activeIndex;\r\n  }\r\n\r\n  /**\r\n   * Set the index of the currently active menu item.\r\n   *\r\n   * #### Notes\r\n   * If the item cannot be activated, the index will be set to `-1`.\r\n   */\r\n  set activeIndex(value: number) {\r\n    // Adjust the value for an out of range index.\r\n    if (value < 0 || value >= this._items.length) {\r\n      value = -1;\r\n    }\r\n\r\n    // Ensure the item can be activated.\r\n    if (value !== -1 && !Private.canActivate(this._items[value])) {\r\n      value = -1;\r\n    }\r\n\r\n    // Bail if the index will not change.\r\n    if (this._activeIndex === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the active index.\r\n    this._activeIndex = value;\r\n\r\n    // schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * A read-only array of the menu items in the menu.\r\n   */\r\n  get items(): ReadonlyArray<Menu.IItem> {\r\n    return this._items;\r\n  }\r\n\r\n  /**\r\n   * Activate the next selectable item in the menu.\r\n   *\r\n   * #### Notes\r\n   * If no item is selectable, the index will be set to `-1`.\r\n   */\r\n  activateNextItem(): void {\r\n    let n = this._items.length;\r\n    let ai = this._activeIndex;\r\n    let start = ai < n - 1 ? ai + 1 : 0;\r\n    let stop = start === 0 ? n - 1 : start - 1;\r\n    this.activeIndex = ArrayExt.findFirstIndex(\r\n      this._items, Private.canActivate, start, stop\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Activate the previous selectable item in the menu.\r\n   *\r\n   * #### Notes\r\n   * If no item is selectable, the index will be set to `-1`.\r\n   */\r\n  activatePreviousItem(): void {\r\n    let n = this._items.length;\r\n    let ai = this._activeIndex;\r\n    let start = ai <= 0 ? n - 1 : ai - 1;\r\n    let stop = start === n - 1 ? 0 : start + 1;\r\n    this.activeIndex = ArrayExt.findLastIndex(\r\n      this._items, Private.canActivate, start, stop\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Trigger the active menu item.\r\n   *\r\n   * #### Notes\r\n   * If the active item is a submenu, it will be opened and the first\r\n   * item will be activated.\r\n   *\r\n   * If the active item is a command, the command will be executed.\r\n   *\r\n   * If the menu is not attached, this is a no-op.\r\n   *\r\n   * If there is no active item, this is a no-op.\r\n   */\r\n  triggerActiveItem(): void {\r\n    // Bail if the menu is not attached.\r\n    if (!this.isAttached) {\r\n      return;\r\n    }\r\n\r\n    // Bail if there is no active item.\r\n    let item = this.activeItem;\r\n    if (!item) {\r\n      return;\r\n    }\r\n\r\n    // Cancel the pending timers.\r\n    this._cancelOpenTimer();\r\n    this._cancelCloseTimer();\r\n\r\n    // If the item is a submenu, open it.\r\n    if (item.type === 'submenu') {\r\n      this._openChildMenu(true);\r\n      return;\r\n    }\r\n\r\n    // Close the root menu before executing the command.\r\n    this.rootMenu.close();\r\n\r\n    // Execute the command for the item.\r\n    let { command, args } = item;\r\n    if (this.commands.isEnabled(command, args)) {\r\n      this.commands.execute(command, args);\r\n    } else {\r\n      console.log(`Command '${command}' is disabled.`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a menu item to the end of the menu.\r\n   *\r\n   * @param options - The options for creating the menu item.\r\n   *\r\n   * @returns The menu item added to the menu.\r\n   */\r\n  addItem(options: Menu.IItemOptions): Menu.IItem {\r\n    return this.insertItem(this._items.length, options);\r\n  }\r\n\r\n  /**\r\n   * Insert a menu item into the menu at the specified index.\r\n   *\r\n   * @param index - The index at which to insert the item.\r\n   *\r\n   * @param options - The options for creating the menu item.\r\n   *\r\n   * @returns The menu item added to the menu.\r\n   *\r\n   * #### Notes\r\n   * The index will be clamped to the bounds of the items.\r\n   */\r\n  insertItem(index: number, options: Menu.IItemOptions): Menu.IItem {\r\n    // Close the menu if it's attached.\r\n    if (this.isAttached) {\r\n      this.close();\r\n    }\r\n\r\n    // Reset the active index.\r\n    this.activeIndex = -1;\r\n\r\n    // Clamp the insert index to the array bounds.\r\n    let i = Math.max(0, Math.min(index, this._items.length));\r\n\r\n    // Create the item for the options.\r\n    let item = Private.createItem(this, options);\r\n\r\n    // Insert the item into the array.\r\n    ArrayExt.insert(this._items, i, item);\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n\r\n    // Return the item added to the menu.\r\n    return item;\r\n  }\r\n\r\n  /**\r\n   * Remove an item from the menu.\r\n   *\r\n   * @param item - The item to remove from the menu.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the item is not in the menu.\r\n   */\r\n  removeItem(item: Menu.IItem): void {\r\n    this.removeItemAt(this._items.indexOf(item));\r\n  }\r\n\r\n  /**\r\n   * Remove the item at a given index from the menu.\r\n   *\r\n   * @param index - The index of the item to remove.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the index is out of range.\r\n   */\r\n  removeItemAt(index: number): void {\r\n    // Close the menu if it's attached.\r\n    if (this.isAttached) {\r\n      this.close();\r\n    }\r\n\r\n    // Reset the active index.\r\n    this.activeIndex = -1;\r\n\r\n    // Remove the item from the array.\r\n    let item = ArrayExt.removeAt(this._items, index);\r\n\r\n    // Bail if the index is out of range.\r\n    if (!item) {\r\n      return\r\n    }\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Remove all menu items from the menu.\r\n   */\r\n  clearItems(): void {\r\n    // Close the menu if it's attached.\r\n    if (this.isAttached) {\r\n      this.close();\r\n    }\r\n\r\n    // Reset the active index.\r\n    this.activeIndex = -1;\r\n\r\n    // Bail if there is nothing to remove.\r\n    if (this._items.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Clear the items.\r\n    this._items.length = 0;\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Open the menu at the specified location.\r\n   *\r\n   * @param x - The client X coordinate of the menu location.\r\n   *\r\n   * @param y - The client Y coordinate of the menu location.\r\n   *\r\n   * @param options - The additional options for opening the menu.\r\n   *\r\n   * #### Notes\r\n   * The menu will be opened at the given location unless it will not\r\n   * fully fit on the screen. If it will not fit, it will be adjusted\r\n   * to fit naturally on the screen.\r\n   *\r\n   * This is a no-op if the menu is already attached to the DOM.\r\n   */\r\n  open(x: number, y: number, options: Menu.IOpenOptions = {}): void {\r\n    // Bail early if the menu is already attached.\r\n    if (this.isAttached) {\r\n      return;\r\n    }\r\n\r\n    // Extract the position options.\r\n    let forceX = options.forceX || false;\r\n    let forceY = options.forceY || false;\r\n\r\n    // Open the menu as a root menu.\r\n    Private.openRootMenu(this, x, y, forceX, forceY);\r\n\r\n    // Activate the menu to accept keyboard input.\r\n    this.activate();\r\n  }\r\n\r\n  /**\r\n   * Handle the DOM events for the menu.\r\n   *\r\n   * @param event - The DOM event sent to the menu.\r\n   *\r\n   * #### Notes\r\n   * This method implements the DOM `EventListener` interface and is\r\n   * called in response to events on the menu's DOM nodes. It should\r\n   * not be called directly by user code.\r\n   */\r\n  handleEvent(event: Event): void {\r\n    switch (event.type) {\r\n    case 'keydown':\r\n      this._evtKeyDown(event as KeyboardEvent);\r\n      break;\r\n    case 'mouseup':\r\n      this._evtMouseUp(event as MouseEvent);\r\n      break;\r\n    case 'mousemove':\r\n      this._evtMouseMove(event as MouseEvent);\r\n      break;\r\n    case 'mouseenter':\r\n      this._evtMouseEnter(event as MouseEvent);\r\n      break;\r\n    case 'mouseleave':\r\n      this._evtMouseLeave(event as MouseEvent);\r\n      break;\r\n    case 'mousedown':\r\n      this._evtMouseDown(event as MouseEvent);\r\n      break;\r\n    case 'contextmenu':\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    this.node.addEventListener('keydown', this);\r\n    this.node.addEventListener('mouseup', this);\r\n    this.node.addEventListener('mousemove', this);\r\n    this.node.addEventListener('mouseenter', this);\r\n    this.node.addEventListener('mouseleave', this);\r\n    this.node.addEventListener('contextmenu', this);\r\n    document.addEventListener('mousedown', this, true);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-detach'` message.\r\n   */\r\n  protected onAfterDetach(msg: Message): void {\r\n    this.node.removeEventListener('keydown', this);\r\n    this.node.removeEventListener('mouseup', this);\r\n    this.node.removeEventListener('mousemove', this);\r\n    this.node.removeEventListener('mouseenter', this);\r\n    this.node.removeEventListener('mouseleave', this);\r\n    this.node.removeEventListener('contextmenu', this);\r\n    document.removeEventListener('mousedown', this, true);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'activate-request'` message.\r\n   */\r\n  protected onActivateRequest(msg: Message): void {\r\n    if (this.isAttached) {\r\n      this.node.focus();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    let items = this._items;\r\n    let renderer = this.renderer;\r\n    let activeIndex = this._activeIndex;\r\n    let collapsedFlags = Private.computeCollapsed(items);\r\n    let content = new Array<VirtualElement>(items.length);\r\n    for (let i = 0, n = items.length; i < n; ++i) {\r\n      let item = items[i];\r\n      let active = i === activeIndex;\r\n      let collapsed = collapsedFlags[i];\r\n      content[i] = renderer.renderItem({ item, active, collapsed });\r\n    }\r\n    VirtualDOM.render(content, this.contentNode);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'close-request'` message.\r\n   */\r\n  protected onCloseRequest(msg: Message): void {\r\n    // Cancel the pending timers.\r\n    this._cancelOpenTimer();\r\n    this._cancelCloseTimer();\r\n\r\n    // Reset the active index.\r\n    this.activeIndex = -1;\r\n\r\n    // Close any open child menu.\r\n    let childMenu = this._childMenu;\r\n    if (childMenu) {\r\n      this._childIndex = -1;\r\n      this._childMenu = null;\r\n      childMenu._parentMenu = null;\r\n      childMenu.close();\r\n    }\r\n\r\n    // Remove this menu from its parent and activate the parent.\r\n    let parentMenu = this._parentMenu;\r\n    if (parentMenu) {\r\n      this._parentMenu = null;\r\n      parentMenu._childIndex = -1;\r\n      parentMenu._childMenu = null;\r\n      parentMenu.activate();\r\n    }\r\n\r\n    // Emit the `aboutToClose` signal if the menu is attached.\r\n    if (this.isAttached) {\r\n      this._aboutToClose.emit(undefined);\r\n    }\r\n\r\n    // Finish closing the menu.\r\n    super.onCloseRequest(msg);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'keydown'` event for the menu.\r\n   *\r\n   * #### Notes\r\n   * This listener is attached to the menu node.\r\n   */\r\n  private _evtKeyDown(event: KeyboardEvent): void {\r\n    // A menu handles all keydown events.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Fetch the key code for the event.\r\n    let kc = event.keyCode;\r\n\r\n    // Enter\r\n    if (kc === 13) {\r\n      this.triggerActiveItem();\r\n      return;\r\n    }\r\n\r\n    // Escape\r\n    if (kc === 27) {\r\n      this.close();\r\n      return;\r\n    }\r\n\r\n    // Left Arrow\r\n    if (kc === 37) {\r\n      if (this._parentMenu) {\r\n        this.close();\r\n      } else {\r\n        this._menuRequested.emit('previous');\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Up Arrow\r\n    if (kc === 38) {\r\n      this.activatePreviousItem();\r\n      return;\r\n    }\r\n\r\n    // Right Arrow\r\n    if (kc === 39) {\r\n      let item = this.activeItem;\r\n      if (item && item.type === 'submenu') {\r\n        this.triggerActiveItem();\r\n      } else {\r\n        this.rootMenu._menuRequested.emit('next');\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Down Arrow\r\n    if (kc === 40) {\r\n      this.activateNextItem();\r\n      return;\r\n    }\r\n\r\n    // Get the pressed key character.\r\n    let key = getKeyboardLayout().keyForKeydownEvent(event);\r\n\r\n    // Bail if the key is not valid.\r\n    if (!key) {\r\n      return;\r\n    }\r\n\r\n    // Search for the next best matching mnemonic item.\r\n    let start = this._activeIndex + 1;\r\n    let result = Private.findMnemonic(this._items, key, start);\r\n\r\n    // Handle the requested mnemonic based on the search results.\r\n    // If exactly one mnemonic is matched, that item is triggered.\r\n    // Otherwise, the next mnemonic is activated if available,\r\n    // followed by the auto mnemonic if available.\r\n    if (result.index !== -1 && !result.multiple) {\r\n      this.activeIndex = result.index;\r\n      this.triggerActiveItem();\r\n    } else if (result.index !== -1) {\r\n      this.activeIndex = result.index;\r\n    } else if (result.auto !== -1) {\r\n      this.activeIndex = result.auto;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mouseup'` event for the menu.\r\n   *\r\n   * #### Notes\r\n   * This listener is attached to the menu node.\r\n   */\r\n  private _evtMouseUp(event: MouseEvent): void {\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    this.triggerActiveItem();\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousemove'` event for the menu.\r\n   *\r\n   * #### Notes\r\n   * This listener is attached to the menu node.\r\n   */\r\n  private _evtMouseMove(event: MouseEvent): void {\r\n    // Hit test the item nodes for the item under the mouse.\r\n    let index = ArrayExt.findFirstIndex(this.contentNode.children, node => {\r\n      return ElementExt.hitTest(node, event.clientX, event.clientY);\r\n    });\r\n\r\n    // Bail early if the mouse is already over the active index.\r\n    if (index === this._activeIndex) {\r\n      return;\r\n    }\r\n\r\n    // Update and coerce the active index.\r\n    this.activeIndex = index;\r\n    index = this.activeIndex;\r\n\r\n    // If the index is the current child index, cancel the timers.\r\n    if (index === this._childIndex) {\r\n      this._cancelOpenTimer();\r\n      this._cancelCloseTimer();\r\n      return;\r\n    }\r\n\r\n    // If a child menu is currently open, start the close timer.\r\n    if (this._childIndex !== -1) {\r\n      this._startCloseTimer();\r\n    }\r\n\r\n    // Cancel the open timer to give a full delay for opening.\r\n    this._cancelOpenTimer();\r\n\r\n    // Bail if the active item is not a valid submenu item.\r\n    let item = this.activeItem;\r\n    if (!item || item.type !== 'submenu' || !item.submenu) {\r\n      return;\r\n    }\r\n\r\n    // Start the open timer to open the active item submenu.\r\n    this._startOpenTimer();\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mouseenter'` event for the menu.\r\n   *\r\n   * #### Notes\r\n   * This listener is attached to the menu node.\r\n   */\r\n  private _evtMouseEnter(event: MouseEvent): void {\r\n    // Synchronize the active ancestor items.\r\n    for (let menu = this._parentMenu; menu; menu = menu._parentMenu) {\r\n      menu._cancelOpenTimer();\r\n      menu._cancelCloseTimer();\r\n      menu.activeIndex = menu._childIndex;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mouseleave'` event for the menu.\r\n   *\r\n   * #### Notes\r\n   * This listener is attached to the menu node.\r\n   */\r\n  private _evtMouseLeave(event: MouseEvent): void {\r\n    // Cancel any pending submenu opening.\r\n    this._cancelOpenTimer();\r\n\r\n    // If there is no open child menu, just reset the active index.\r\n    if (!this._childMenu) {\r\n      this.activeIndex = -1;\r\n      return;\r\n    }\r\n\r\n    // If the mouse is over the child menu, cancel the close timer.\r\n    let { clientX, clientY } = event;\r\n    if (ElementExt.hitTest(this._childMenu.node, clientX, clientY)) {\r\n      this._cancelCloseTimer();\r\n      return;\r\n    }\r\n\r\n    // Otherwise, reset the active index and start the close timer.\r\n    this.activeIndex = -1;\r\n    this._startCloseTimer();\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousedown'` event for the menu.\r\n   *\r\n   * #### Notes\r\n   * This listener is attached to the document node.\r\n   */\r\n  private _evtMouseDown(event: MouseEvent): void {\r\n    // Bail if the menu is not a root menu.\r\n    if (this._parentMenu) {\r\n      return;\r\n    }\r\n\r\n    // The mouse button which is pressed is irrelevant. If the press\r\n    // is not on a menu, the entire hierarchy is closed and the event\r\n    // is allowed to propagate. This allows other code to act on the\r\n    // event, such as focusing the clicked element.\r\n    if (Private.hitTestMenus(this, event.clientX, event.clientY)) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    } else {\r\n      this.close();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Open the child menu at the active index immediately.\r\n   *\r\n   * If a different child menu is already open, it will be closed,\r\n   * even if the active item is not a valid submenu.\r\n   */\r\n  private _openChildMenu(activateFirst = false): void {\r\n    // If the item is not a valid submenu, close the child menu.\r\n    let item = this.activeItem;\r\n    if (!item || item.type !== 'submenu' || !item.submenu) {\r\n      this._closeChildMenu();\r\n      return;\r\n    }\r\n\r\n    // Do nothing if the child menu will not change.\r\n    let submenu = item.submenu;\r\n    if (submenu === this._childMenu) {\r\n      return;\r\n    }\r\n\r\n    // Ensure the current child menu is closed.\r\n    this._closeChildMenu();\r\n\r\n    // Update the private child state.\r\n    this._childMenu = submenu;\r\n    this._childIndex = this._activeIndex;\r\n\r\n    // Set the parent menu reference for the child.\r\n    submenu._parentMenu = this;\r\n\r\n    // Ensure the menu is updated and lookup the item node.\r\n    MessageLoop.sendMessage(this, Widget.Msg.UpdateRequest);\r\n    let itemNode = this.contentNode.children[this._activeIndex];\r\n\r\n    // Open the submenu at the active node.\r\n    Private.openSubmenu(submenu, itemNode as HTMLElement);\r\n\r\n    // Activate the first item if desired.\r\n    if (activateFirst) {\r\n      submenu.activeIndex = -1;\r\n      submenu.activateNextItem();\r\n    }\r\n\r\n    // Activate the child menu.\r\n    submenu.activate();\r\n  }\r\n\r\n  /**\r\n   * Close the child menu immediately.\r\n   *\r\n   * This is a no-op if a child menu is not open.\r\n   */\r\n  private _closeChildMenu(): void {\r\n    if (this._childMenu) {\r\n      this._childMenu.close();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start the open timer, unless it is already pending.\r\n   */\r\n  private _startOpenTimer(): void {\r\n    if (this._openTimerID === 0) {\r\n      this._openTimerID = window.setTimeout(() => {\r\n        this._openTimerID = 0;\r\n        this._openChildMenu();\r\n      }, Private.TIMER_DELAY);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start the close timer, unless it is already pending.\r\n   */\r\n  private _startCloseTimer(): void {\r\n    if (this._closeTimerID === 0) {\r\n      this._closeTimerID = window.setTimeout(() => {\r\n        this._closeTimerID = 0;\r\n        this._closeChildMenu();\r\n      }, Private.TIMER_DELAY);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cancel the open timer, if the timer is pending.\r\n   */\r\n  private _cancelOpenTimer(): void {\r\n    if (this._openTimerID !== 0) {\r\n      clearTimeout(this._openTimerID);\r\n      this._openTimerID = 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cancel the close timer, if the timer is pending.\r\n   */\r\n  private _cancelCloseTimer(): void {\r\n    if (this._closeTimerID !== 0) {\r\n      clearTimeout(this._closeTimerID);\r\n      this._closeTimerID = 0;\r\n    }\r\n  }\r\n\r\n  private _childIndex = -1;\r\n  private _activeIndex = -1;\r\n  private _openTimerID = 0;\r\n  private _closeTimerID = 0;\r\n  private _items: Menu.IItem[] = [];\r\n  private _childMenu: Menu | null = null;\r\n  private _parentMenu: Menu | null = null;\r\n  private _aboutToClose = new Signal<this, void>(this);\r\n  private _menuRequested = new Signal<this, 'next' | 'previous'>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `Menu` class statics.\r\n */\r\nexport\r\nnamespace Menu {\r\n  /**\r\n   * An options object for creating a menu.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The command registry for use with the menu.\r\n     */\r\n    commands: CommandRegistry;\r\n\r\n    /**\r\n     * A custom renderer for use with the menu.\r\n     *\r\n     * The default is a shared renderer instance.\r\n     */\r\n    renderer?: IRenderer;\r\n  }\r\n\r\n  /**\r\n   * An options object for the `open` method on a menu.\r\n   */\r\n  export\r\n  interface IOpenOptions {\r\n    /**\r\n     * Whether to force the X position of the menu.\r\n     *\r\n     * Setting to `true` will disable the logic which repositions the\r\n     * X coordinate of the menu if it will not fit entirely on screen.\r\n     *\r\n     * The default is `false`.\r\n     */\r\n    forceX?: boolean;\r\n\r\n    /**\r\n     * Whether to force the Y position of the menu.\r\n     *\r\n     * Setting to `true` will disable the logic which repositions the\r\n     * Y coordinate of the menu if it will not fit entirely on screen.\r\n     *\r\n     * The default is `false`.\r\n     */\r\n    forceY?: boolean;\r\n  }\r\n\r\n  /**\r\n   * A type alias for a menu item type.\r\n   */\r\n  export\r\n  type ItemType = 'command' | 'submenu' | 'separator';\r\n\r\n  /**\r\n   * An options object for creating a menu item.\r\n   */\r\n  export\r\n  interface IItemOptions {\r\n    /**\r\n     * The type of the menu item.\r\n     *\r\n     * The default value is `'command'`.\r\n     */\r\n    type?: ItemType;\r\n\r\n    /**\r\n     * The command to execute when the item is triggered.\r\n     *\r\n     * The default value is an empty string.\r\n     */\r\n    command?: string;\r\n\r\n    /**\r\n     * The arguments for the command.\r\n     *\r\n     * The default value is an empty object.\r\n     */\r\n    args?: ReadonlyJSONObject;\r\n\r\n    /**\r\n     * The submenu for a `'submenu'` type item.\r\n     *\r\n     * The default value is `null`.\r\n     */\r\n    submenu?: Menu | null;\r\n  }\r\n\r\n  /**\r\n   * An object which represents a menu item.\r\n   *\r\n   * #### Notes\r\n   * Item objects are created automatically by a menu.\r\n   */\r\n  export\r\n  interface IItem {\r\n    /**\r\n     * The type of the menu item.\r\n     */\r\n    readonly type: ItemType;\r\n\r\n    /**\r\n     * The command to execute when the item is triggered.\r\n     */\r\n    readonly command: string;\r\n\r\n    /**\r\n     * The arguments for the command.\r\n     */\r\n    readonly args: ReadonlyJSONObject;\r\n\r\n    /**\r\n     * The submenu for a `'submenu'` type item.\r\n     */\r\n    readonly submenu: Menu | null;\r\n\r\n    /**\r\n     * The display label for the menu item.\r\n     */\r\n    readonly label: string;\r\n\r\n    /**\r\n     * The mnemonic index for the menu item.\r\n     */\r\n    readonly mnemonic: number;\r\n\r\n    /**\r\n     * The icon renderer for the menu item.\r\n     */\r\n    readonly icon: VirtualElement.IRenderer | undefined\r\n    /* <DEPRECATED> */ | string /* </DEPRECATED> */;\r\n\r\n    /**\r\n     * The icon class for the menu item.\r\n     */\r\n    readonly iconClass: string;\r\n\r\n    /**\r\n     * The icon label for the menu item.\r\n     */\r\n    readonly iconLabel: string;\r\n\r\n    /**\r\n     * The display caption for the menu item.\r\n     */\r\n    readonly caption: string;\r\n\r\n    /**\r\n     * The extra class name for the menu item.\r\n     */\r\n    readonly className: string;\r\n\r\n    /**\r\n     * The dataset for the menu item.\r\n     */\r\n    readonly dataset: CommandRegistry.Dataset;\r\n\r\n    /**\r\n     * Whether the menu item is enabled.\r\n     */\r\n    readonly isEnabled: boolean;\r\n\r\n    /**\r\n     * Whether the menu item is toggled.\r\n     */\r\n    readonly isToggled: boolean;\r\n\r\n    /**\r\n     * Whether the menu item is visible.\r\n     */\r\n    readonly isVisible: boolean;\r\n\r\n    /**\r\n     * The key binding for the menu item.\r\n     */\r\n    readonly keyBinding: CommandRegistry.IKeyBinding | null;\r\n  }\r\n\r\n  /**\r\n   * An object which holds the data to render a menu item.\r\n   */\r\n  export\r\n  interface IRenderData {\r\n    /**\r\n     * The item to be rendered.\r\n     */\r\n    readonly item: IItem;\r\n\r\n    /**\r\n     * Whether the item is the active item.\r\n     */\r\n    readonly active: boolean;\r\n\r\n    /**\r\n     * Whether the item should be collapsed.\r\n     */\r\n    readonly collapsed: boolean;\r\n  }\r\n\r\n  /**\r\n   * A renderer for use with a menu.\r\n   */\r\n  export\r\n  interface IRenderer {\r\n    /**\r\n     * Render the virtual element for a menu item.\r\n     *\r\n     * @param data - The data to use for rendering the item.\r\n     *\r\n     * @returns A virtual element representing the item.\r\n     */\r\n    renderItem(data: IRenderData): VirtualElement;\r\n  }\r\n\r\n  /**\r\n   * The default implementation of `IRenderer`.\r\n   *\r\n   * #### Notes\r\n   * Subclasses are free to reimplement rendering methods as needed.\r\n   */\r\n  export\r\n  class Renderer implements IRenderer {\r\n    /**\r\n     * Construct a new renderer.\r\n     */\r\n    constructor() { }\r\n\r\n    /**\r\n     * Render the virtual element for a menu item.\r\n     *\r\n     * @param data - The data to use for rendering the item.\r\n     *\r\n     * @returns A virtual element representing the item.\r\n     */\r\n    renderItem(data: IRenderData): VirtualElement {\r\n      let className = this.createItemClass(data);\r\n      let dataset = this.createItemDataset(data);\r\n      let aria = this.createItemARIA(data);\r\n      return (\r\n        h.li({ className, dataset, ...aria },\r\n          this.renderIcon(data),\r\n          this.renderLabel(data),\r\n          this.renderShortcut(data),\r\n          this.renderSubmenu(data)\r\n        )\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Render the icon element for a menu item.\r\n     *\r\n     * @param data - The data to use for rendering the icon.\r\n     *\r\n     * @returns A virtual element representing the item icon.\r\n     */\r\n    renderIcon(data: IRenderData): VirtualElement {\r\n      let className = this.createIconClass(data);\r\n\r\n      /* <DEPRECATED> */\r\n      if (typeof data.item.icon === 'string') {\r\n        return h.div({className}, data.item.iconLabel);\r\n      }\r\n      /* </DEPRECATED> */\r\n\r\n      // if data.item.icon is undefined, it will be ignored\r\n      return h.div({className}, data.item.icon!, data.item.iconLabel);\r\n    }\r\n\r\n    /**\r\n     * Render the label element for a menu item.\r\n     *\r\n     * @param data - The data to use for rendering the label.\r\n     *\r\n     * @returns A virtual element representing the item label.\r\n     */\r\n    renderLabel(data: IRenderData): VirtualElement {\r\n      let content = this.formatLabel(data);\r\n      return h.div({\r\n        className: 'lm-Menu-itemLabel'\r\n          /* <DEPRECATED> */\r\n          + ' p-Menu-itemLabel'\r\n          /* </DEPRECATED> */\r\n      }, content);\r\n    }\r\n\r\n    /**\r\n     * Render the shortcut element for a menu item.\r\n     *\r\n     * @param data - The data to use for rendering the shortcut.\r\n     *\r\n     * @returns A virtual element representing the item shortcut.\r\n     */\r\n    renderShortcut(data: IRenderData): VirtualElement {\r\n      let content = this.formatShortcut(data);\r\n      return h.div({\r\n        className: 'lm-Menu-itemShortcut'\r\n          /* <DEPRECATED> */\r\n          + ' p-Menu-itemShortcut'\r\n          /* </DEPRECATED> */\r\n      }, content);\r\n    }\r\n\r\n    /**\r\n     * Render the submenu icon element for a menu item.\r\n     *\r\n     * @param data - The data to use for rendering the submenu icon.\r\n     *\r\n     * @returns A virtual element representing the submenu icon.\r\n     */\r\n    renderSubmenu(data: IRenderData): VirtualElement {\r\n      return h.div({\r\n        className: 'lm-Menu-itemSubmenuIcon'\r\n          /* <DEPRECATED> */\r\n          + ' p-Menu-itemSubmenuIcon'\r\n          /* </DEPRECATED> */\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Create the class name for the menu item.\r\n     *\r\n     * @param data - The data to use for the class name.\r\n     *\r\n     * @returns The full class name for the menu item.\r\n     */\r\n    createItemClass(data: IRenderData): string {\r\n      // Setup the initial class name.\r\n      let name = 'lm-Menu-item';\r\n      /* <DEPRECATED> */\r\n      name += ' p-Menu-item';\r\n      /* </DEPRECATED> */\r\n\r\n      // Add the boolean state classes.\r\n      if (!data.item.isEnabled) {\r\n        name += ' lm-mod-disabled';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-disabled';\r\n        /* </DEPRECATED> */\r\n      }\r\n      if (data.item.isToggled) {\r\n        name += ' lm-mod-toggled';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-toggled';\r\n        /* </DEPRECATED> */\r\n      }\r\n      if (!data.item.isVisible) {\r\n        name += ' lm-mod-hidden';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-hidden';\r\n        /* </DEPRECATED> */\r\n      }\r\n      if (data.active) {\r\n        name += ' lm-mod-active';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-active';\r\n        /* </DEPRECATED> */\r\n      }\r\n      if (data.collapsed) {\r\n        name += ' lm-mod-collapsed';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-collapsed';\r\n        /* </DEPRECATED> */\r\n      }\r\n\r\n      // Add the extra class.\r\n      let extra = data.item.className;\r\n      if (extra) {\r\n        name += ` ${extra}`;\r\n      }\r\n\r\n      // Return the complete class name.\r\n      return name;\r\n    }\r\n\r\n    /**\r\n     * Create the dataset for the menu item.\r\n     *\r\n     * @param data - The data to use for creating the dataset.\r\n     *\r\n     * @returns The dataset for the menu item.\r\n     */\r\n    createItemDataset(data: IRenderData): ElementDataset {\r\n      let result: ElementDataset;\r\n      let { type, command, dataset } = data.item;\r\n      if (type === 'command') {\r\n        result = { ...dataset, type, command };\r\n      } else {\r\n        result = { ...dataset, type };\r\n      }\r\n      return result;\r\n    }\r\n\r\n    /**\r\n     * Create the class name for the menu item icon.\r\n     *\r\n     * @param data - The data to use for the class name.\r\n     *\r\n     * @returns The full class name for the item icon.\r\n     */\r\n    createIconClass(data: IRenderData): string {\r\n      let name = 'lm-Menu-itemIcon';\r\n      /* <DEPRECATED> */\r\n      name += ' p-Menu-itemIcon';\r\n      /* </DEPRECATED> */\r\n      let extra = data.item.iconClass;\r\n      return extra ? `${name} ${extra}` : name;\r\n    }\r\n    \r\n    /**\r\n     * Create the aria attributes for menu item.\r\n     * \r\n     * @param data - The data to use for the aria attributes.\r\n     * \r\n     * @returns The aria attributes object for the item.\r\n     */\r\n    createItemARIA(data: IRenderData): ElementARIAAttrs {\r\n      let aria: {[T in ARIAAttrNames]?: string} = {};\r\n      switch (data.item.type) {\r\n      case 'separator':\r\n        aria.role = 'presentation';\r\n        break;\r\n      case 'submenu':\r\n        aria['aria-haspopup'] = 'true';\r\n        break;\r\n      default:\r\n        aria.role = 'menuitem';\r\n      }\r\n      return aria;\r\n    }\r\n\r\n    /**\r\n     * Create the render content for the label node.\r\n     *\r\n     * @param data - The data to use for the label content.\r\n     *\r\n     * @returns The content to add to the label node.\r\n     */\r\n    formatLabel(data: IRenderData): h.Child {\r\n      // Fetch the label text and mnemonic index.\r\n      let { label, mnemonic } = data.item;\r\n\r\n      // If the index is out of range, do not modify the label.\r\n      if (mnemonic < 0 || mnemonic >= label.length) {\r\n        return label;\r\n      }\r\n\r\n      // Split the label into parts.\r\n      let prefix = label.slice(0, mnemonic);\r\n      let suffix = label.slice(mnemonic + 1);\r\n      let char = label[mnemonic];\r\n\r\n      // Wrap the mnemonic character in a span.\r\n      let span = h.span({\r\n        className: 'lm-Menu-itemMnemonic'\r\n          /* <DEPRECATED> */\r\n          + ' p-Menu-itemMnemonic'\r\n          /* </DEPRECATED> */\r\n      }, char);\r\n\r\n      // Return the content parts.\r\n      return [prefix, span, suffix];\r\n    }\r\n\r\n    /**\r\n     * Create the render content for the shortcut node.\r\n     *\r\n     * @param data - The data to use for the shortcut content.\r\n     *\r\n     * @returns The content to add to the shortcut node.\r\n     */\r\n    formatShortcut(data: IRenderData): h.Child {\r\n      let kb = data.item.keyBinding;\r\n      return kb ? kb.keys.map(CommandRegistry.formatKeystroke).join(', ') : null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The default `Renderer` instance.\r\n   */\r\n  export\r\n  const defaultRenderer = new Renderer();\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * The ms delay for opening and closing a submenu.\r\n   */\r\n  export\r\n  const TIMER_DELAY = 300;\r\n\r\n  /**\r\n   * The horizontal pixel overlap for an open submenu.\r\n   */\r\n  export\r\n  const SUBMENU_OVERLAP = 3;\r\n\r\n  /**\r\n   * Create the DOM node for a menu.\r\n   */\r\n  export\r\n  function createNode(): HTMLDivElement {\r\n    let node = document.createElement('div');\r\n    let content = document.createElement('ul');\r\n    content.className = 'lm-Menu-content';\r\n    /* <DEPRECATED> */\r\n    content.classList.add('p-Menu-content');\r\n    /* </DEPRECATED> */\r\n    node.appendChild(content);\r\n    content.setAttribute('role', 'menu');\r\n    node.tabIndex = -1;\r\n    return node;\r\n  }\r\n\r\n  /**\r\n   * Test whether a menu item can be activated.\r\n   */\r\n  export\r\n  function canActivate(item: Menu.IItem): boolean {\r\n    return item.type !== 'separator' && item.isEnabled && item.isVisible;\r\n  }\r\n\r\n  /**\r\n   * Create a new menu item for an owner menu.\r\n   */\r\n  export\r\n  function createItem(owner: Menu, options: Menu.IItemOptions): Menu.IItem {\r\n    return new MenuItem(owner.commands, options);\r\n  }\r\n\r\n  /**\r\n   * Hit test a menu hierarchy starting at the given root.\r\n   */\r\n  export\r\n  function hitTestMenus(menu: Menu, x: number, y: number): boolean {\r\n    for (let temp: Menu | null = menu; temp; temp = temp.childMenu) {\r\n      if (ElementExt.hitTest(temp.node, x, y)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Compute which extra separator items should be collapsed.\r\n   */\r\n  export\r\n  function computeCollapsed(items: ReadonlyArray<Menu.IItem>): boolean[] {\r\n    // Allocate the return array and fill it with `false`.\r\n    let result = new Array<boolean>(items.length);\r\n    ArrayExt.fill(result, false);\r\n\r\n    // Collapse the leading separators.\r\n    let k1 = 0;\r\n    let n = items.length;\r\n    for (; k1 < n; ++k1) {\r\n      let item = items[k1];\r\n      if (!item.isVisible) {\r\n        continue;\r\n      }\r\n      if (item.type !== 'separator') {\r\n        break;\r\n      }\r\n      result[k1] = true;\r\n    }\r\n\r\n    // Hide the trailing separators.\r\n    let k2 = n - 1;\r\n    for (; k2 >= 0; --k2) {\r\n      let item = items[k2];\r\n      if (!item.isVisible) {\r\n        continue;\r\n      }\r\n      if (item.type !== 'separator') {\r\n        break;\r\n      }\r\n      result[k2] = true;\r\n    }\r\n\r\n    // Hide the remaining consecutive separators.\r\n    let hide = false;\r\n    while (++k1 < k2) {\r\n      let item = items[k1];\r\n      if (!item.isVisible) {\r\n        continue;\r\n      }\r\n      if (item.type !== 'separator') {\r\n        hide = false;\r\n      } else if (hide) {\r\n        result[k1] = true;\r\n      } else {\r\n        hide = true;\r\n      }\r\n    }\r\n\r\n    // Return the resulting flags.\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Open a menu as a root menu at the target location.\r\n   */\r\n  export\r\n  function openRootMenu(menu: Menu, x: number, y: number, forceX: boolean, forceY: boolean): void {\r\n    // Ensure the menu is updated before attaching and measuring.\r\n    MessageLoop.sendMessage(menu, Widget.Msg.UpdateRequest);\r\n\r\n    // Get the current position and size of the main viewport.\r\n    let px = window.pageXOffset;\r\n    let py = window.pageYOffset;\r\n    let cw = document.documentElement.clientWidth;\r\n    let ch = document.documentElement.clientHeight;\r\n\r\n    // Compute the maximum allowed height for the menu.\r\n    let maxHeight = ch - (forceY ? y : 0);\r\n\r\n    // Fetch common variables.\r\n    let node = menu.node;\r\n    let style = node.style;\r\n\r\n    // Clear the menu geometry and prepare it for measuring.\r\n    style.top = '';\r\n    style.left = '';\r\n    style.width = '';\r\n    style.height = '';\r\n    style.visibility = 'hidden';\r\n    style.maxHeight = `${maxHeight}px`;\r\n\r\n    // Attach the menu to the document.\r\n    Widget.attach(menu, document.body);\r\n\r\n    // Measure the size of the menu.\r\n    let { width, height } = node.getBoundingClientRect();\r\n\r\n    // Adjust the X position of the menu to fit on-screen.\r\n    if (!forceX && (x + width > px + cw)) {\r\n      x = px + cw - width;\r\n    }\r\n\r\n    // Adjust the Y position of the menu to fit on-screen.\r\n    if (!forceY && (y + height > py + ch)) {\r\n      if (y > py + ch) {\r\n        y = py + ch - height;\r\n      } else {\r\n        y = y - height;\r\n      }\r\n    }\r\n\r\n    // Update the position of the menu to the computed position.\r\n    style.top = `${Math.max(0, y)}px`;\r\n    style.left = `${Math.max(0, x)}px`;\r\n\r\n    // Finally, make the menu visible on the screen.\r\n    style.visibility = '';\r\n  }\r\n\r\n  /**\r\n   * Open a menu as a submenu using an item node for positioning.\r\n   */\r\n  export\r\n  function openSubmenu(submenu: Menu, itemNode: HTMLElement): void {\r\n    // Ensure the menu is updated before opening.\r\n    MessageLoop.sendMessage(submenu, Widget.Msg.UpdateRequest);\r\n\r\n    // Get the current position and size of the main viewport.\r\n    let px = window.pageXOffset;\r\n    let py = window.pageYOffset;\r\n    let cw = document.documentElement.clientWidth;\r\n    let ch = document.documentElement.clientHeight;\r\n\r\n    // Compute the maximum allowed height for the menu.\r\n    let maxHeight = ch;\r\n\r\n    // Fetch common variables.\r\n    let node = submenu.node;\r\n    let style = node.style;\r\n\r\n    // Clear the menu geometry and prepare it for measuring.\r\n    style.top = '';\r\n    style.left = '';\r\n    style.width = '';\r\n    style.height = '';\r\n    style.visibility = 'hidden';\r\n    style.maxHeight = `${maxHeight}px`;\r\n\r\n    // Attach the menu to the document.\r\n    Widget.attach(submenu, document.body);\r\n\r\n    // Measure the size of the menu.\r\n    let { width, height } = node.getBoundingClientRect();\r\n\r\n    // Compute the box sizing for the menu.\r\n    let box = ElementExt.boxSizing(submenu.node);\r\n\r\n    // Get the bounding rect for the target item node.\r\n    let itemRect = itemNode.getBoundingClientRect();\r\n\r\n    // Compute the target X position.\r\n    let x = itemRect.right - SUBMENU_OVERLAP;\r\n\r\n    // Adjust the X position to fit on the screen.\r\n    if (x + width > px + cw) {\r\n      x = itemRect.left + SUBMENU_OVERLAP - width;\r\n    }\r\n\r\n    // Compute the target Y position.\r\n    let y = itemRect.top - box.borderTop - box.paddingTop;\r\n\r\n    // Adjust the Y position to fit on the screen.\r\n    if (y + height > py + ch) {\r\n      y = itemRect.bottom + box.borderBottom + box.paddingBottom - height;\r\n    }\r\n\r\n    // Update the position of the menu to the computed position.\r\n    style.top = `${Math.max(0, y)}px`;\r\n    style.left = `${Math.max(0, x)}px`;\r\n\r\n    // Finally, make the menu visible on the screen.\r\n    style.visibility = '';\r\n  }\r\n\r\n  /**\r\n   * The results of a mnemonic search.\r\n   */\r\n  export\r\n  interface IMnemonicResult {\r\n    /**\r\n     * The index of the first matching mnemonic item, or `-1`.\r\n     */\r\n    index: number;\r\n\r\n    /**\r\n     * Whether multiple mnemonic items matched.\r\n     */\r\n    multiple: boolean;\r\n\r\n    /**\r\n     * The index of the first auto matched non-mnemonic item.\r\n     */\r\n    auto: number;\r\n  }\r\n\r\n  /**\r\n   * Find the best matching mnemonic item.\r\n   *\r\n   * The search starts at the given index and wraps around.\r\n   */\r\n  export\r\n  function findMnemonic(items: ReadonlyArray<Menu.IItem>, key: string, start: number): IMnemonicResult {\r\n    // Setup the result variables.\r\n    let index = -1;\r\n    let auto = -1;\r\n    let multiple = false;\r\n\r\n    // Normalize the key to upper case.\r\n    let upperKey = key.toUpperCase();\r\n\r\n    // Search the items from the given start index.\r\n    for (let i = 0, n = items.length; i < n; ++i) {\r\n      // Compute the wrapped index.\r\n      let k = (i + start) % n;\r\n\r\n      // Lookup the item\r\n      let item = items[k];\r\n\r\n      // Ignore items which cannot be activated.\r\n      if (!canActivate(item)) {\r\n        continue;\r\n      }\r\n\r\n      // Ignore items with an empty label.\r\n      let label = item.label;\r\n      if (label.length === 0) {\r\n        continue;\r\n      }\r\n\r\n      // Lookup the mnemonic index for the label.\r\n      let mn = item.mnemonic;\r\n\r\n      // Handle a valid mnemonic index.\r\n      if (mn >= 0 && mn < label.length) {\r\n        if (label[mn].toUpperCase() === upperKey) {\r\n          if (index === -1) {\r\n            index = k;\r\n          } else {\r\n            multiple = true;\r\n          }\r\n        }\r\n        continue;\r\n      }\r\n\r\n      // Finally, handle the auto index if possible.\r\n      if (auto === -1 && label[0].toUpperCase() === upperKey) {\r\n        auto = k;\r\n      }\r\n    }\r\n\r\n    // Return the search results.\r\n    return { index, multiple, auto };\r\n  }\r\n\r\n  /**\r\n   * A concrete implementation of `Menu.IItem`.\r\n   */\r\n  class MenuItem implements Menu.IItem {\r\n    /**\r\n     * Construct a new menu item.\r\n     */\r\n    constructor(commands: CommandRegistry, options: Menu.IItemOptions) {\r\n      this._commands = commands;\r\n      this.type = options.type || 'command';\r\n      this.command = options.command || '';\r\n      this.args = options.args || JSONExt.emptyObject;\r\n      this.submenu = options.submenu || null;\r\n    }\r\n\r\n    /**\r\n     * The type of the menu item.\r\n     */\r\n    readonly type: Menu.ItemType;\r\n\r\n    /**\r\n     * The command to execute when the item is triggered.\r\n     */\r\n    readonly command: string;\r\n\r\n    /**\r\n     * The arguments for the command.\r\n     */\r\n    readonly args: ReadonlyJSONObject;\r\n\r\n    /**\r\n     * The submenu for a `'submenu'` type item.\r\n     */\r\n    readonly submenu: Menu | null;\r\n\r\n    /**\r\n     * The display label for the menu item.\r\n     */\r\n    get label(): string {\r\n      if (this.type === 'command') {\r\n        return this._commands.label(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu' && this.submenu) {\r\n        return this.submenu.title.label;\r\n      }\r\n      return '';\r\n    }\r\n\r\n    /**\r\n     * The mnemonic index for the menu item.\r\n     */\r\n    get mnemonic(): number {\r\n      if (this.type === 'command') {\r\n        return this._commands.mnemonic(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu' && this.submenu) {\r\n        return this.submenu.title.mnemonic;\r\n      }\r\n      return -1;\r\n    }\r\n\r\n    /**\r\n     * The icon renderer for the menu item.\r\n     */\r\n    get icon(): VirtualElement.IRenderer | undefined\r\n    /* <DEPRECATED> */ | string /* </DEPRECATED> */\r\n    {\r\n      if (this.type === 'command') {\r\n        return this._commands.icon(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu' && this.submenu) {\r\n        return this.submenu.title.icon;\r\n      }\r\n\r\n      /* <DEPRECATED> */\r\n      // alias to icon class if not otherwise defined\r\n      return this.iconClass;\r\n      /* </DEPRECATED> */\r\n\r\n      /* <FUTURE>\r\n      return undefined;\r\n      </FUTURE> */\r\n    }\r\n\r\n    /**\r\n     * The icon class for the menu item.\r\n     */\r\n    get iconClass(): string {\r\n      if (this.type === 'command') {\r\n        return this._commands.iconClass(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu' && this.submenu) {\r\n        return this.submenu.title.iconClass;\r\n      }\r\n      return '';\r\n    }\r\n\r\n    /**\r\n     * The icon label for the menu item.\r\n     */\r\n    get iconLabel(): string {\r\n      if (this.type === 'command') {\r\n        return this._commands.iconLabel(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu' && this.submenu) {\r\n        return this.submenu.title.iconLabel;\r\n      }\r\n      return '';\r\n    }\r\n\r\n\r\n    /**\r\n     * The display caption for the menu item.\r\n     */\r\n    get caption(): string {\r\n      if (this.type === 'command') {\r\n        return this._commands.caption(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu' && this.submenu) {\r\n        return this.submenu.title.caption;\r\n      }\r\n      return '';\r\n    }\r\n\r\n    /**\r\n     * The extra class name for the menu item.\r\n     */\r\n    get className(): string {\r\n      if (this.type === 'command') {\r\n        return this._commands.className(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu' && this.submenu) {\r\n        return this.submenu.title.className;\r\n      }\r\n      return '';\r\n    }\r\n\r\n    /**\r\n     * The dataset for the menu item.\r\n     */\r\n    get dataset(): CommandRegistry.Dataset {\r\n      if (this.type === 'command') {\r\n        return this._commands.dataset(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu' && this.submenu) {\r\n        return this.submenu.title.dataset;\r\n      }\r\n      return {};\r\n    }\r\n\r\n    /**\r\n     * Whether the menu item is enabled.\r\n     */\r\n    get isEnabled(): boolean {\r\n      if (this.type === 'command') {\r\n        return this._commands.isEnabled(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu') {\r\n        return this.submenu !== null;\r\n      }\r\n      return true;\r\n    }\r\n\r\n    /**\r\n     * Whether the menu item is toggled.\r\n     */\r\n    get isToggled(): boolean {\r\n      if (this.type === 'command') {\r\n        return this._commands.isToggled(this.command, this.args);\r\n      }\r\n      return false;\r\n    }\r\n\r\n    /**\r\n     * Whether the menu item is visible.\r\n     */\r\n    get isVisible(): boolean {\r\n      if (this.type === 'command') {\r\n        return this._commands.isVisible(this.command, this.args);\r\n      }\r\n      if (this.type === 'submenu') {\r\n        return this.submenu !== null;\r\n      }\r\n      return true;\r\n    }\r\n\r\n    /**\r\n     * The key binding for the menu item.\r\n     */\r\n    get keyBinding(): CommandRegistry.IKeyBinding | null {\r\n      if (this.type === 'command') {\r\n        let { command, args } = this;\r\n        return ArrayExt.findLastValue(this._commands.keyBindings, kb => {\r\n          return kb.command === command && JSONExt.deepEqual(kb.args, args);\r\n        }) || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    private _commands: CommandRegistry;\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, each\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  CommandRegistry\r\n} from '@lumino/commands';\r\n\r\nimport {\r\n  DisposableDelegate, IDisposable\r\n} from '@lumino/disposable';\r\n\r\nimport {\r\n  Selector\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Menu\r\n} from './menu';\r\n\r\n\r\n/**\r\n * An object which implements a universal context menu.\r\n *\r\n * #### Notes\r\n * The items shown in the context menu are determined by CSS selector\r\n * matching against the DOM hierarchy at the site of the mouse click.\r\n * This is similar in concept to how keyboard shortcuts are matched\r\n * in the command registry.\r\n */\r\nexport\r\nclass ContextMenu {\r\n  /**\r\n   * Construct a new context menu.\r\n   *\r\n   * @param options - The options for initializing the menu.\r\n   */\r\n  constructor(options: ContextMenu.IOptions) {\r\n    this.menu = new Menu(options);\r\n  }\r\n\r\n  /**\r\n   * The menu widget which displays the matched context items.\r\n   */\r\n  readonly menu: Menu;\r\n\r\n  /**\r\n   * Add an item to the context menu.\r\n   *\r\n   * @param options - The options for creating the item.\r\n   *\r\n   * @returns A disposable which will remove the item from the menu.\r\n   */\r\n  addItem(options: ContextMenu.IItemOptions): IDisposable {\r\n    // Create an item from the given options.\r\n    let item = Private.createItem(options, this._idTick++);\r\n\r\n    // Add the item to the internal array.\r\n    this._items.push(item);\r\n\r\n    // Return a disposable which will remove the item.\r\n    return new DisposableDelegate(() => {\r\n      ArrayExt.removeFirstOf(this._items, item);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Open the context menu in response to a `'contextmenu'` event.\r\n   *\r\n   * @param event - The `'contextmenu'` event of interest.\r\n   *\r\n   * @returns `true` if the menu was opened, or `false` if no items\r\n   *   matched the event and the menu was not opened.\r\n   *\r\n   * #### Notes\r\n   * This method will populate the context menu with items which match\r\n   * the propagation path of the event, then open the menu at the mouse\r\n   * position indicated by the event.\r\n   */\r\n  open(event: MouseEvent): boolean {\r\n    // Clear the current contents of the context menu.\r\n    this.menu.clearItems();\r\n\r\n    // Bail early if there are no items to match.\r\n    if (this._items.length === 0) {\r\n      return false;\r\n    }\r\n\r\n    // Find the matching items for the event.\r\n    let items = Private.matchItems(this._items, event);\r\n\r\n    // Bail if there are no matching items.\r\n    if (!items || items.length === 0) {\r\n      return false;\r\n    }\r\n\r\n    // Add the filtered items to the menu.\r\n    each(items, item => { this.menu.addItem(item); });\r\n\r\n    // Open the context menu at the current mouse position.\r\n    this.menu.open(event.clientX, event.clientY);\r\n\r\n    // Indicate success.\r\n    return true;\r\n  }\r\n\r\n  private _idTick = 0;\r\n  private _items: Private.IItem[] = [];\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `ContextMenu` class statics.\r\n */\r\nexport\r\nnamespace ContextMenu {\r\n  /**\r\n   * An options object for initializing a context menu.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The command registry to use with the context menu.\r\n     */\r\n    commands: CommandRegistry;\r\n\r\n    /**\r\n     * A custom renderer for use with the context menu.\r\n     */\r\n    renderer?: Menu.IRenderer;\r\n  }\r\n\r\n  /**\r\n   * An options object for creating a context menu item.\r\n   */\r\n  export\r\n  interface IItemOptions extends Menu.IItemOptions {\r\n    /**\r\n     * The CSS selector for the context menu item.\r\n     *\r\n     * The context menu item will only be displayed in the context menu\r\n     * when the selector matches a node on the propagation path of the\r\n     * contextmenu event. This allows the menu item to be restricted to\r\n     * user-defined contexts.\r\n     *\r\n     * The selector must not contain commas.\r\n     */\r\n    selector: string;\r\n\r\n    /**\r\n     * The rank for the item.\r\n     *\r\n     * The rank is used as a tie-breaker when ordering context menu\r\n     * items for display. Items are sorted in the following order:\r\n     *   1. Depth in the DOM tree (deeper is better)\r\n     *   2. Selector specificity (higher is better)\r\n     *   3. Rank (lower is better)\r\n     *   4. Insertion order\r\n     *\r\n     * The default rank is `Infinity`.\r\n     */\r\n    rank?: number;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * A normalized item for a context menu.\r\n   */\r\n  export\r\n  interface IItem extends Menu.IItemOptions {\r\n    /**\r\n     * The selector for the item.\r\n     */\r\n    selector: string;\r\n\r\n    /**\r\n     * The rank for the item.\r\n     */\r\n    rank: number;\r\n\r\n    /**\r\n     * The tie-breaking id for the item.\r\n     */\r\n    id: number;\r\n  }\r\n\r\n  /**\r\n   * Create a normalized context menu item from an options object.\r\n   */\r\n  export\r\n  function createItem(options: ContextMenu.IItemOptions, id: number): IItem {\r\n    let selector = validateSelector(options.selector);\r\n    let rank = options.rank !== undefined ? options.rank : Infinity;\r\n    return { ...options, selector, rank, id };\r\n  }\r\n\r\n  /**\r\n   * Find the items which match a context menu event.\r\n   *\r\n   * The results are sorted by DOM level, specificity, and rank.\r\n   */\r\n  export\r\n  function matchItems(items: IItem[], event: MouseEvent): IItem[] | null {\r\n    // Look up the target of the event.\r\n    let target = event.target as (Element | null);\r\n\r\n    // Bail if there is no target.\r\n    if (!target) {\r\n      return null;\r\n    }\r\n\r\n    // Look up the current target of the event.\r\n    let currentTarget = event.currentTarget as (Element | null);\r\n\r\n    // Bail if there is no current target.\r\n    if (!currentTarget) {\r\n      return null;\r\n    }\r\n\r\n    // There are some third party libraries that cause the `target` to\r\n    // be detached from the DOM before lumino can process the event.\r\n    // If that happens, search for a new target node by point. If that\r\n    // node is still dangling, bail.\r\n    if (!currentTarget.contains(target)) {\r\n      target = document.elementFromPoint(event.clientX, event.clientY);\r\n      if (!target || !currentTarget.contains(target)) {\r\n        return null;\r\n      }\r\n    }\r\n\r\n    // Set up the result array.\r\n    let result: IItem[] = [];\r\n\r\n    // Copy the items array to allow in-place modification.\r\n    let availableItems: Array<IItem | null> = items.slice();\r\n\r\n    // Walk up the DOM hierarchy searching for matches.\r\n    while (target !== null) {\r\n      // Set up the match array for this DOM level.\r\n      let matches: IItem[] = [];\r\n\r\n      // Search the remaining items for matches.\r\n      for (let i = 0, n = availableItems.length; i < n; ++i) {\r\n        // Fetch the item.\r\n        let item = availableItems[i];\r\n\r\n        // Skip items which are already consumed.\r\n        if (!item) {\r\n          continue;\r\n        }\r\n\r\n        // Skip items which do not match the element.\r\n        if (!Selector.matches(target, item.selector)) {\r\n          continue;\r\n        }\r\n\r\n        // Add the matched item to the result for this DOM level.\r\n        matches.push(item);\r\n\r\n        // Mark the item as consumed.\r\n        availableItems[i] = null;\r\n      }\r\n\r\n      // Sort the matches for this level and add them to the results.\r\n      if (matches.length !== 0) {\r\n        matches.sort(itemCmp);\r\n        result.push(...matches);\r\n      }\r\n\r\n      // Stop searching at the limits of the DOM range.\r\n      if (target === currentTarget) {\r\n        break;\r\n      }\r\n\r\n      // Step to the parent DOM level.\r\n      target = target.parentElement;\r\n    }\r\n\r\n    // Return the matched and sorted results.\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Validate the selector for a menu item.\r\n   *\r\n   * This returns the validated selector, or throws if the selector is\r\n   * invalid or contains commas.\r\n   */\r\n  function validateSelector(selector: string): string {\r\n    if (selector.indexOf(',') !== -1) {\r\n      throw new Error(`Selector cannot contain commas: ${selector}`);\r\n    }\r\n    if (!Selector.isValid(selector)) {\r\n      throw new Error(`Invalid selector: ${selector}`);\r\n    }\r\n    return selector;\r\n  }\r\n\r\n  /**\r\n   * A sort comparison function for a context menu item.\r\n   */\r\n  function itemCmp(a: IItem, b: IItem): number {\r\n    // Sort first based on selector specificity.\r\n    let s1 = Selector.calculateSpecificity(a.selector);\r\n    let s2 = Selector.calculateSpecificity(b.selector);\r\n    if (s1 !== s2) {\r\n      return s2 - s1;\r\n    }\r\n\r\n    // If specificities are equal, sort based on rank.\r\n    let r1 = a.rank;\r\n    let r2 = b.rank;\r\n    if (r1 !== r2) {\r\n      return r1 < r2 ? -1 : 1;  // Infinity-safe\r\n    }\r\n\r\n    // When all else fails, sort by item id.\r\n    return a.id - b.id;\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, ChainIterator, IIterator, chain, each, empty, map, once, reduce\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  BoxEngine, BoxSizer\r\n} from './boxengine';\r\n\r\nimport {\r\n  Layout, LayoutItem\r\n} from './layout';\r\n\r\nimport {\r\n  TabBar\r\n} from './tabbar';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A layout which provides a flexible docking arrangement.\r\n *\r\n * #### Notes\r\n * The consumer of this layout is responsible for handling all signals\r\n * from the generated tab bars and managing the visibility of widgets\r\n * and tab bars as needed.\r\n */\r\nexport\r\nclass DockLayout extends Layout {\r\n  /**\r\n   * Construct a new dock layout.\r\n   *\r\n   * @param options - The options for initializing the layout.\r\n   */\r\n  constructor(options: DockLayout.IOptions) {\r\n    super();\r\n    this.renderer = options.renderer;\r\n    if (options.spacing !== undefined) {\r\n      this._spacing = Private.clampSpacing(options.spacing);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the layout.\r\n   *\r\n   * #### Notes\r\n   * This will clear and dispose all widgets in the layout.\r\n   */\r\n  dispose(): void {\r\n    // Get an iterator over the widgets in the layout.\r\n    let widgets = this.iter();\r\n\r\n    // Dispose of the layout items.\r\n    this._items.forEach(item => { item.dispose(); });\r\n\r\n    // Clear the layout state before disposing the widgets.\r\n    this._box = null;\r\n    this._root = null;\r\n    this._items.clear();\r\n\r\n    // Dispose of the widgets contained in the old layout root.\r\n    each(widgets, widget => { widget.dispose(); });\r\n\r\n    // Dispose of the base class.\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * The renderer used by the dock layout.\r\n   */\r\n  readonly renderer: DockLayout.IRenderer;\r\n\r\n  /**\r\n   * Get the inter-element spacing for the dock layout.\r\n   */\r\n  get spacing(): number {\r\n    return this._spacing;\r\n  }\r\n\r\n  /**\r\n   * Set the inter-element spacing for the dock layout.\r\n   */\r\n  set spacing(value: number) {\r\n    value = Private.clampSpacing(value);\r\n    if (this._spacing === value) {\r\n      return;\r\n    }\r\n    this._spacing = value;\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n    this.parent.fit();\r\n  }\r\n\r\n  /**\r\n   * Whether the dock layout is empty.\r\n   */\r\n  get isEmpty(): boolean {\r\n    return this._root === null;\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over all widgets in the layout.\r\n   *\r\n   * @returns A new iterator over the widgets in the layout.\r\n   *\r\n   * #### Notes\r\n   * This iterator includes the generated tab bars.\r\n   */\r\n  iter(): IIterator<Widget> {\r\n    return this._root ? this._root.iterAllWidgets() : empty<Widget>();\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the user widgets in the layout.\r\n   *\r\n   * @returns A new iterator over the user widgets in the layout.\r\n   *\r\n   * #### Notes\r\n   * This iterator does not include the generated tab bars.\r\n   */\r\n  widgets(): IIterator<Widget> {\r\n    return this._root ? this._root.iterUserWidgets() : empty<Widget>();\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the selected widgets in the layout.\r\n   *\r\n   * @returns A new iterator over the selected user widgets.\r\n   *\r\n   * #### Notes\r\n   * This iterator yields the widgets corresponding to the current tab\r\n   * of each tab bar in the layout.\r\n   */\r\n  selectedWidgets(): IIterator<Widget> {\r\n    return this._root ? this._root.iterSelectedWidgets() : empty<Widget>();\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the tab bars in the layout.\r\n   *\r\n   * @returns A new iterator over the tab bars in the layout.\r\n   *\r\n   * #### Notes\r\n   * This iterator does not include the user widgets.\r\n   */\r\n  tabBars(): IIterator<TabBar<Widget>> {\r\n    return this._root ? this._root.iterTabBars() : empty<TabBar<Widget>>();\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the handles in the layout.\r\n   *\r\n   * @returns A new iterator over the handles in the layout.\r\n   */\r\n  handles(): IIterator<HTMLDivElement> {\r\n    return this._root ? this._root.iterHandles() : empty<HTMLDivElement>();\r\n  }\r\n\r\n  /**\r\n   * Move a handle to the given offset position.\r\n   *\r\n   * @param handle - The handle to move.\r\n   *\r\n   * @param offsetX - The desired offset X position of the handle.\r\n   *\r\n   * @param offsetY - The desired offset Y position of the handle.\r\n   *\r\n   * #### Notes\r\n   * If the given handle is not contained in the layout, this is no-op.\r\n   *\r\n   * The handle will be moved as close as possible to the desired\r\n   * position without violating any of the layout constraints.\r\n   *\r\n   * Only one of the coordinates is used depending on the orientation\r\n   * of the handle. This method accepts both coordinates to make it\r\n   * easy to invoke from a mouse move event without needing to know\r\n   * the handle orientation.\r\n   */\r\n  moveHandle(handle: HTMLDivElement, offsetX: number, offsetY: number): void {\r\n    // Bail early if there is no root or if the handle is hidden.\r\n    let hidden = handle.classList.contains('lm-mod-hidden');\r\n    /* <DEPRECATED> */\r\n    hidden = hidden || handle.classList.contains('p-mod-hidden');\r\n    /* </DEPRECATED> */\r\n    if (!this._root || hidden) {\r\n      return;\r\n    }\r\n\r\n    // Lookup the split node for the handle.\r\n    let data = this._root.findSplitNode(handle);\r\n    if (!data) {\r\n      return;\r\n    }\r\n\r\n    // Compute the desired delta movement for the handle.\r\n    let delta: number;\r\n    if (data.node.orientation === 'horizontal') {\r\n      delta = offsetX - handle.offsetLeft;\r\n    } else {\r\n      delta = offsetY - handle.offsetTop;\r\n    }\r\n\r\n    // Bail if there is no handle movement.\r\n    if (delta === 0) {\r\n      return;\r\n    }\r\n\r\n    // Prevent sibling resizing unless needed.\r\n    data.node.holdSizes();\r\n\r\n    // Adjust the sizers to reflect the handle movement.\r\n    BoxEngine.adjust(data.node.sizers, data.index, delta);\r\n\r\n    // Update the layout of the widgets.\r\n    if (this.parent) {\r\n      this.parent.update();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Save the current configuration of the dock layout.\r\n   *\r\n   * @returns A new config object for the current layout state.\r\n   *\r\n   * #### Notes\r\n   * The return value can be provided to the `restoreLayout` method\r\n   * in order to restore the layout to its current configuration.\r\n   */\r\n  saveLayout(): DockLayout.ILayoutConfig {\r\n    // Bail early if there is no root.\r\n    if (!this._root) {\r\n      return { main: null };\r\n    }\r\n\r\n    // Hold the current sizes in the layout tree.\r\n    this._root.holdAllSizes();\r\n\r\n    // Return the layout config.\r\n    return { main: this._root.createConfig() };\r\n  }\r\n\r\n  /**\r\n   * Restore the layout to a previously saved configuration.\r\n   *\r\n   * @param config - The layout configuration to restore.\r\n   *\r\n   * #### Notes\r\n   * Widgets which currently belong to the layout but which are not\r\n   * contained in the config will be unparented.\r\n   */\r\n  restoreLayout(config: DockLayout.ILayoutConfig): void {\r\n    // Create the widget set for validating the config.\r\n    let widgetSet = new Set<Widget>();\r\n\r\n    // Normalize the main area config and collect the widgets.\r\n    let mainConfig: DockLayout.AreaConfig | null;\r\n    if (config.main) {\r\n      mainConfig = Private.normalizeAreaConfig(config.main, widgetSet);\r\n    } else {\r\n      mainConfig = null;\r\n    }\r\n\r\n    // Create iterators over the old content.\r\n    let oldWidgets = this.widgets();\r\n    let oldTabBars = this.tabBars();\r\n    let oldHandles = this.handles();\r\n\r\n    // Clear the root before removing the old content.\r\n    this._root = null;\r\n\r\n    // Unparent the old widgets which are not in the new config.\r\n    each(oldWidgets, widget => {\r\n      if (!widgetSet.has(widget)) {\r\n        widget.parent = null;\r\n      }\r\n    });\r\n\r\n    // Dispose of the old tab bars.\r\n    each(oldTabBars, tabBar => {\r\n      tabBar.dispose();\r\n    });\r\n\r\n    // Remove the old handles.\r\n    each(oldHandles, handle => {\r\n      if (handle.parentNode) {\r\n        handle.parentNode.removeChild(handle);\r\n      }\r\n    });\r\n\r\n    // Reparent the new widgets to the current parent.\r\n    widgetSet.forEach(widget => {\r\n      widget.parent = this.parent;\r\n    });\r\n\r\n    // Create the root node for the new config.\r\n    if (mainConfig) {\r\n      this._root = Private.realizeAreaConfig(mainConfig, {\r\n        createTabBar: () => this._createTabBar(),\r\n        createHandle: () => this._createHandle()\r\n      });\r\n    } else {\r\n      this._root = null;\r\n    }\r\n\r\n    // If there is no parent, there is nothing more to do.\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n\r\n    // Attach the new widgets to the parent.\r\n    widgetSet.forEach(widget => {\r\n      this.attachWidget(widget);\r\n    });\r\n\r\n    // Post a fit request to the parent.\r\n    this.parent.fit();\r\n  }\r\n\r\n  /**\r\n   * Add a widget to the dock layout.\r\n   *\r\n   * @param widget - The widget to add to the dock layout.\r\n   *\r\n   * @param options - The additional options for adding the widget.\r\n   *\r\n   * #### Notes\r\n   * The widget will be moved if it is already contained in the layout.\r\n   *\r\n   * An error will be thrown if the reference widget is invalid.\r\n   */\r\n  addWidget(widget: Widget, options: DockLayout.IAddOptions = {}): void {\r\n    // Parse the options.\r\n    let ref = options.ref || null;\r\n    let mode = options.mode || 'tab-after';\r\n\r\n    // Find the tab node which holds the reference widget.\r\n    let refNode: Private.TabLayoutNode | null = null;\r\n    if (this._root && ref) {\r\n      refNode = this._root.findTabNode(ref);\r\n    }\r\n\r\n    // Throw an error if the reference widget is invalid.\r\n    if (ref && !refNode) {\r\n      throw new Error('Reference widget is not in the layout.');\r\n    }\r\n\r\n    // Reparent the widget to the current layout parent.\r\n    widget.parent = this.parent;\r\n\r\n    // Insert the widget according to the insert mode.\r\n    switch (mode) {\r\n    case 'tab-after':\r\n      this._insertTab(widget, ref, refNode, true);\r\n      break;\r\n    case 'tab-before':\r\n      this._insertTab(widget, ref, refNode, false);\r\n      break;\r\n    case 'split-top':\r\n      this._insertSplit(widget, ref, refNode, 'vertical', false);\r\n      break;\r\n    case 'split-left':\r\n      this._insertSplit(widget, ref, refNode, 'horizontal', false);\r\n      break;\r\n    case 'split-right':\r\n      this._insertSplit(widget, ref, refNode, 'horizontal', true);\r\n      break;\r\n    case 'split-bottom':\r\n      this._insertSplit(widget, ref, refNode, 'vertical', true);\r\n      break;\r\n    }\r\n\r\n    // Do nothing else if there is no parent widget.\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n\r\n    // Ensure the widget is attached to the parent widget.\r\n    this.attachWidget(widget);\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent.fit();\r\n  }\r\n\r\n  /**\r\n   * Remove a widget from the layout.\r\n   *\r\n   * @param widget - The widget to remove from the layout.\r\n   *\r\n   * #### Notes\r\n   * A widget is automatically removed from the layout when its `parent`\r\n   * is set to `null`. This method should only be invoked directly when\r\n   * removing a widget from a layout which has yet to be installed on a\r\n   * parent widget.\r\n   *\r\n   * This method does *not* modify the widget's `parent`.\r\n   */\r\n  removeWidget(widget: Widget): void {\r\n    // Remove the widget from its current layout location.\r\n    this._removeWidget(widget);\r\n\r\n    // Do nothing else if there is no parent widget.\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n\r\n    // Detach the widget from the parent widget.\r\n    this.detachWidget(widget);\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent.fit();\r\n  }\r\n\r\n  /**\r\n   * Find the tab area which contains the given client position.\r\n   *\r\n   * @param clientX - The client X position of interest.\r\n   *\r\n   * @param clientY - The client Y position of interest.\r\n   *\r\n   * @returns The geometry of the tab area at the given position, or\r\n   *   `null` if there is no tab area at the given position.\r\n   */\r\n  hitTestTabAreas(clientX: number, clientY: number): DockLayout.ITabAreaGeometry | null {\r\n    // Bail early if hit testing cannot produce valid results.\r\n    if (!this._root || !this.parent || !this.parent.isVisible) {\r\n      return null;\r\n    }\r\n\r\n    // Ensure the parent box sizing data is computed.\r\n    if (!this._box) {\r\n      this._box = ElementExt.boxSizing(this.parent.node);\r\n    }\r\n\r\n    // Convert from client to local coordinates.\r\n    let rect = this.parent.node.getBoundingClientRect();\r\n    let x = clientX - rect.left - this._box.borderLeft;\r\n    let y = clientY - rect.top - this._box.borderTop;\r\n\r\n    // Find the tab layout node at the local position.\r\n    let tabNode = this._root.hitTestTabNodes(x, y);\r\n\r\n    // Bail if a tab layout node was not found.\r\n    if (!tabNode) {\r\n      return null;\r\n    }\r\n\r\n    // Extract the data from the tab node.\r\n    let { tabBar, top, left, width, height } = tabNode;\r\n\r\n    // Compute the right and bottom edges of the tab area.\r\n    let borderWidth = this._box.borderLeft + this._box.borderRight;\r\n    let borderHeight = this._box.borderTop + this._box.borderBottom;\r\n    let right = rect.width - borderWidth - (left + width);\r\n    let bottom = rect.height - borderHeight - (top + height);\r\n\r\n    // Return the hit test results.\r\n    return { tabBar, x, y, top, left, right, bottom, width, height };\r\n  }\r\n\r\n  /**\r\n   * Perform layout initialization which requires the parent widget.\r\n   */\r\n  protected init(): void {\r\n    // Perform superclass initialization.\r\n    super.init();\r\n\r\n    // Attach each widget to the parent.\r\n    each(this, widget => { this.attachWidget(widget); });\r\n\r\n    // Attach each handle to the parent.\r\n    each(this.handles(), handle => { this.parent!.node.appendChild(handle); });\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * Attach the widget to the layout parent widget.\r\n   *\r\n   * @param widget - The widget to attach to the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the widget is already attached.\r\n   */\r\n  protected attachWidget(widget: Widget): void {\r\n    // Do nothing if the widget is already attached.\r\n    if (this.parent!.node === widget.node.parentNode) {\r\n      return;\r\n    }\r\n\r\n    // Create the layout item for the widget.\r\n    this._items.set(widget, new LayoutItem(widget));\r\n\r\n    // Send a `'before-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    }\r\n\r\n    // Add the widget's node to the parent.\r\n    this.parent!.node.appendChild(widget.node);\r\n\r\n    // Send an `'after-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Detach the widget from the layout parent widget.\r\n   *\r\n   * @param widget - The widget to detach from the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the widget is not attached.\r\n   */\r\n  protected detachWidget(widget: Widget): void {\r\n    // Do nothing if the widget is not attached.\r\n    if (this.parent!.node !== widget.node.parentNode) {\r\n      return;\r\n    }\r\n\r\n    // Send a `'before-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    }\r\n\r\n    // Remove the widget's node from the parent.\r\n    this.parent!.node.removeChild(widget.node);\r\n\r\n    // Send an `'after-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n    }\r\n\r\n    // Delete the layout item for the widget.\r\n    let item = this._items.get(widget);\r\n    if (item) {\r\n      this._items.delete(widget);\r\n      item.dispose();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-show'` message.\r\n   */\r\n  protected onBeforeShow(msg: Message): void {\r\n    super.onBeforeShow(msg);\r\n    this.parent!.update();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    super.onBeforeAttach(msg);\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-shown'` message.\r\n   */\r\n  protected onChildShown(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-hidden'` message.\r\n   */\r\n  protected onChildHidden(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'resize'` message.\r\n   */\r\n  protected onResize(msg: Widget.ResizeMessage): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(msg.width, msg.height);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(-1, -1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'fit-request'` message.\r\n   */\r\n  protected onFitRequest(msg: Message): void {\r\n    if (this.parent!.isAttached) {\r\n      this._fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove the specified widget from the layout structure.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the widget is not in the layout tree.\r\n   *\r\n   * This does not detach the widget from the parent node.\r\n   */\r\n  private _removeWidget(widget: Widget): void {\r\n    // Bail early if there is no layout root.\r\n    if (!this._root) {\r\n      return;\r\n    }\r\n\r\n    // Find the tab node which contains the given widget.\r\n    let tabNode = this._root.findTabNode(widget);\r\n\r\n    // Bail early if the tab node is not found.\r\n    if (!tabNode) {\r\n      return;\r\n    }\r\n\r\n    // If there are multiple tabs, just remove the widget's tab.\r\n    if (tabNode.tabBar.titles.length > 1) {\r\n      tabNode.tabBar.removeTab(widget.title);\r\n      return;\r\n    }\r\n\r\n    // Otherwise, the tab node needs to be removed...\r\n\r\n    // Dispose the tab bar.\r\n    tabNode.tabBar.dispose();\r\n\r\n    // Handle the case where the tab node is the root.\r\n    if (this._root === tabNode) {\r\n      this._root = null;\r\n      return;\r\n    }\r\n\r\n    // Otherwise, remove the tab node from its parent...\r\n\r\n    // Prevent widget resizing unless needed.\r\n    this._root.holdAllSizes();\r\n\r\n    // Clear the parent reference on the tab node.\r\n    let splitNode = tabNode.parent!;\r\n    tabNode.parent = null;\r\n\r\n    // Remove the tab node from its parent split node.\r\n    let i = ArrayExt.removeFirstOf(splitNode.children, tabNode);\r\n    let handle = ArrayExt.removeAt(splitNode.handles, i)!;\r\n    ArrayExt.removeAt(splitNode.sizers, i);\r\n\r\n    // Remove the handle from its parent DOM node.\r\n    if (handle.parentNode) {\r\n      handle.parentNode.removeChild(handle);\r\n    }\r\n\r\n    // If there are multiple children, just update the handles.\r\n    if (splitNode.children.length > 1) {\r\n      splitNode.syncHandles();\r\n      return;\r\n    }\r\n\r\n    // Otherwise, the split node also needs to be removed...\r\n\r\n    // Clear the parent reference on the split node.\r\n    let maybeParent = splitNode.parent;\r\n    splitNode.parent = null;\r\n\r\n    // Lookup the remaining child node and handle.\r\n    let childNode = splitNode.children[0];\r\n    let childHandle = splitNode.handles[0];\r\n\r\n    // Clear the split node data.\r\n    splitNode.children.length = 0;\r\n    splitNode.handles.length = 0;\r\n    splitNode.sizers.length = 0;\r\n\r\n    // Remove the child handle from its parent node.\r\n    if (childHandle.parentNode) {\r\n      childHandle.parentNode.removeChild(childHandle);\r\n    }\r\n\r\n    // Handle the case where the split node is the root.\r\n    if (this._root === splitNode) {\r\n      childNode.parent = null;\r\n      this._root = childNode;\r\n      return;\r\n    }\r\n\r\n    // Otherwise, move the child node to the parent node...\r\n    let parentNode = maybeParent!;\r\n\r\n    // Lookup the index of the split node.\r\n    let j = parentNode.children.indexOf(splitNode);\r\n\r\n    // Handle the case where the child node is a tab node.\r\n    if (childNode instanceof Private.TabLayoutNode) {\r\n      childNode.parent = parentNode;\r\n      parentNode.children[j] = childNode;\r\n      return;\r\n    }\r\n\r\n    // Remove the split data from the parent.\r\n    let splitHandle = ArrayExt.removeAt(parentNode.handles, j)!;\r\n    ArrayExt.removeAt(parentNode.children, j);\r\n    ArrayExt.removeAt(parentNode.sizers, j);\r\n\r\n    // Remove the handle from its parent node.\r\n    if (splitHandle.parentNode) {\r\n      splitHandle.parentNode.removeChild(splitHandle);\r\n    }\r\n\r\n    // The child node and the split parent node will have the same\r\n    // orientation. Merge the grand-children with the parent node.\r\n    for (let i = 0, n = childNode.children.length; i < n; ++i) {\r\n      let gChild = childNode.children[i];\r\n      let gHandle = childNode.handles[i];\r\n      let gSizer = childNode.sizers[i];\r\n      ArrayExt.insert(parentNode.children, j + i, gChild);\r\n      ArrayExt.insert(parentNode.handles, j + i, gHandle);\r\n      ArrayExt.insert(parentNode.sizers, j + i, gSizer);\r\n      gChild.parent = parentNode;\r\n    }\r\n\r\n    // Clear the child node.\r\n    childNode.children.length = 0;\r\n    childNode.handles.length = 0;\r\n    childNode.sizers.length = 0;\r\n    childNode.parent = null;\r\n\r\n    // Sync the handles on the parent node.\r\n    parentNode.syncHandles();\r\n  }\r\n\r\n  /**\r\n   * Insert a widget next to an existing tab.\r\n   *\r\n   * #### Notes\r\n   * This does not attach the widget to the parent widget.\r\n   */\r\n  private _insertTab(widget: Widget, ref: Widget | null, refNode: Private.TabLayoutNode | null, after: boolean): void {\r\n    // Do nothing if the tab is inserted next to itself.\r\n    if (widget === ref) {\r\n      return;\r\n    }\r\n\r\n    // Create the root if it does not exist.\r\n    if (!this._root) {\r\n      let tabNode = new Private.TabLayoutNode(this._createTabBar());\r\n      tabNode.tabBar.addTab(widget.title);\r\n      this._root = tabNode;\r\n      return;\r\n    }\r\n\r\n    // Use the first tab node as the ref node if needed.\r\n    if (!refNode) {\r\n      refNode = this._root.findFirstTabNode()!;\r\n    }\r\n\r\n    // If the widget is not contained in the ref node, ensure it is\r\n    // removed from the layout and hidden before being added again.\r\n    if (refNode.tabBar.titles.indexOf(widget.title) === -1) {\r\n      this._removeWidget(widget);\r\n      widget.hide();\r\n    }\r\n\r\n    // Lookup the target index for inserting the tab.\r\n    let index: number;\r\n    if (ref) {\r\n      index = refNode.tabBar.titles.indexOf(ref.title);\r\n    } else {\r\n      index = refNode.tabBar.currentIndex;\r\n    }\r\n\r\n    // Insert the widget's tab relative to the target index.\r\n    refNode.tabBar.insertTab(index + (after ? 1 : 0), widget.title);\r\n  }\r\n\r\n  /**\r\n   * Insert a widget as a new split area.\r\n   *\r\n   * #### Notes\r\n   * This does not attach the widget to the parent widget.\r\n   */\r\n  private _insertSplit(widget: Widget, ref: Widget | null, refNode: Private.TabLayoutNode | null, orientation: Private.Orientation, after: boolean): void {\r\n    // Do nothing if there is no effective split.\r\n    if (widget === ref && refNode && refNode.tabBar.titles.length === 1) {\r\n      return;\r\n    }\r\n\r\n    // Ensure the widget is removed from the current layout.\r\n    this._removeWidget(widget);\r\n\r\n    // Create the tab layout node to hold the widget.\r\n    let tabNode = new Private.TabLayoutNode(this._createTabBar());\r\n    tabNode.tabBar.addTab(widget.title);\r\n\r\n    // Set the root if it does not exist.\r\n    if (!this._root) {\r\n      this._root = tabNode;\r\n      return;\r\n    }\r\n\r\n    // If the ref node parent is null, split the root.\r\n    if (!refNode || !refNode.parent) {\r\n      // Ensure the root is split with the correct orientation.\r\n      let root = this._splitRoot(orientation);\r\n\r\n      // Determine the insert index for the new tab node.\r\n      let i = after ? root.children.length : 0;\r\n\r\n      // Normalize the split node.\r\n      root.normalizeSizes();\r\n\r\n      // Create the sizer for new tab node.\r\n      let sizer = Private.createSizer(refNode ? 1 : Private.GOLDEN_RATIO);\r\n\r\n      // Insert the tab node sized to the golden ratio.\r\n      ArrayExt.insert(root.children, i, tabNode);\r\n      ArrayExt.insert(root.sizers, i, sizer);\r\n      ArrayExt.insert(root.handles, i, this._createHandle());\r\n      tabNode.parent = root;\r\n\r\n      // Re-normalize the split node to maintain the ratios.\r\n      root.normalizeSizes();\r\n\r\n      // Finally, synchronize the visibility of the handles.\r\n      root.syncHandles();\r\n      return;\r\n    }\r\n\r\n    // Lookup the split node for the ref widget.\r\n    let splitNode = refNode.parent;\r\n\r\n    // If the split node already had the correct orientation,\r\n    // the widget can be inserted into the split node directly.\r\n    if (splitNode.orientation === orientation) {\r\n      // Find the index of the ref node.\r\n      let i = splitNode.children.indexOf(refNode);\r\n\r\n      // Normalize the split node.\r\n      splitNode.normalizeSizes();\r\n\r\n      // Consume half the space for the insert location.\r\n      let s = splitNode.sizers[i].sizeHint /= 2;\r\n\r\n      // Insert the tab node sized to the other half.\r\n      let j = i + (after ? 1 : 0);\r\n      ArrayExt.insert(splitNode.children, j, tabNode);\r\n      ArrayExt.insert(splitNode.sizers, j, Private.createSizer(s));\r\n      ArrayExt.insert(splitNode.handles, j, this._createHandle());\r\n      tabNode.parent = splitNode;\r\n\r\n      // Finally, synchronize the visibility of the handles.\r\n      splitNode.syncHandles();\r\n      return;\r\n    }\r\n\r\n    // Remove the ref node from the split node.\r\n    let i = ArrayExt.removeFirstOf(splitNode.children, refNode);\r\n\r\n    // Create a new normalized split node for the children.\r\n    let childNode = new Private.SplitLayoutNode(orientation);\r\n    childNode.normalized = true;\r\n\r\n    // Add the ref node sized to half the space.\r\n    childNode.children.push(refNode);\r\n    childNode.sizers.push(Private.createSizer(0.5));\r\n    childNode.handles.push(this._createHandle());\r\n    refNode.parent = childNode;\r\n\r\n    // Add the tab node sized to the other half.\r\n    let j = after ? 1 : 0;\r\n    ArrayExt.insert(childNode.children, j, tabNode);\r\n    ArrayExt.insert(childNode.sizers, j, Private.createSizer(0.5));\r\n    ArrayExt.insert(childNode.handles, j, this._createHandle());\r\n    tabNode.parent = childNode;\r\n\r\n    // Synchronize the visibility of the handles.\r\n    childNode.syncHandles();\r\n\r\n    // Finally, add the new child node to the original split node.\r\n    ArrayExt.insert(splitNode.children, i, childNode);\r\n    childNode.parent = splitNode;\r\n  }\r\n\r\n  /**\r\n   * Ensure the root is a split node with the given orientation.\r\n   */\r\n  private _splitRoot(orientation: Private.Orientation): Private.SplitLayoutNode {\r\n    // Bail early if the root already meets the requirements.\r\n    let oldRoot = this._root;\r\n    if (oldRoot instanceof Private.SplitLayoutNode) {\r\n      if (oldRoot.orientation === orientation) {\r\n        return oldRoot;\r\n      }\r\n    }\r\n\r\n    // Create a new root node with the specified orientation.\r\n    let newRoot = this._root = new Private.SplitLayoutNode(orientation);\r\n\r\n    // Add the old root to the new root.\r\n    if (oldRoot) {\r\n      newRoot.children.push(oldRoot);\r\n      newRoot.sizers.push(Private.createSizer(0));\r\n      newRoot.handles.push(this._createHandle());\r\n      oldRoot.parent = newRoot;\r\n    }\r\n\r\n    // Return the new root as a convenience.\r\n    return newRoot;\r\n  }\r\n\r\n  /**\r\n   * Fit the layout to the total size required by the widgets.\r\n   */\r\n  private _fit(): void {\r\n    // Set up the computed minimum size.\r\n    let minW = 0;\r\n    let minH = 0;\r\n\r\n    // Update the size limits for the layout tree.\r\n    if (this._root) {\r\n      let limits = this._root.fit(this._spacing, this._items);\r\n      minW = limits.minWidth;\r\n      minH = limits.minHeight;\r\n    }\r\n\r\n    // Update the box sizing and add it to the computed min size.\r\n    let box = this._box = ElementExt.boxSizing(this.parent!.node);\r\n    minW += box.horizontalSum;\r\n    minH += box.verticalSum;\r\n\r\n    // Update the parent's min size constraints.\r\n    let style = this.parent!.node.style;\r\n    style.minWidth = `${minW}px`;\r\n    style.minHeight = `${minH}px`;\r\n\r\n    // Set the dirty flag to ensure only a single update occurs.\r\n    this._dirty = true;\r\n\r\n    // Notify the ancestor that it should fit immediately. This may\r\n    // cause a resize of the parent, fulfilling the required update.\r\n    if (this.parent!.parent) {\r\n      MessageLoop.sendMessage(this.parent!.parent!, Widget.Msg.FitRequest);\r\n    }\r\n\r\n    // If the dirty flag is still set, the parent was not resized.\r\n    // Trigger the required update on the parent widget immediately.\r\n    if (this._dirty) {\r\n      MessageLoop.sendMessage(this.parent!, Widget.Msg.UpdateRequest);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the layout position and size of the widgets.\r\n   *\r\n   * The parent offset dimensions should be `-1` if unknown.\r\n   */\r\n  private _update(offsetWidth: number, offsetHeight: number): void {\r\n    // Clear the dirty flag to indicate the update occurred.\r\n    this._dirty = false;\r\n\r\n    // Bail early if there is no root layout node.\r\n    if (!this._root) {\r\n      return;\r\n    }\r\n\r\n    // Measure the parent if the offset dimensions are unknown.\r\n    if (offsetWidth < 0) {\r\n      offsetWidth = this.parent!.node.offsetWidth;\r\n    }\r\n    if (offsetHeight < 0) {\r\n      offsetHeight = this.parent!.node.offsetHeight;\r\n    }\r\n\r\n    // Ensure the parent box sizing data is computed.\r\n    if (!this._box) {\r\n      this._box = ElementExt.boxSizing(this.parent!.node);\r\n    }\r\n\r\n    // Compute the actual layout bounds adjusted for border and padding.\r\n    let x = this._box.paddingTop;\r\n    let y = this._box.paddingLeft;\r\n    let width = offsetWidth - this._box.horizontalSum;\r\n    let height = offsetHeight - this._box.verticalSum;\r\n\r\n    // Update the geometry of the layout tree.\r\n    this._root.update(x, y, width, height, this._spacing, this._items);\r\n  }\r\n\r\n  /**\r\n   * Create a new tab bar for use by the dock layout.\r\n   *\r\n   * #### Notes\r\n   * The tab bar will be attached to the parent if it exists.\r\n   */\r\n  private _createTabBar(): TabBar<Widget> {\r\n    // Create the tab bar using the renderer.\r\n    let tabBar = this.renderer.createTabBar();\r\n\r\n    // Enforce necessary tab bar behavior.\r\n    tabBar.orientation = 'horizontal';\r\n\r\n    // Reparent and attach the tab bar to the parent if possible.\r\n    if (this.parent) {\r\n      tabBar.parent = this.parent;\r\n      this.attachWidget(tabBar);\r\n    }\r\n\r\n    // Return the initialized tab bar.\r\n    return tabBar;\r\n  }\r\n\r\n  /**\r\n   * Create a new handle for the dock layout.\r\n   *\r\n   * #### Notes\r\n   * The handle will be attached to the parent if it exists.\r\n   */\r\n  private _createHandle(): HTMLDivElement {\r\n    // Create the handle using the renderer.\r\n    let handle = this.renderer.createHandle();\r\n\r\n    // Initialize the handle layout behavior.\r\n    let style = handle.style;\r\n    style.position = 'absolute';\r\n    style.top = '0';\r\n    style.left = '0';\r\n    style.width = '0';\r\n    style.height = '0';\r\n\r\n    // Attach the handle to the parent if it exists.\r\n    if (this.parent) {\r\n      this.parent.node.appendChild(handle);\r\n    }\r\n\r\n    // Return the initialized handle.\r\n    return handle;\r\n  }\r\n\r\n  private _spacing = 4;\r\n  private _dirty = false;\r\n  private _root: Private.LayoutNode | null = null;\r\n  private _box: ElementExt.IBoxSizing | null = null;\r\n  private _items: Private.ItemMap = new Map<Widget, LayoutItem>();\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `DockLayout` class statics.\r\n */\r\nexport\r\nnamespace DockLayout {\r\n  /**\r\n   * An options object for creating a dock layout.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The renderer to use for the dock layout.\r\n     */\r\n    renderer: IRenderer;\r\n\r\n    /**\r\n     * The spacing between items in the layout.\r\n     *\r\n     * The default is `4`.\r\n     */\r\n    spacing?: number;\r\n  }\r\n\r\n  /**\r\n   * A renderer for use with a dock layout.\r\n   */\r\n  export\r\n  interface IRenderer {\r\n    /**\r\n     * Create a new tab bar for use with a dock layout.\r\n     *\r\n     * @returns A new tab bar for a dock layout.\r\n     */\r\n    createTabBar(): TabBar<Widget>;\r\n\r\n    /**\r\n     * Create a new handle node for use with a dock layout.\r\n     *\r\n     * @returns A new handle node for a dock layout.\r\n     */\r\n    createHandle(): HTMLDivElement;\r\n  }\r\n\r\n  /**\r\n   * A type alias for the supported insertion modes.\r\n   *\r\n   * An insert mode is used to specify how a widget should be added\r\n   * to the dock layout relative to a reference widget.\r\n   */\r\n  export\r\n  type InsertMode = (\r\n    /**\r\n     * The area to the top of the reference widget.\r\n     *\r\n     * The widget will be inserted just above the reference widget.\r\n     *\r\n     * If the reference widget is null or invalid, the widget will be\r\n     * inserted at the top edge of the dock layout.\r\n     */\r\n    'split-top' |\r\n\r\n    /**\r\n     * The area to the left of the reference widget.\r\n     *\r\n     * The widget will be inserted just left of the reference widget.\r\n     *\r\n     * If the reference widget is null or invalid, the widget will be\r\n     * inserted at the left edge of the dock layout.\r\n     */\r\n    'split-left' |\r\n\r\n    /**\r\n     * The area to the right of the reference widget.\r\n     *\r\n     * The widget will be inserted just right of the reference widget.\r\n     *\r\n     * If the reference widget is null or invalid, the widget will be\r\n     * inserted  at the right edge of the dock layout.\r\n     */\r\n    'split-right' |\r\n\r\n    /**\r\n     * The area to the bottom of the reference widget.\r\n     *\r\n     * The widget will be inserted just below the reference widget.\r\n     *\r\n     * If the reference widget is null or invalid, the widget will be\r\n     * inserted at the bottom edge of the dock layout.\r\n     */\r\n    'split-bottom' |\r\n\r\n    /**\r\n     * The tab position before the reference widget.\r\n     *\r\n     * The widget will be added as a tab before the reference widget.\r\n     *\r\n     * If the reference widget is null or invalid, a sensible default\r\n     * will be used.\r\n     */\r\n    'tab-before' |\r\n\r\n    /**\r\n     * The tab position after the reference widget.\r\n     *\r\n     * The widget will be added as a tab after the reference widget.\r\n     *\r\n     * If the reference widget is null or invalid, a sensible default\r\n     * will be used.\r\n     */\r\n    'tab-after'\r\n  );\r\n\r\n  /**\r\n   * An options object for adding a widget to the dock layout.\r\n   */\r\n  export\r\n  interface IAddOptions {\r\n    /**\r\n     * The insertion mode for adding the widget.\r\n     *\r\n     * The default is `'tab-after'`.\r\n     */\r\n    mode?: InsertMode;\r\n\r\n    /**\r\n     * The reference widget for the insert location.\r\n     *\r\n     * The default is `null`.\r\n     */\r\n    ref?: Widget | null;\r\n  }\r\n\r\n  /**\r\n   * A layout config object for a tab area.\r\n   */\r\n  export\r\n  interface ITabAreaConfig {\r\n    /**\r\n     * The discriminated type of the config object.\r\n     */\r\n    type: 'tab-area';\r\n\r\n    /**\r\n     * The widgets contained in the tab area.\r\n     */\r\n    widgets: Widget[];\r\n\r\n    /**\r\n     * The index of the selected tab.\r\n     */\r\n    currentIndex: number;\r\n  }\r\n\r\n  /**\r\n   * A layout config object for a split area.\r\n   */\r\n  export\r\n  interface ISplitAreaConfig {\r\n    /**\r\n     * The discriminated type of the config object.\r\n     */\r\n    type: 'split-area';\r\n\r\n    /**\r\n     * The orientation of the split area.\r\n     */\r\n    orientation: 'horizontal' | 'vertical';\r\n\r\n    /**\r\n     * The children in the split area.\r\n     */\r\n    children: AreaConfig[];\r\n\r\n    /**\r\n     * The relative sizes of the children.\r\n     */\r\n    sizes: number[];\r\n  }\r\n\r\n  /**\r\n   * A type alias for a general area config.\r\n   */\r\n  export\r\n  type AreaConfig = ITabAreaConfig | ISplitAreaConfig;\r\n\r\n  /**\r\n   * A dock layout configuration object.\r\n   */\r\n  export\r\n  interface ILayoutConfig {\r\n    /**\r\n     * The layout config for the main dock area.\r\n     */\r\n    main: AreaConfig | null;\r\n  }\r\n\r\n  /**\r\n   * An object which represents the geometry of a tab area.\r\n   */\r\n  export\r\n  interface ITabAreaGeometry {\r\n    /**\r\n     * The tab bar for the tab area.\r\n     */\r\n    tabBar: TabBar<Widget>;\r\n\r\n    /**\r\n     * The local X position of the hit test in the dock area.\r\n     *\r\n     * #### Notes\r\n     * This is the distance from the left edge of the layout parent\r\n     * widget, to the local X coordinate of the hit test query.\r\n     */\r\n    x: number;\r\n\r\n    /**\r\n     * The local Y position of the hit test in the dock area.\r\n     *\r\n     * #### Notes\r\n     * This is the distance from the top edge of the layout parent\r\n     * widget, to the local Y coordinate of the hit test query.\r\n     */\r\n    y: number;\r\n\r\n    /**\r\n     * The local coordinate of the top edge of the tab area.\r\n     *\r\n     * #### Notes\r\n     * This is the distance from the top edge of the layout parent\r\n     * widget, to the top edge of the tab area.\r\n     */\r\n    top: number;\r\n\r\n    /**\r\n     * The local coordinate of the left edge of the tab area.\r\n     *\r\n     * #### Notes\r\n     * This is the distance from the left edge of the layout parent\r\n     * widget, to the left edge of the tab area.\r\n     */\r\n    left: number;\r\n\r\n    /**\r\n     * The local coordinate of the right edge of the tab area.\r\n     *\r\n     * #### Notes\r\n     * This is the distance from the right edge of the layout parent\r\n     * widget, to the right edge of the tab area.\r\n     */\r\n    right: number;\r\n\r\n    /**\r\n     * The local coordinate of the bottom edge of the tab area.\r\n     *\r\n     * #### Notes\r\n     * This is the distance from the bottom edge of the layout parent\r\n     * widget, to the bottom edge of the tab area.\r\n     */\r\n    bottom: number;\r\n\r\n    /**\r\n     * The width of the tab area.\r\n     *\r\n     * #### Notes\r\n     * This is total width allocated for the tab area.\r\n     */\r\n    width: number;\r\n\r\n    /**\r\n     * The height of the tab area.\r\n     *\r\n     * #### Notes\r\n     * This is total height allocated for the tab area.\r\n     */\r\n    height: number;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * A fraction used for sizing root panels; ~= `1 / golden_ratio`.\r\n   */\r\n  export\r\n  const GOLDEN_RATIO = 0.618;\r\n\r\n  /**\r\n   * A type alias for a dock layout node.\r\n   */\r\n  export\r\n  type LayoutNode = TabLayoutNode | SplitLayoutNode;\r\n\r\n  /**\r\n   * A type alias for the orientation of a split layout node.\r\n   */\r\n  export\r\n  type Orientation = 'horizontal' | 'vertical';\r\n\r\n  /**\r\n   * A type alias for a layout item map.\r\n   */\r\n  export\r\n  type ItemMap = Map<Widget, LayoutItem>;\r\n\r\n  /**\r\n   * Clamp a spacing value to an integer >= 0.\r\n   */\r\n  export\r\n  function clampSpacing(value: number): number {\r\n    return Math.max(0, Math.floor(value));\r\n  }\r\n\r\n  /**\r\n   * Create a box sizer with an initial size hint.\r\n   */\r\n  export\r\n  function createSizer(hint: number): BoxSizer {\r\n    let sizer = new BoxSizer();\r\n    sizer.sizeHint = hint;\r\n    sizer.size = hint;\r\n    return sizer;\r\n  }\r\n\r\n  /**\r\n   * Normalize an area config object and collect the visited widgets.\r\n   */\r\n  export\r\n  function normalizeAreaConfig(config: DockLayout.AreaConfig, widgetSet: Set<Widget>): DockLayout.AreaConfig | null {\r\n    let result: DockLayout.AreaConfig | null;\r\n    if (config.type === 'tab-area') {\r\n      result = normalizeTabAreaConfig(config, widgetSet);\r\n    } else {\r\n      result = normalizeSplitAreaConfig(config, widgetSet);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Convert a normalized area config into a layout tree.\r\n   */\r\n  export\r\n  function realizeAreaConfig(config: DockLayout.AreaConfig, renderer: DockLayout.IRenderer): LayoutNode {\r\n    let node: LayoutNode;\r\n    if (config.type === 'tab-area') {\r\n      node = realizeTabAreaConfig(config, renderer);\r\n    } else {\r\n      node = realizeSplitAreaConfig(config, renderer);\r\n    }\r\n    return node;\r\n  }\r\n\r\n  /**\r\n   * A layout node which holds the data for a tabbed area.\r\n   */\r\n  export\r\n  class TabLayoutNode {\r\n    /**\r\n     * Construct a new tab layout node.\r\n     *\r\n     * @param tabBar - The tab bar to use for the layout node.\r\n     */\r\n    constructor(tabBar: TabBar<Widget>) {\r\n      let tabSizer = new BoxSizer();\r\n      let widgetSizer = new BoxSizer();\r\n      tabSizer.stretch = 0;\r\n      widgetSizer.stretch = 1;\r\n      this.tabBar = tabBar;\r\n      this.sizers = [tabSizer, widgetSizer];\r\n    }\r\n\r\n    /**\r\n     * The parent of the layout node.\r\n     */\r\n    parent: SplitLayoutNode | null = null;\r\n\r\n    /**\r\n     * The tab bar for the layout node.\r\n     */\r\n    readonly tabBar: TabBar<Widget>;\r\n\r\n    /**\r\n     * The sizers for the layout node.\r\n     */\r\n    readonly sizers: [BoxSizer, BoxSizer];\r\n\r\n    /**\r\n     * The most recent value for the `top` edge of the layout box.\r\n     */\r\n    get top(): number {\r\n      return this._top;\r\n    }\r\n\r\n    /**\r\n     * The most recent value for the `left` edge of the layout box.\r\n     */\r\n    get left(): number {\r\n      return this._left;\r\n    }\r\n\r\n    /**\r\n     * The most recent value for the `width` of the layout box.\r\n     */\r\n    get width(): number {\r\n      return this._width;\r\n    }\r\n\r\n    /**\r\n     * The most recent value for the `height` of the layout box.\r\n     */\r\n    get height(): number {\r\n      return this._height;\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for all widgets in the layout tree.\r\n     */\r\n    iterAllWidgets(): IIterator<Widget> {\r\n      return chain(once(this.tabBar), this.iterUserWidgets());\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for the user widgets in the layout tree.\r\n     */\r\n    iterUserWidgets(): IIterator<Widget> {\r\n      return map(this.tabBar.titles, title => title.owner);\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for the selected widgets in the layout tree.\r\n     */\r\n    iterSelectedWidgets(): IIterator<Widget> {\r\n      let title = this.tabBar.currentTitle;\r\n      return title ? once(title.owner) : empty<Widget>();\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for the tab bars in the layout tree.\r\n     */\r\n    iterTabBars(): IIterator<TabBar<Widget>> {\r\n      return once(this.tabBar);\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for the handles in the layout tree.\r\n     */\r\n    iterHandles(): IIterator<HTMLDivElement> {\r\n      return empty<HTMLDivElement>();\r\n    }\r\n\r\n    /**\r\n     * Find the tab layout node which contains the given widget.\r\n     */\r\n    findTabNode(widget: Widget): TabLayoutNode | null {\r\n      return this.tabBar.titles.indexOf(widget.title) !== -1 ? this : null;\r\n    }\r\n\r\n    /**\r\n     * Find the split layout node which contains the given handle.\r\n     */\r\n    findSplitNode(handle: HTMLDivElement): { index: number, node: SplitLayoutNode } | null {\r\n      return null;\r\n    }\r\n\r\n    /**\r\n     * Find the first tab layout node in a layout tree.\r\n     */\r\n    findFirstTabNode(): TabLayoutNode | null {\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Find the tab layout node which contains the local point.\r\n     */\r\n    hitTestTabNodes(x: number, y: number): TabLayoutNode | null {\r\n      if (x < this._left || x >= this._left + this._width) {\r\n        return null;\r\n      }\r\n      if (y < this._top || y >= this._top + this._height) {\r\n        return null;\r\n      }\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Create a configuration object for the layout tree.\r\n     */\r\n    createConfig(): DockLayout.ITabAreaConfig {\r\n      let widgets = this.tabBar.titles.map(title => title.owner);\r\n      let currentIndex = this.tabBar.currentIndex;\r\n      return { type: 'tab-area', widgets, currentIndex };\r\n    }\r\n\r\n    /**\r\n     * Recursively hold all of the sizes in the layout tree.\r\n     *\r\n     * This ignores the sizers of tab layout nodes.\r\n     */\r\n    holdAllSizes(): void {\r\n      return;\r\n    }\r\n\r\n    /**\r\n     * Fit the layout tree.\r\n     */\r\n    fit(spacing: number, items: ItemMap): ElementExt.ISizeLimits {\r\n      // Set up the limit variables.\r\n      let minWidth = 0;\r\n      let minHeight = 0;\r\n      let maxWidth = Infinity;\r\n      let maxHeight = Infinity;\r\n\r\n      // Lookup the tab bar layout item.\r\n      let tabBarItem = items.get(this.tabBar);\r\n\r\n      // Lookup the widget layout item.\r\n      let current = this.tabBar.currentTitle;\r\n      let widgetItem = current ? items.get(current.owner) : undefined;\r\n\r\n      // Lookup the tab bar and widget sizers.\r\n      let [tabBarSizer, widgetSizer] = this.sizers;\r\n\r\n      // Update the tab bar limits.\r\n      if (tabBarItem) {\r\n        tabBarItem.fit();\r\n      }\r\n\r\n      // Update the widget limits.\r\n      if (widgetItem) {\r\n        widgetItem.fit();\r\n      }\r\n\r\n      // Update the results and sizer for the tab bar.\r\n      if (tabBarItem && !tabBarItem.isHidden) {\r\n        minWidth = Math.max(minWidth, tabBarItem.minWidth);\r\n        minHeight += tabBarItem.minHeight;\r\n        tabBarSizer.minSize = tabBarItem.minHeight;\r\n        tabBarSizer.maxSize = tabBarItem.maxHeight;\r\n      } else {\r\n        tabBarSizer.minSize = 0;\r\n        tabBarSizer.maxSize = 0;\r\n      }\r\n\r\n      // Update the results and sizer for the current widget.\r\n      if (widgetItem && !widgetItem.isHidden) {\r\n        minWidth = Math.max(minWidth, widgetItem.minWidth);\r\n        minHeight += widgetItem.minHeight;\r\n        widgetSizer.minSize = widgetItem.minHeight;\r\n        widgetSizer.maxSize = Infinity;\r\n      } else {\r\n        widgetSizer.minSize = 0;\r\n        widgetSizer.maxSize = Infinity;\r\n      }\r\n\r\n      // Return the computed size limits for the layout node.\r\n      return { minWidth, minHeight, maxWidth, maxHeight };\r\n    }\r\n\r\n    /**\r\n     * Update the layout tree.\r\n     */\r\n    update(left: number, top: number, width: number, height: number, spacing: number, items: ItemMap): void {\r\n      // Update the layout box values.\r\n      this._top = top;\r\n      this._left = left;\r\n      this._width = width;\r\n      this._height = height;\r\n\r\n      // Lookup the tab bar layout item.\r\n      let tabBarItem = items.get(this.tabBar);\r\n\r\n      // Lookup the widget layout item.\r\n      let current = this.tabBar.currentTitle;\r\n      let widgetItem = current ? items.get(current.owner) : undefined;\r\n\r\n      // Distribute the layout space to the sizers.\r\n      BoxEngine.calc(this.sizers, height);\r\n\r\n      // Update the tab bar item using the computed size.\r\n      if (tabBarItem && !tabBarItem.isHidden) {\r\n        let size = this.sizers[0].size;\r\n        tabBarItem.update(left, top, width, size);\r\n        top += size;\r\n      }\r\n\r\n      // Layout the widget using the computed size.\r\n      if (widgetItem && !widgetItem.isHidden) {\r\n        let size = this.sizers[1].size;\r\n        widgetItem.update(left, top, width, size);\r\n      }\r\n    }\r\n\r\n    private _top = 0;\r\n    private _left = 0;\r\n    private _width = 0;\r\n    private _height = 0;\r\n  }\r\n\r\n  /**\r\n   * A layout node which holds the data for a split area.\r\n   */\r\n  export\r\n  class SplitLayoutNode {\r\n    /**\r\n     * Construct a new split layout node.\r\n     *\r\n     * @param orientation - The orientation of the node.\r\n     */\r\n    constructor(orientation: Orientation) {\r\n      this.orientation = orientation;\r\n    }\r\n\r\n    /**\r\n     * The parent of the layout node.\r\n     */\r\n    parent: SplitLayoutNode | null = null;\r\n\r\n    /**\r\n     * Whether the sizers have been normalized.\r\n     */\r\n    normalized = false;\r\n\r\n    /**\r\n     * The orientation of the node.\r\n     */\r\n    readonly orientation: Orientation;\r\n\r\n    /**\r\n     * The child nodes for the split node.\r\n     */\r\n    readonly children: LayoutNode[] = [];\r\n\r\n    /**\r\n     * The box sizers for the layout children.\r\n     */\r\n    readonly sizers: BoxSizer[] = [];\r\n\r\n    /**\r\n     * The handles for the layout children.\r\n     */\r\n    readonly handles: HTMLDivElement[] = [];\r\n\r\n    /**\r\n     * Create an iterator for all widgets in the layout tree.\r\n     */\r\n    iterAllWidgets(): IIterator<Widget> {\r\n      let children = map(this.children, child => child.iterAllWidgets());\r\n      return new ChainIterator<Widget>(children);\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for the user widgets in the layout tree.\r\n     */\r\n    iterUserWidgets(): IIterator<Widget> {\r\n      let children = map(this.children, child => child.iterUserWidgets());\r\n      return new ChainIterator<Widget>(children);\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for the selected widgets in the layout tree.\r\n     */\r\n    iterSelectedWidgets(): IIterator<Widget> {\r\n      let children = map(this.children, child => child.iterSelectedWidgets());\r\n      return new ChainIterator<Widget>(children);\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for the tab bars in the layout tree.\r\n     */\r\n    iterTabBars(): IIterator<TabBar<Widget>> {\r\n      let children = map(this.children, child => child.iterTabBars());\r\n      return new ChainIterator<TabBar<Widget>>(children);\r\n    }\r\n\r\n    /**\r\n     * Create an iterator for the handles in the layout tree.\r\n     */\r\n    iterHandles(): IIterator<HTMLDivElement> {\r\n      let children = map(this.children, child => child.iterHandles());\r\n      return chain(this.handles, new ChainIterator<HTMLDivElement>(children));\r\n    }\r\n\r\n    /**\r\n     * Find the tab layout node which contains the given widget.\r\n     */\r\n    findTabNode(widget: Widget): TabLayoutNode | null {\r\n      for (let i = 0, n = this.children.length; i < n; ++i) {\r\n        let result = this.children[i].findTabNode(widget);\r\n        if (result) {\r\n          return result;\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n\r\n    /**\r\n     * Find the split layout node which contains the given handle.\r\n     */\r\n    findSplitNode(handle: HTMLDivElement): { index: number, node: SplitLayoutNode } | null {\r\n      let index = this.handles.indexOf(handle);\r\n      if (index !== -1) {\r\n        return { index, node: this };\r\n      }\r\n      for (let i = 0, n = this.children.length; i < n; ++i) {\r\n        let result = this.children[i].findSplitNode(handle);\r\n        if (result) {\r\n          return result;\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n\r\n    /**\r\n     * Find the first tab layout node in a layout tree.\r\n     */\r\n    findFirstTabNode(): TabLayoutNode | null {\r\n      if (this.children.length === 0) {\r\n        return null;\r\n      }\r\n      return this.children[0].findFirstTabNode();\r\n    }\r\n\r\n    /**\r\n     * Find the tab layout node which contains the local point.\r\n     */\r\n    hitTestTabNodes(x: number, y: number): TabLayoutNode | null {\r\n      for (let i = 0, n = this.children.length; i < n; ++i) {\r\n        let result = this.children[i].hitTestTabNodes(x, y);\r\n        if (result) {\r\n          return result;\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n\r\n    /**\r\n     * Create a configuration object for the layout tree.\r\n     */\r\n    createConfig(): DockLayout.ISplitAreaConfig {\r\n      let orientation = this.orientation;\r\n      let sizes = this.createNormalizedSizes();\r\n      let children = this.children.map(child => child.createConfig());\r\n      return { type: 'split-area', orientation, children, sizes };\r\n    }\r\n\r\n    /**\r\n     * Sync the visibility and orientation of the handles.\r\n     */\r\n    syncHandles(): void {\r\n      each(this.handles, (handle, i) => {\r\n        handle.setAttribute('data-orientation', this.orientation);\r\n        if (i === this.handles.length - 1) {\r\n          handle.classList.add('lm-mod-hidden');\r\n          /* <DEPRECATED> */\r\n          handle.classList.add('p-mod-hidden');\r\n          /* </DEPRECATED> */\r\n        } else {\r\n          handle.classList.remove('lm-mod-hidden');\r\n          /* <DEPRECATED> */\r\n          handle.classList.remove('p-mod-hidden');\r\n          /* </DEPRECATED> */\r\n        }\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Hold the current sizes of the box sizers.\r\n     *\r\n     * This sets the size hint of each sizer to its current size.\r\n     */\r\n    holdSizes(): void {\r\n      each(this.sizers, sizer => { sizer.sizeHint = sizer.size; });\r\n    }\r\n\r\n    /**\r\n     * Recursively hold all of the sizes in the layout tree.\r\n     *\r\n     * This ignores the sizers of tab layout nodes.\r\n     */\r\n    holdAllSizes(): void {\r\n      each(this.children, child => child.holdAllSizes());\r\n      this.holdSizes();\r\n    }\r\n\r\n    /**\r\n     * Normalize the sizes of the split layout node.\r\n     */\r\n    normalizeSizes(): void {\r\n      // Bail early if the sizers are empty.\r\n      let n = this.sizers.length;\r\n      if (n === 0) {\r\n        return;\r\n      }\r\n\r\n      // Hold the current sizes of the sizers.\r\n      this.holdSizes();\r\n\r\n      // Compute the sum of the sizes.\r\n      let sum = reduce(this.sizers, (v, sizer) => v + sizer.sizeHint, 0);\r\n\r\n      // Normalize the sizes based on the sum.\r\n      if (sum === 0) {\r\n        each(this.sizers, sizer => {\r\n          sizer.size = sizer.sizeHint = 1 / n;\r\n        });\r\n      } else {\r\n        each(this.sizers, sizer => {\r\n          sizer.size = sizer.sizeHint /= sum;\r\n        });\r\n      }\r\n\r\n      // Mark the sizes as normalized.\r\n      this.normalized = true;\r\n    }\r\n\r\n    /**\r\n     * Snap the normalized sizes of the split layout node.\r\n     */\r\n    createNormalizedSizes(): number[] {\r\n      // Bail early if the sizers are empty.\r\n      let n = this.sizers.length;\r\n      if (n === 0) {\r\n        return [];\r\n      }\r\n\r\n      // Grab the current sizes of the sizers.\r\n      let sizes = this.sizers.map(sizer => sizer.size);\r\n\r\n      // Compute the sum of the sizes.\r\n      let sum = reduce(sizes, (v, size) => v + size, 0);\r\n\r\n      // Normalize the sizes based on the sum.\r\n      if (sum === 0) {\r\n        each(sizes, (size, i) => { sizes[i] = 1 / n; });\r\n      } else {\r\n        each(sizes, (size, i) => { sizes[i] = size / sum; });\r\n      }\r\n\r\n      // Return the normalized sizes.\r\n      return sizes;\r\n    }\r\n\r\n    /**\r\n     * Fit the layout tree.\r\n     */\r\n    fit(spacing: number, items: ItemMap): ElementExt.ISizeLimits {\r\n      // Compute the required fixed space.\r\n      let horizontal = this.orientation === 'horizontal';\r\n      let fixed = Math.max(0, this.children.length - 1) * spacing;\r\n\r\n      // Set up the limit variables.\r\n      let minWidth = horizontal ? fixed : 0;\r\n      let minHeight = horizontal ? 0 : fixed;\r\n      let maxWidth = Infinity;\r\n      let maxHeight = Infinity;\r\n\r\n      // Fit the children and update the limits.\r\n      for (let i = 0, n = this.children.length; i < n; ++i) {\r\n        let limits = this.children[i].fit(spacing, items);\r\n        if (horizontal) {\r\n          minHeight = Math.max(minHeight, limits.minHeight);\r\n          minWidth += limits.minWidth;\r\n          this.sizers[i].minSize = limits.minWidth;\r\n        } else {\r\n          minWidth = Math.max(minWidth, limits.minWidth);\r\n          minHeight += limits.minHeight;\r\n          this.sizers[i].minSize = limits.minHeight;\r\n        }\r\n      }\r\n\r\n      // Return the computed limits for the layout node.\r\n      return { minWidth, minHeight, maxWidth, maxHeight };\r\n    }\r\n\r\n    /**\r\n     * Update the layout tree.\r\n     */\r\n    update(left: number, top: number, width: number, height: number, spacing: number, items: ItemMap): void {\r\n      // Compute the available layout space.\r\n      let horizontal = this.orientation === 'horizontal';\r\n      let fixed = Math.max(0, this.children.length - 1) * spacing;\r\n      let space = Math.max(0, (horizontal ? width : height) - fixed);\r\n\r\n      // De-normalize the sizes if needed.\r\n      if (this.normalized) {\r\n        each(this.sizers, sizer => { sizer.sizeHint *= space; });\r\n        this.normalized = false;\r\n      }\r\n\r\n      // Distribute the layout space to the sizers.\r\n      BoxEngine.calc(this.sizers, space);\r\n\r\n      // Update the geometry of the child nodes and handles.\r\n      for (let i = 0, n = this.children.length; i < n; ++i) {\r\n        let child = this.children[i];\r\n        let size = this.sizers[i].size;\r\n        let handleStyle = this.handles[i].style;\r\n        if (horizontal) {\r\n          child.update(left, top, size, height, spacing, items);\r\n          left += size;\r\n          handleStyle.top = `${top}px`;\r\n          handleStyle.left = `${left}px`;\r\n          handleStyle.width = `${spacing}px`;\r\n          handleStyle.height = `${height}px`;\r\n          left += spacing;\r\n        } else {\r\n          child.update(left, top, width, size, spacing, items);\r\n          top += size;\r\n          handleStyle.top = `${top}px`;\r\n          handleStyle.left = `${left}px`;\r\n          handleStyle.width = `${width}px`;\r\n          handleStyle.height = `${spacing}px`;\r\n          top += spacing;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Normalize a tab area config and collect the visited widgets.\r\n   */\r\n  function normalizeTabAreaConfig(config: DockLayout.ITabAreaConfig, widgetSet: Set<Widget>): DockLayout.ITabAreaConfig | null {\r\n    // Bail early if there is no content.\r\n    if (config.widgets.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    // Setup the filtered widgets array.\r\n    let widgets: Widget[] = [];\r\n\r\n    // Filter the config for unique widgets.\r\n    each(config.widgets, widget => {\r\n      if (!widgetSet.has(widget)) {\r\n        widgetSet.add(widget);\r\n        widgets.push(widget);\r\n      }\r\n    });\r\n\r\n    // Bail if there are no effective widgets.\r\n    if (widgets.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    // Normalize the current index.\r\n    let index = config.currentIndex;\r\n    if (index !== -1 && (index < 0 || index >= widgets.length)) {\r\n      index = 0;\r\n    }\r\n\r\n    // Return a normalized config object.\r\n    return { type: 'tab-area', widgets, currentIndex: index };\r\n  }\r\n\r\n  /**\r\n   * Normalize a split area config and collect the visited widgets.\r\n   */\r\n  function normalizeSplitAreaConfig(config: DockLayout.ISplitAreaConfig, widgetSet: Set<Widget>): DockLayout.AreaConfig | null {\r\n    // Set up the result variables.\r\n    let orientation = config.orientation;\r\n    let children: DockLayout.AreaConfig[] = [];\r\n    let sizes: number[] = [];\r\n\r\n    // Normalize the config children.\r\n    for (let i = 0, n = config.children.length; i < n; ++i) {\r\n      // Normalize the child config.\r\n      let child = normalizeAreaConfig(config.children[i], widgetSet);\r\n\r\n      // Ignore an empty child.\r\n      if (!child) {\r\n        continue;\r\n      }\r\n\r\n      // Add the child or hoist its content as appropriate.\r\n      if (child.type === 'tab-area' || child.orientation !== orientation) {\r\n        children.push(child);\r\n        sizes.push(Math.abs(config.sizes[i] || 0));\r\n      } else {\r\n        children.push(...child.children);\r\n        sizes.push(...child.sizes);\r\n      }\r\n    }\r\n\r\n    // Bail if there are no effective children.\r\n    if (children.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    // If there is only one effective child, return that child.\r\n    if (children.length === 1) {\r\n      return children[0];\r\n    }\r\n\r\n    // Return a normalized config object.\r\n    return { type: 'split-area', orientation, children, sizes };\r\n  }\r\n\r\n  /**\r\n   * Convert a normalized tab area config into a layout tree.\r\n   */\r\n  function realizeTabAreaConfig(config: DockLayout.ITabAreaConfig, renderer: DockLayout.IRenderer): TabLayoutNode {\r\n    // Create the tab bar for the layout node.\r\n    let tabBar = renderer.createTabBar();\r\n\r\n    // Hide each widget and add it to the tab bar.\r\n    each(config.widgets, widget => {\r\n      widget.hide();\r\n      tabBar.addTab(widget.title);\r\n    });\r\n\r\n    // Set the current index of the tab bar.\r\n    tabBar.currentIndex = config.currentIndex;\r\n\r\n    // Return the new tab layout node.\r\n    return new TabLayoutNode(tabBar);\r\n  }\r\n\r\n  /**\r\n   * Convert a normalized split area config into a layout tree.\r\n   */\r\n  function realizeSplitAreaConfig(config: DockLayout.ISplitAreaConfig, renderer: DockLayout.IRenderer): SplitLayoutNode {\r\n    // Create the split layout node.\r\n    let node = new SplitLayoutNode(config.orientation);\r\n\r\n    // Add each child to the layout node.\r\n    each(config.children, (child, i) => {\r\n      // Create the child data for the layout node.\r\n      let childNode = realizeAreaConfig(child, renderer);\r\n      let sizer = createSizer(config.sizes[i]);\r\n      let handle = renderer.createHandle();\r\n\r\n      // Add the child data to the layout node.\r\n      node.children.push(childNode);\r\n      node.handles.push(handle);\r\n      node.sizers.push(sizer);\r\n\r\n      // Update the parent for the child node.\r\n      childNode.parent = node;\r\n    });\r\n\r\n    // Synchronize the handle state for the layout node.\r\n    node.syncHandles();\r\n\r\n    // Normalize the sizes for the layout node.\r\n    node.normalizeSizes();\r\n\r\n    // Return the new layout node.\r\n    return node;\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, each\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  IDisposable\r\n} from '@lumino/disposable';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Drag\r\n} from '@lumino/dragdrop';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  ElementDataset, ElementInlineStyle, VirtualDOM, VirtualElement, h\r\n} from '@lumino/virtualdom';\r\n\r\nimport {\r\n  Title\r\n} from './title';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A widget which displays titles as a single row or column of tabs.\r\n *\r\n * #### Notes\r\n * If CSS transforms are used to rotate nodes for vertically oriented\r\n * text, then tab dragging will not work correctly. The `tabsMovable`\r\n * property should be set to `false` when rotating nodes from CSS.\r\n */\r\nexport\r\nclass TabBar<T> extends Widget {\r\n  /**\r\n   * Construct a new tab bar.\r\n   *\r\n   * @param options - The options for initializing the tab bar.\r\n   */\r\n  constructor(options: TabBar.IOptions<T> = {}) {\r\n    super({ node: Private.createNode() });\r\n    this.addClass('lm-TabBar');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-TabBar');\r\n    /* </DEPRECATED> */\r\n    this.setFlag(Widget.Flag.DisallowLayout);\r\n    this.tabsMovable = options.tabsMovable || false;\r\n    this.titlesEditable = options.titlesEditable || false;\r\n    this.allowDeselect = options.allowDeselect || false;\r\n    this.insertBehavior = options.insertBehavior || 'select-tab-if-needed';\r\n    this.removeBehavior = options.removeBehavior || 'select-tab-after';\r\n    this.renderer = options.renderer || TabBar.defaultRenderer;\r\n    this._orientation = options.orientation || 'horizontal';\r\n    this.dataset['orientation'] = this._orientation;\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the widget.\r\n   */\r\n  dispose(): void {\r\n    this._releaseMouse();\r\n    this._titles.length = 0;\r\n    this._previousTitle = null;\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the current tab is changed.\r\n   *\r\n   * #### Notes\r\n   * This signal is emitted when the currently selected tab is changed\r\n   * either through user or programmatic interaction.\r\n   *\r\n   * Notably, this signal is not emitted when the index of the current\r\n   * tab changes due to tabs being inserted, removed, or moved. It is\r\n   * only emitted when the actual current tab node is changed.\r\n   */\r\n  get currentChanged(): ISignal<this, TabBar.ICurrentChangedArgs<T>> {\r\n    return this._currentChanged;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when a tab is moved by the user.\r\n   *\r\n   * #### Notes\r\n   * This signal is emitted when a tab is moved by user interaction.\r\n   *\r\n   * This signal is not emitted when a tab is moved programmatically.\r\n   */\r\n  get tabMoved(): ISignal<this, TabBar.ITabMovedArgs<T>> {\r\n    return this._tabMoved;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when a tab is clicked by the user.\r\n   *\r\n   * #### Notes\r\n   * If the clicked tab is not the current tab, the clicked tab will be\r\n   * made current and the `currentChanged` signal will be emitted first.\r\n   *\r\n   * This signal is emitted even if the clicked tab is the current tab.\r\n   */\r\n  get tabActivateRequested(): ISignal<this, TabBar.ITabActivateRequestedArgs<T>> {\r\n    return this._tabActivateRequested;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when a tab close icon is clicked.\r\n   *\r\n   * #### Notes\r\n   * This signal is not emitted unless the tab title is `closable`.\r\n   */\r\n  get tabCloseRequested(): ISignal<this, TabBar.ITabCloseRequestedArgs<T>> {\r\n    return this._tabCloseRequested;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when a tab is dragged beyond the detach threshold.\r\n   *\r\n   * #### Notes\r\n   * This signal is emitted when the user drags a tab with the mouse,\r\n   * and mouse is dragged beyond the detach threshold.\r\n   *\r\n   * The consumer of the signal should call `releaseMouse` and remove\r\n   * the tab in order to complete the detach.\r\n   *\r\n   * This signal is only emitted once per drag cycle.\r\n   */\r\n  get tabDetachRequested(): ISignal<this, TabBar.ITabDetachRequestedArgs<T>> {\r\n    return this._tabDetachRequested;\r\n  }\r\n\r\n  /**\r\n   * The renderer used by the tab bar.\r\n   */\r\n  readonly renderer: TabBar.IRenderer<T>;\r\n\r\n  /**\r\n   * Whether the tabs are movable by the user.\r\n   *\r\n   * #### Notes\r\n   * Tabs can always be moved programmatically.\r\n   */\r\n  tabsMovable: boolean;\r\n\r\n  /**\r\n   * Whether the titles can be user-edited.\r\n   *\r\n   */\r\n  get titlesEditable(): boolean {\r\n    return this._titlesEditable;\r\n  }\r\n\r\n  /**\r\n   * Set whether titles can be user edited.\r\n   *\r\n   */\r\n  set titlesEditable(value: boolean) {\r\n    this._titlesEditable = value;\r\n  }\r\n\r\n  /**\r\n   * Whether a tab can be deselected by the user.\r\n   *\r\n   * #### Notes\r\n   * Tabs can be always be deselected programmatically.\r\n   */\r\n  allowDeselect: boolean;\r\n\r\n  /**\r\n   * The selection behavior when inserting a tab.\r\n   */\r\n  insertBehavior: TabBar.InsertBehavior;\r\n\r\n  /**\r\n   * The selection behavior when removing a tab.\r\n   */\r\n  removeBehavior: TabBar.RemoveBehavior;\r\n\r\n  /**\r\n   * Get the currently selected title.\r\n   *\r\n   * #### Notes\r\n   * This will be `null` if no tab is selected.\r\n   */\r\n  get currentTitle(): Title<T> | null {\r\n    return this._titles[this._currentIndex] || null;\r\n  }\r\n\r\n  /**\r\n   * Set the currently selected title.\r\n   *\r\n   * #### Notes\r\n   * If the title does not exist, the title will be set to `null`.\r\n   */\r\n  set currentTitle(value: Title<T> | null) {\r\n    this.currentIndex = value ? this._titles.indexOf(value) : -1;\r\n  }\r\n\r\n  /**\r\n   * Get the index of the currently selected tab.\r\n   *\r\n   * #### Notes\r\n   * This will be `-1` if no tab is selected.\r\n   */\r\n  get currentIndex(): number {\r\n    return this._currentIndex;\r\n  }\r\n\r\n  /**\r\n   * Set the index of the currently selected tab.\r\n   *\r\n   * #### Notes\r\n   * If the value is out of range, the index will be set to `-1`.\r\n   */\r\n  set currentIndex(value: number) {\r\n    // Adjust for an out of range index.\r\n    if (value < 0 || value >= this._titles.length) {\r\n      value = -1;\r\n    }\r\n\r\n    // Bail early if the index will not change.\r\n    if (this._currentIndex === value) {\r\n      return;\r\n    }\r\n\r\n    // Look up the previous index and title.\r\n    let pi = this._currentIndex;\r\n    let pt = this._titles[pi] || null;\r\n\r\n    // Look up the current index and title.\r\n    let ci = value;\r\n    let ct = this._titles[ci] || null;\r\n\r\n    // Update the current index and previous title.\r\n    this._currentIndex = ci;\r\n    this._previousTitle = pt;\r\n\r\n    // Schedule an update of the tabs.\r\n    this.update();\r\n\r\n    // Emit the current changed signal.\r\n    this._currentChanged.emit({\r\n      previousIndex: pi, previousTitle: pt,\r\n      currentIndex: ci, currentTitle: ct\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get the orientation of the tab bar.\r\n   *\r\n   * #### Notes\r\n   * This controls whether the tabs are arranged in a row or column.\r\n   */\r\n  get orientation(): TabBar.Orientation {\r\n    return this._orientation;\r\n  }\r\n\r\n  /**\r\n   * Set the orientation of the tab bar.\r\n   *\r\n   * #### Notes\r\n   * This controls whether the tabs are arranged in a row or column.\r\n   */\r\n  set orientation(value: TabBar.Orientation) {\r\n    // Do nothing if the orientation does not change.\r\n    if (this._orientation === value) {\r\n      return;\r\n    }\r\n\r\n    // Release the mouse before making any changes.\r\n    this._releaseMouse();\r\n\r\n    // Toggle the orientation values.\r\n    this._orientation = value;\r\n    this.dataset['orientation'] = value;\r\n  }\r\n\r\n  /**\r\n   * A read-only array of the titles in the tab bar.\r\n   */\r\n  get titles(): ReadonlyArray<Title<T>> {\r\n    return this._titles;\r\n  }\r\n\r\n  /**\r\n   * The tab bar content node.\r\n   *\r\n   * #### Notes\r\n   * This is the node which holds the tab nodes.\r\n   *\r\n   * Modifying this node directly can lead to undefined behavior.\r\n   */\r\n  get contentNode(): HTMLUListElement {\r\n    return this.node.getElementsByClassName('lm-TabBar-content')[0] as HTMLUListElement;\r\n  }\r\n\r\n  /**\r\n   * Add a tab to the end of the tab bar.\r\n   *\r\n   * @param value - The title which holds the data for the tab,\r\n   *   or an options object to convert to a title.\r\n   *\r\n   * @returns The title object added to the tab bar.\r\n   *\r\n   * #### Notes\r\n   * If the title is already added to the tab bar, it will be moved.\r\n   */\r\n  addTab(value: Title<T> | Title.IOptions<T>): Title<T> {\r\n    return this.insertTab(this._titles.length, value);\r\n  }\r\n\r\n  /**\r\n   * Insert a tab into the tab bar at the specified index.\r\n   *\r\n   * @param index - The index at which to insert the tab.\r\n   *\r\n   * @param value - The title which holds the data for the tab,\r\n   *   or an options object to convert to a title.\r\n   *\r\n   * @returns The title object added to the tab bar.\r\n   *\r\n   * #### Notes\r\n   * The index will be clamped to the bounds of the tabs.\r\n   *\r\n   * If the title is already added to the tab bar, it will be moved.\r\n   */\r\n  insertTab(index: number, value: Title<T> | Title.IOptions<T>): Title<T> {\r\n    // Release the mouse before making any changes.\r\n    this._releaseMouse();\r\n\r\n    // Coerce the value to a title.\r\n    let title = Private.asTitle(value);\r\n\r\n    // Look up the index of the title.\r\n    let i = this._titles.indexOf(title);\r\n\r\n    // Clamp the insert index to the array bounds.\r\n    let j = Math.max(0, Math.min(index, this._titles.length));\r\n\r\n    // If the title is not in the array, insert it.\r\n    if (i === -1) {\r\n      // Insert the title into the array.\r\n      ArrayExt.insert(this._titles, j, title);\r\n\r\n      // Connect to the title changed signal.\r\n      title.changed.connect(this._onTitleChanged, this);\r\n\r\n      // Schedule an update of the tabs.\r\n      this.update();\r\n\r\n      // Adjust the current index for the insert.\r\n      this._adjustCurrentForInsert(j, title);\r\n\r\n      // Return the title added to the tab bar.\r\n      return title;\r\n    }\r\n\r\n    // Otherwise, the title exists in the array and should be moved.\r\n\r\n    // Adjust the index if the location is at the end of the array.\r\n    if (j === this._titles.length) {\r\n      j--;\r\n    }\r\n\r\n    // Bail if there is no effective move.\r\n    if (i === j) {\r\n      return title;\r\n    }\r\n\r\n    // Move the title to the new location.\r\n    ArrayExt.move(this._titles, i, j);\r\n\r\n    // Schedule an update of the tabs.\r\n    this.update();\r\n\r\n    // Adjust the current index for the move.\r\n    this._adjustCurrentForMove(i, j);\r\n\r\n    // Return the title added to the tab bar.\r\n    return title;\r\n  }\r\n\r\n  /**\r\n   * Remove a tab from the tab bar.\r\n   *\r\n   * @param title - The title for the tab to remove.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the title is not in the tab bar.\r\n   */\r\n  removeTab(title: Title<T>): void {\r\n    this.removeTabAt(this._titles.indexOf(title));\r\n  }\r\n\r\n  /**\r\n   * Remove the tab at a given index from the tab bar.\r\n   *\r\n   * @param index - The index of the tab to remove.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the index is out of range.\r\n   */\r\n  removeTabAt(index: number): void {\r\n    // Release the mouse before making any changes.\r\n    this._releaseMouse();\r\n\r\n    // Remove the title from the array.\r\n    let title = ArrayExt.removeAt(this._titles, index);\r\n\r\n    // Bail if the index is out of range.\r\n    if (!title) {\r\n      return;\r\n    }\r\n\r\n    // Disconnect from the title changed signal.\r\n    title.changed.disconnect(this._onTitleChanged, this);\r\n\r\n    // Clear the previous title if it's being removed.\r\n    if (title === this._previousTitle) {\r\n      this._previousTitle = null;\r\n    }\r\n\r\n    // Schedule an update of the tabs.\r\n    this.update();\r\n\r\n    // Adjust the current index for the remove.\r\n    this._adjustCurrentForRemove(index, title);\r\n  }\r\n\r\n  /**\r\n   * Remove all tabs from the tab bar.\r\n   */\r\n  clearTabs(): void {\r\n    // Bail if there is nothing to remove.\r\n    if (this._titles.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Release the mouse before making any changes.\r\n    this._releaseMouse();\r\n\r\n    // Disconnect from the title changed signals.\r\n    for (let title of this._titles) {\r\n      title.changed.disconnect(this._onTitleChanged, this);\r\n    }\r\n\r\n    // Get the current index and title.\r\n    let pi = this.currentIndex;\r\n    let pt = this.currentTitle;\r\n\r\n    // Reset the current index and previous title.\r\n    this._currentIndex = -1;\r\n    this._previousTitle = null;\r\n\r\n    // Clear the title array.\r\n    this._titles.length = 0;\r\n\r\n    // Schedule an update of the tabs.\r\n    this.update();\r\n\r\n    // If no tab was selected, there's nothing else to do.\r\n    if (pi === -1) {\r\n      return;\r\n    }\r\n\r\n    // Emit the current changed signal.\r\n    this._currentChanged.emit({\r\n      previousIndex: pi, previousTitle: pt,\r\n      currentIndex: -1, currentTitle: null\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Release the mouse and restore the non-dragged tab positions.\r\n   *\r\n   * #### Notes\r\n   * This will cause the tab bar to stop handling mouse events and to\r\n   * restore the tabs to their non-dragged positions.\r\n   */\r\n  releaseMouse(): void {\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * Handle the DOM events for the tab bar.\r\n   *\r\n   * @param event - The DOM event sent to the tab bar.\r\n   *\r\n   * #### Notes\r\n   * This method implements the DOM `EventListener` interface and is\r\n   * called in response to events on the tab bar's DOM node.\r\n   *\r\n   * This should not be called directly by user code.\r\n   */\r\n  handleEvent(event: Event): void {\r\n    switch (event.type) {\r\n    case 'touchstart':\r\n      event = Drag.convertTouchToMouseEvent(event as TouchEvent);\r\n    case 'mousedown':\r\n      this._evtMouseDown(event as MouseEvent);\r\n      break;\r\n    case 'touchmove':\r\n      event = Drag.convertTouchToMouseEvent(event as TouchEvent);\r\n    case 'mousemove':\r\n      this._evtMouseMove(event as MouseEvent);\r\n      break;\r\n    case 'touchend':\r\n      event = Drag.convertTouchToMouseEvent(event as TouchEvent);\r\n    case 'mouseup':\r\n      this._evtMouseUp(event as MouseEvent);\r\n      break;\r\n    case 'dblclick':\r\n      this._evtDblClick(event as MouseEvent);\r\n      break;\r\n    case 'keydown':\r\n      this._evtKeyDown(event as KeyboardEvent);\r\n      break;\r\n    case 'contextmenu':\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    this.node.addEventListener('mousedown', this);\r\n    this.node.addEventListener('dblclick', this);\r\n    this.node.addEventListener('touchstart', this);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-detach'` message.\r\n   */\r\n  protected onAfterDetach(msg: Message): void {\r\n    this.node.removeEventListener('mousedown', this);\r\n    this.node.removeEventListener('dblclick', this);\r\n    this.node.removeEventListener('touchstart', this);\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    let titles = this._titles;\r\n    let renderer = this.renderer;\r\n    let currentTitle = this.currentTitle;\r\n    let content = new Array<VirtualElement>(titles.length);\r\n    for (let i = 0, n = titles.length; i < n; ++i) {\r\n      let title = titles[i];\r\n      let current = title === currentTitle;\r\n      let zIndex = current ? n : n - i - 1;\r\n      content[i] = renderer.renderTab({ title, current, zIndex });\r\n    }\r\n    VirtualDOM.render(content, this.contentNode);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'dblclick'` event for the tab bar.\r\n   */\r\n  private _evtDblClick(event: MouseEvent): void {\r\n\r\n    // Do nothing if titles are not editable\r\n    if (!this.titlesEditable) {\r\n      return;\r\n    }\r\n\r\n    let tabs = this.contentNode.children;\r\n\r\n    // Find the index of the released tab.\r\n    let index = ArrayExt.findFirstIndex(tabs, tab => {\r\n      return ElementExt.hitTest(tab, event.clientX, event.clientY);\r\n    });\r\n\r\n    // Do nothing if the press is not on a tab.\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    let title = this.titles[index];\r\n    let label = tabs[index].querySelector('.lm-TabBar-tabLabel') as HTMLElement;\r\n    if (label && label.contains(event.target as HTMLElement)) {\r\n\r\n      let value = title.label || '';\r\n\r\n      // Clear the label element\r\n      let oldValue = label.innerHTML;\r\n      label.innerHTML = \"\";\r\n\r\n      let input = document.createElement('input');\r\n      input.classList.add('lm-TabBar-tabInput');\r\n      input.value = value;\r\n      label.appendChild(input);\r\n\r\n      let onblur = () => {\r\n        input.removeEventListener('blur', onblur);\r\n        label.innerHTML = oldValue;\r\n      }\r\n\r\n      input.addEventListener('dblclick', (event: Event) => event.stopPropagation());\r\n      input.addEventListener('blur', onblur);\r\n      input.addEventListener('keydown', (event: KeyboardEvent) => {\r\n        if (event.key === 'Enter') {\r\n          if (input.value !== '') {\r\n            title.label = title.caption = input.value;\r\n          }\r\n          onblur();\r\n        } else if (event.key === 'Escape') {\r\n          onblur();\r\n        }\r\n      });\r\n      input.select();\r\n      input.focus();\r\n\r\n      if (label.children.length > 0) {\r\n        (label.children[0] as HTMLElement).focus();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'keydown'` event for the tab bar.\r\n   */\r\n  private _evtKeyDown(event: KeyboardEvent): void {\r\n    // Stop all input events during drag.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Release the mouse if `Escape` is pressed.\r\n    if (event.keyCode === 27) {\r\n      this._releaseMouse();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousedown'` event for the tab bar.\r\n   */\r\n  private _evtMouseDown(event: MouseEvent): void {\r\n    // Do nothing if it's not a left or middle mouse press.\r\n    if (event.button !== 0 && event.button !== 1) {\r\n      return;\r\n    }\r\n\r\n    // Do nothing if a drag is in progress.\r\n    if (this._dragData) {\r\n      return;\r\n    }\r\n\r\n    // Lookup the tab nodes.\r\n    let tabs = this.contentNode.children;\r\n\r\n    // Find the index of the pressed tab.\r\n    let index = ArrayExt.findFirstIndex(tabs, tab => {\r\n      return ElementExt.hitTest(tab, event.clientX, event.clientY);\r\n    });\r\n\r\n    // Do nothing if the press is not on a tab.\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    // Pressing on a tab stops the event propagation.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Initialize the non-measured parts of the drag data.\r\n    this._dragData = {\r\n      tab: tabs[index] as HTMLElement,\r\n      index: index,\r\n      pressX: event.clientX,\r\n      pressY: event.clientY,\r\n      tabPos: -1,\r\n      tabSize: -1,\r\n      tabPressPos: -1,\r\n      targetIndex: -1,\r\n      tabLayout: null,\r\n      contentRect: null,\r\n      override: null,\r\n      dragActive: false,\r\n      dragAborted: false,\r\n      detachRequested: false\r\n    };\r\n\r\n    // Add the document mouse up listener.\r\n    document.addEventListener('mouseup', this, true);\r\n    document.addEventListener('touchend', this, true);\r\n\r\n    // Do nothing else if the middle button is clicked.\r\n    if (event.button === 1) {\r\n      return;\r\n    }\r\n\r\n    // Do nothing else if the close icon is clicked.\r\n    let icon = tabs[index].querySelector(this.renderer.closeIconSelector);\r\n    if (icon && icon.contains(event.target as HTMLElement)) {\r\n      return;\r\n    }\r\n\r\n    // Add the extra listeners if the tabs are movable.\r\n    if (this.tabsMovable) {\r\n      document.addEventListener('mousemove', this, true);\r\n      document.addEventListener('touchmove', this, true);\r\n      document.addEventListener('keydown', this, true);\r\n      document.addEventListener('contextmenu', this, true);\r\n    }\r\n\r\n    // Update the current index as appropriate.\r\n    if (this.allowDeselect && this.currentIndex === index) {\r\n      this.currentIndex = -1;\r\n    } else {\r\n      this.currentIndex = index;\r\n    }\r\n\r\n    // Do nothing else if there is no current tab.\r\n    if (this.currentIndex === -1) {\r\n      return;\r\n    }\r\n\r\n    // Emit the tab activate request signal.\r\n    this._tabActivateRequested.emit({\r\n      index: this.currentIndex, title: this.currentTitle!\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousemove'` event for the tab bar.\r\n   */\r\n  private _evtMouseMove(event: MouseEvent): void {\r\n    // Do nothing if no drag is in progress.\r\n    let data = this._dragData;\r\n    if (!data) {\r\n      return;\r\n    }\r\n\r\n    // Suppress the event during a drag.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Lookup the tab nodes.\r\n    let tabs = this.contentNode.children;\r\n\r\n    // Bail early if the drag threshold has not been met.\r\n    if (!data.dragActive && !Private.dragExceeded(data, event)) {\r\n      return;\r\n    }\r\n\r\n    // Activate the drag if necessary.\r\n    if (!data.dragActive) {\r\n      // Fill in the rest of the drag data measurements.\r\n      let tabRect = data.tab.getBoundingClientRect();\r\n      if (this._orientation === 'horizontal') {\r\n        data.tabPos = data.tab.offsetLeft;\r\n        data.tabSize = tabRect.width;\r\n        data.tabPressPos = data.pressX - tabRect.left;\r\n      } else {\r\n        data.tabPos = data.tab.offsetTop;\r\n        data.tabSize = tabRect.height;\r\n        data.tabPressPos = data.pressY - tabRect.top;\r\n      }\r\n      data.tabLayout = Private.snapTabLayout(tabs, this._orientation);\r\n      data.contentRect = this.contentNode.getBoundingClientRect();\r\n      data.override = Drag.overrideCursor('default');\r\n\r\n      // Add the dragging style classes.\r\n      data.tab.classList.add('lm-mod-dragging');\r\n      this.addClass('lm-mod-dragging');\r\n      /* <DEPRECATED> */\r\n      data.tab.classList.add('p-mod-dragging');\r\n      this.addClass('p-mod-dragging');\r\n      /* </DEPRECATED> */\r\n\r\n      // Mark the drag as active.\r\n      data.dragActive = true;\r\n    }\r\n\r\n    // Emit the detach requested signal if the threshold is exceeded.\r\n    if (!data.detachRequested && Private.detachExceeded(data, event)) {\r\n      // Only emit the signal once per drag cycle.\r\n      data.detachRequested = true;\r\n\r\n      // Setup the arguments for the signal.\r\n      let index = data.index;\r\n      let clientX = event.clientX;\r\n      let clientY = event.clientY;\r\n      let tab = tabs[index] as HTMLElement;\r\n      let title = this._titles[index];\r\n\r\n      // Emit the tab detach requested signal.\r\n      this._tabDetachRequested.emit({ index, title, tab, clientX, clientY });\r\n\r\n      // Bail if the signal handler aborted the drag.\r\n      if (data.dragAborted) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Update the positions of the tabs.\r\n    Private.layoutTabs(tabs, data, event, this._orientation);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mouseup'` event for the document.\r\n   */\r\n  private _evtMouseUp(event: MouseEvent): void {\r\n    // Do nothing if it's not a left or middle mouse release.\r\n    if (event.button !== 0 && event.button !== 1) {\r\n      return;\r\n    }\r\n\r\n    // Do nothing if no drag is in progress.\r\n    const data = this._dragData;\r\n    if (!data) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event propagation.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Remove the extra mouse event listeners.\r\n    document.removeEventListener('mousemove', this, true);\r\n    document.removeEventListener('touchmove', this, true);\r\n    document.removeEventListener('mouseup', this, true);\r\n    document.removeEventListener('touchend', this, true);\r\n    document.removeEventListener('keydown', this, true);\r\n    document.removeEventListener('contextmenu', this, true);\r\n\r\n    // Handle a release when the drag is not active.\r\n    if (!data.dragActive) {\r\n      // Clear the drag data.\r\n      this._dragData = null;\r\n\r\n      // Lookup the tab nodes.\r\n      let tabs = this.contentNode.children;\r\n\r\n      // Find the index of the released tab.\r\n      let index = ArrayExt.findFirstIndex(tabs, tab => {\r\n        return ElementExt.hitTest(tab, event.clientX, event.clientY);\r\n      });\r\n\r\n      // Do nothing if the release is not on the original pressed tab.\r\n      if (index !== data.index) {\r\n        return;\r\n      }\r\n\r\n      // Ignore the release if the title is not closable.\r\n      let title = this._titles[index];\r\n      if (!title.closable) {\r\n        return;\r\n      }\r\n\r\n      // Emit the close requested signal if the middle button is released.\r\n      if (event.button === 1) {\r\n        this._tabCloseRequested.emit({ index, title });\r\n        return;\r\n      }\r\n\r\n      // Emit the close requested signal if the close icon was released.\r\n      let icon = tabs[index].querySelector(this.renderer.closeIconSelector);\r\n      if (icon && icon.contains(event.target as HTMLElement)) {\r\n        this._tabCloseRequested.emit({ index, title });\r\n        return;\r\n      }\r\n\r\n      // Otherwise, there is nothing left to do.\r\n      return;\r\n    }\r\n\r\n    // Do nothing if the left button is not released.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Position the tab at its final resting position.\r\n    Private.finalizeTabPosition(data, this._orientation);\r\n\r\n    // Remove the dragging class from the tab so it can be transitioned.\r\n    data.tab.classList.remove('lm-mod-dragging');\r\n    /* <DEPRECATED> */\r\n    data.tab.classList.remove('p-mod-dragging');\r\n    /* </DEPRECATED> */\r\n\r\n    // Parse the transition duration for releasing the tab.\r\n    let duration = Private.parseTransitionDuration(data.tab);\r\n\r\n    // Complete the release on a timer to allow the tab to transition.\r\n    setTimeout(() => {\r\n      // Do nothing if the drag has been aborted.\r\n      if (data.dragAborted) {\r\n        return;\r\n      }\r\n\r\n      // Clear the drag data reference.\r\n      this._dragData = null;\r\n\r\n      // Reset the positions of the tabs.\r\n      Private.resetTabPositions(this.contentNode.children, this._orientation);\r\n\r\n      // Clear the cursor grab.\r\n      data.override!.dispose();\r\n\r\n      // Remove the remaining dragging style.\r\n      this.removeClass('lm-mod-dragging');\r\n      /* <DEPRECATED> */\r\n      this.removeClass('p-mod-dragging');\r\n      /* </DEPRECATED> */\r\n\r\n      // If the tab was not moved, there is nothing else to do.\r\n      let i = data.index;\r\n      let j = data.targetIndex;\r\n      if (j === -1 || i === j) {\r\n        return;\r\n      }\r\n\r\n      // Move the title to the new locations.\r\n      ArrayExt.move(this._titles, i, j);\r\n\r\n      // Adjust the current index for the move.\r\n      this._adjustCurrentForMove(i, j);\r\n\r\n      // Emit the tab moved signal.\r\n      this._tabMoved.emit({\r\n        fromIndex: i, toIndex: j, title: this._titles[j]\r\n      });\r\n\r\n      // Update the tabs immediately to prevent flicker.\r\n      MessageLoop.sendMessage(this, Widget.Msg.UpdateRequest);\r\n    }, duration);\r\n  }\r\n\r\n  /**\r\n   * Release the mouse and restore the non-dragged tab positions.\r\n   */\r\n  private _releaseMouse(): void {\r\n    // Do nothing if no drag is in progress.\r\n    let data = this._dragData;\r\n    if (!data) {\r\n      return;\r\n    }\r\n\r\n    // Clear the drag data reference.\r\n    this._dragData = null;\r\n\r\n    // Remove the extra mouse listeners.\r\n    document.removeEventListener('mousemove', this, true);\r\n    document.removeEventListener('touchmove', this, true);\r\n    document.removeEventListener('mouseup', this, true);\r\n    document.removeEventListener('touchend', this, true);\r\n    document.removeEventListener('keydown', this, true);\r\n    document.removeEventListener('contextmenu', this, true);\r\n\r\n    // Indicate the drag has been aborted. This allows the mouse\r\n    // event handlers to return early when the drag is canceled.\r\n    data.dragAborted = true;\r\n\r\n    // If the drag is not active, there's nothing more to do.\r\n    if (!data.dragActive) {\r\n      return;\r\n    }\r\n\r\n    // Reset the tabs to their non-dragged positions.\r\n    Private.resetTabPositions(this.contentNode.children, this._orientation);\r\n\r\n    // Clear the cursor override.\r\n    data.override!.dispose();\r\n\r\n    // Clear the dragging style classes.\r\n    data.tab.classList.remove('lm-mod-dragging');\r\n    this.removeClass('lm-mod-dragging');\r\n    /* <DEPRECATED> */\r\n    data.tab.classList.remove('p-mod-dragging');\r\n    this.removeClass('p-mod-dragging');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * Adjust the current index for a tab insert operation.\r\n   *\r\n   * This method accounts for the tab bar's insertion behavior when\r\n   * adjusting the current index and emitting the changed signal.\r\n   */\r\n  private _adjustCurrentForInsert(i: number, title: Title<T>): void {\r\n    // Lookup commonly used variables.\r\n    let ct = this.currentTitle;\r\n    let ci = this._currentIndex;\r\n    let bh = this.insertBehavior;\r\n\r\n    // Handle the behavior where the new tab is always selected,\r\n    // or the behavior where the new tab is selected if needed.\r\n    if (bh === 'select-tab' || (bh === 'select-tab-if-needed' && ci === -1)) {\r\n      this._currentIndex = i;\r\n      this._previousTitle = ct;\r\n      this._currentChanged.emit({\r\n        previousIndex: ci, previousTitle: ct,\r\n        currentIndex: i, currentTitle: title\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Otherwise, silently adjust the current index if needed.\r\n    if (ci >= i) {\r\n      this._currentIndex++;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Adjust the current index for a tab move operation.\r\n   *\r\n   * This method will not cause the actual current tab to change.\r\n   * It silently adjusts the index to account for the given move.\r\n   */\r\n  private _adjustCurrentForMove(i: number, j: number): void {\r\n    if (this._currentIndex === i) {\r\n      this._currentIndex = j;\r\n    } else if (this._currentIndex < i && this._currentIndex >= j) {\r\n      this._currentIndex++;\r\n    } else if (this._currentIndex > i && this._currentIndex <= j) {\r\n      this._currentIndex--;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Adjust the current index for a tab remove operation.\r\n   *\r\n   * This method accounts for the tab bar's remove behavior when\r\n   * adjusting the current index and emitting the changed signal.\r\n   */\r\n  private _adjustCurrentForRemove(i: number, title: Title<T>): void {\r\n    // Lookup commonly used variables.\r\n    let ci = this._currentIndex;\r\n    let bh = this.removeBehavior;\r\n\r\n    // Silently adjust the index if the current tab is not removed.\r\n    if (ci !== i) {\r\n      if (ci > i) {\r\n        this._currentIndex--;\r\n      }\r\n      return;\r\n    }\r\n\r\n    // No tab gets selected if the tab bar is empty.\r\n    if (this._titles.length === 0) {\r\n      this._currentIndex = -1;\r\n      this._currentChanged.emit({\r\n        previousIndex: i, previousTitle: title,\r\n        currentIndex: -1, currentTitle: null\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Handle behavior where the next sibling tab is selected.\r\n    if (bh === 'select-tab-after') {\r\n      this._currentIndex = Math.min(i, this._titles.length - 1);\r\n      this._currentChanged.emit({\r\n        previousIndex: i, previousTitle: title,\r\n        currentIndex: this._currentIndex, currentTitle: this.currentTitle\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Handle behavior where the previous sibling tab is selected.\r\n    if (bh === 'select-tab-before') {\r\n      this._currentIndex = Math.max(0, i - 1);\r\n      this._currentChanged.emit({\r\n        previousIndex: i, previousTitle: title,\r\n        currentIndex: this._currentIndex, currentTitle: this.currentTitle\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Handle behavior where the previous history tab is selected.\r\n    if (bh === 'select-previous-tab') {\r\n      if (this._previousTitle) {\r\n        this._currentIndex = this._titles.indexOf(this._previousTitle);\r\n        this._previousTitle = null;\r\n      } else {\r\n        this._currentIndex = Math.min(i, this._titles.length - 1);\r\n      }\r\n      this._currentChanged.emit({\r\n        previousIndex: i, previousTitle: title,\r\n        currentIndex: this._currentIndex, currentTitle: this.currentTitle\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Otherwise, no tab gets selected.\r\n    this._currentIndex = -1;\r\n    this._currentChanged.emit({\r\n      previousIndex: i, previousTitle: title,\r\n      currentIndex: -1, currentTitle: null\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle the `changed` signal of a title object.\r\n   */\r\n  private _onTitleChanged(sender: Title<T>): void {\r\n    this.update();\r\n  }\r\n\r\n  private _currentIndex = -1;\r\n  private _titles: Title<T>[] = [];\r\n  private _orientation: TabBar.Orientation;\r\n  private _titlesEditable: boolean = false;\r\n  private _previousTitle: Title<T> | null = null;\r\n  private _dragData: Private.IDragData | null = null;\r\n  private _tabMoved = new Signal<this, TabBar.ITabMovedArgs<T>>(this);\r\n  private _currentChanged = new Signal<this, TabBar.ICurrentChangedArgs<T>>(this);\r\n  private _tabCloseRequested = new Signal<this, TabBar.ITabCloseRequestedArgs<T>>(this);\r\n  private _tabDetachRequested = new Signal<this, TabBar.ITabDetachRequestedArgs<T>>(this);\r\n  private _tabActivateRequested = new Signal<this, TabBar.ITabActivateRequestedArgs<T>>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `TabBar` class statics.\r\n */\r\nexport\r\nnamespace TabBar {\r\n  /**\r\n   * A type alias for a tab bar orientation.\r\n   */\r\n  export\r\n  type Orientation = (\r\n    /**\r\n     * The tabs are arranged in a single row, left-to-right.\r\n     *\r\n     * The tab text orientation is horizontal.\r\n     */\r\n    'horizontal' |\r\n\r\n    /**\r\n     * The tabs are arranged in a single column, top-to-bottom.\r\n     *\r\n     * The tab text orientation is horizontal.\r\n     */\r\n    'vertical'\r\n  );\r\n\r\n  /**\r\n   * A type alias for the selection behavior on tab insert.\r\n   */\r\n  export\r\n  type InsertBehavior = (\r\n    /**\r\n     * The selected tab will not be changed.\r\n     */\r\n    'none' |\r\n\r\n    /**\r\n     * The inserted tab will be selected.\r\n     */\r\n    'select-tab' |\r\n\r\n    /**\r\n     * The inserted tab will be selected if the current tab is null.\r\n     */\r\n    'select-tab-if-needed'\r\n  );\r\n\r\n  /**\r\n   * A type alias for the selection behavior on tab remove.\r\n   */\r\n  export\r\n  type RemoveBehavior = (\r\n    /**\r\n     * No tab will be selected.\r\n     */\r\n    'none' |\r\n\r\n    /**\r\n     * The tab after the removed tab will be selected if possible.\r\n     */\r\n    'select-tab-after' |\r\n\r\n    /**\r\n     * The tab before the removed tab will be selected if possible.\r\n     */\r\n    'select-tab-before' |\r\n\r\n    /**\r\n     * The previously selected tab will be selected if possible.\r\n     */\r\n    'select-previous-tab'\r\n  );\r\n\r\n  /**\r\n   * An options object for creating a tab bar.\r\n   */\r\n  export\r\n  interface IOptions<T> {\r\n    /**\r\n     * The layout orientation of the tab bar.\r\n     *\r\n     * The default is `horizontal`.\r\n     */\r\n    orientation?: TabBar.Orientation;\r\n\r\n    /**\r\n     * Whether the tabs are movable by the user.\r\n     *\r\n     * The default is `false`.\r\n     */\r\n    tabsMovable?: boolean;\r\n\r\n    /**\r\n     * Whether a tab can be deselected by the user.\r\n     *\r\n     * The default is `false`.\r\n     */\r\n    allowDeselect?: boolean;\r\n\r\n    /**\r\n     * Whether the titles can be directly edited by the user.\r\n     *\r\n     * The default is `false`.\r\n     */\r\n    titlesEditable?: boolean;\r\n\r\n    /**\r\n     * The selection behavior when inserting a tab.\r\n     *\r\n     * The default is `'select-tab-if-needed'`.\r\n     */\r\n    insertBehavior?: TabBar.InsertBehavior;\r\n\r\n    /**\r\n     * The selection behavior when removing a tab.\r\n     *\r\n     * The default is `'select-tab-after'`.\r\n     */\r\n    removeBehavior?: TabBar.RemoveBehavior;\r\n\r\n    /**\r\n     * A renderer to use with the tab bar.\r\n     *\r\n     * The default is a shared renderer instance.\r\n     */\r\n    renderer?: IRenderer<T>;\r\n  }\r\n\r\n  /**\r\n   * The arguments object for the `currentChanged` signal.\r\n   */\r\n  export\r\n  interface ICurrentChangedArgs<T> {\r\n    /**\r\n     * The previously selected index.\r\n     */\r\n    readonly previousIndex: number;\r\n\r\n    /**\r\n     * The previously selected title.\r\n     */\r\n    readonly previousTitle: Title<T> | null;\r\n\r\n    /**\r\n     * The currently selected index.\r\n     */\r\n    readonly currentIndex: number;\r\n\r\n    /**\r\n     * The currently selected title.\r\n     */\r\n    readonly currentTitle: Title<T> | null;\r\n  }\r\n\r\n  /**\r\n   * The arguments object for the `tabMoved` signal.\r\n   */\r\n  export\r\n  interface ITabMovedArgs<T> {\r\n    /**\r\n     * The previous index of the tab.\r\n     */\r\n    readonly fromIndex: number;\r\n\r\n    /**\r\n     * The current index of the tab.\r\n     */\r\n    readonly toIndex: number;\r\n\r\n    /**\r\n     * The title for the tab.\r\n     */\r\n    readonly title: Title<T>;\r\n  }\r\n\r\n  /**\r\n   * The arguments object for the `tabActivateRequested` signal.\r\n   */\r\n  export\r\n  interface ITabActivateRequestedArgs<T> {\r\n    /**\r\n     * The index of the tab to activate.\r\n     */\r\n    readonly index: number;\r\n\r\n    /**\r\n     * The title for the tab.\r\n     */\r\n    readonly title: Title<T>;\r\n  }\r\n\r\n  /**\r\n   * The arguments object for the `tabCloseRequested` signal.\r\n   */\r\n  export\r\n  interface ITabCloseRequestedArgs<T> {\r\n    /**\r\n     * The index of the tab to close.\r\n     */\r\n    readonly index: number;\r\n\r\n    /**\r\n     * The title for the tab.\r\n     */\r\n    readonly title: Title<T>;\r\n  }\r\n\r\n  /**\r\n   * The arguments object for the `tabDetachRequested` signal.\r\n   */\r\n  export\r\n  interface ITabDetachRequestedArgs<T> {\r\n    /**\r\n     * The index of the tab to detach.\r\n     */\r\n    readonly index: number;\r\n\r\n    /**\r\n     * The title for the tab.\r\n     */\r\n    readonly title: Title<T>;\r\n\r\n    /**\r\n     * The node representing the tab.\r\n     */\r\n    readonly tab: HTMLElement;\r\n\r\n    /**\r\n     * The current client X position of the mouse.\r\n     */\r\n    readonly clientX: number;\r\n\r\n    /**\r\n     * The current client Y position of the mouse.\r\n     */\r\n    readonly clientY: number;\r\n  }\r\n\r\n  /**\r\n   * An object which holds the data to render a tab.\r\n   */\r\n  export\r\n  interface IRenderData<T> {\r\n    /**\r\n     * The title associated with the tab.\r\n     */\r\n    readonly title: Title<T>;\r\n\r\n    /**\r\n     * Whether the tab is the current tab.\r\n     */\r\n    readonly current: boolean;\r\n\r\n    /**\r\n     * The z-index for the tab.\r\n     */\r\n    readonly zIndex: number;\r\n  }\r\n\r\n  /**\r\n   * A renderer for use with a tab bar.\r\n   */\r\n  export\r\n  interface IRenderer<T> {\r\n    /**\r\n     * A selector which matches the close icon node in a tab.\r\n     */\r\n    readonly closeIconSelector: string;\r\n\r\n    /**\r\n     * Render the virtual element for a tab.\r\n     *\r\n     * @param data - The data to use for rendering the tab.\r\n     *\r\n     * @returns A virtual element representing the tab.\r\n     */\r\n    renderTab(data: IRenderData<T>): VirtualElement;\r\n  }\r\n\r\n  /**\r\n   * The default implementation of `IRenderer`.\r\n   *\r\n   * #### Notes\r\n   * Subclasses are free to reimplement rendering methods as needed.\r\n   */\r\n  export\r\n  class Renderer implements IRenderer<any> {\r\n    /**\r\n     * Construct a new renderer.\r\n     */\r\n    constructor() { }\r\n\r\n    /**\r\n     * A selector which matches the close icon node in a tab.\r\n     */\r\n    readonly closeIconSelector = '.lm-TabBar-tabCloseIcon';\r\n\r\n    /**\r\n     * Render the virtual element for a tab.\r\n     *\r\n     * @param data - The data to use for rendering the tab.\r\n     *\r\n     * @returns A virtual element representing the tab.\r\n     */\r\n    renderTab(data: IRenderData<any>): VirtualElement {\r\n      let title = data.title.caption;\r\n      let key = this.createTabKey(data);\r\n      let style = this.createTabStyle(data);\r\n      let className = this.createTabClass(data);\r\n      let dataset = this.createTabDataset(data);\r\n      return (\r\n        h.li({ key, className, title, style, dataset },\r\n          this.renderIcon(data),\r\n          this.renderLabel(data),\r\n          this.renderCloseIcon(data)\r\n        )\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Render the icon element for a tab.\r\n     *\r\n     * @param data - The data to use for rendering the tab.\r\n     *\r\n     * @returns A virtual element representing the tab icon.\r\n     */\r\n    renderIcon(data: IRenderData<any>): VirtualElement {\r\n      const { title } = data;\r\n      let className = this.createIconClass(data);\r\n\r\n      /* <DEPRECATED> */\r\n      if (typeof title.icon === 'string') {\r\n        return h.div({className}, title.iconLabel);\r\n      }\r\n      /* </DEPRECATED> */\r\n\r\n      // if title.icon is undefined, it will be ignored\r\n      return h.div({className}, title.icon!, title.iconLabel);\r\n    }\r\n\r\n    /**\r\n     * Render the label element for a tab.\r\n     *\r\n     * @param data - The data to use for rendering the tab.\r\n     *\r\n     * @returns A virtual element representing the tab label.\r\n     */\r\n    renderLabel(data: IRenderData<any>): VirtualElement {\r\n      return h.div({\r\n        className: 'lm-TabBar-tabLabel'\r\n          /* <DEPRECATED> */\r\n          + ' p-TabBar-tabLabel'\r\n          /* </DEPRECATED> */\r\n      }, data.title.label);\r\n    }\r\n\r\n    /**\r\n     * Render the close icon element for a tab.\r\n     *\r\n     * @param data - The data to use for rendering the tab.\r\n     *\r\n     * @returns A virtual element representing the tab close icon.\r\n     */\r\n    renderCloseIcon(data: IRenderData<any>): VirtualElement {\r\n      return h.div({\r\n        className: 'lm-TabBar-tabCloseIcon'\r\n          /* <DEPRECATED> */\r\n          + ' p-TabBar-tabCloseIcon'\r\n          /* </DEPRECATED> */\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Create a unique render key for the tab.\r\n     *\r\n     * @param data - The data to use for the tab.\r\n     *\r\n     * @returns The unique render key for the tab.\r\n     *\r\n     * #### Notes\r\n     * This method caches the key against the tab title the first time\r\n     * the key is generated. This enables efficient rendering of moved\r\n     * tabs and avoids subtle hover style artifacts.\r\n     */\r\n    createTabKey(data: IRenderData<any>): string {\r\n      let key = this._tabKeys.get(data.title);\r\n      if (key === undefined) {\r\n        key = `tab-key-${this._tabID++}`;\r\n        this._tabKeys.set(data.title, key);\r\n      }\r\n      return key;\r\n    }\r\n\r\n    /**\r\n     * Create the inline style object for a tab.\r\n     *\r\n     * @param data - The data to use for the tab.\r\n     *\r\n     * @returns The inline style data for the tab.\r\n     */\r\n    createTabStyle(data: IRenderData<any>): ElementInlineStyle {\r\n      return { zIndex: `${data.zIndex}` };\r\n    }\r\n\r\n    /**\r\n     * Create the class name for the tab.\r\n     *\r\n     * @param data - The data to use for the tab.\r\n     *\r\n     * @returns The full class name for the tab.\r\n     */\r\n    createTabClass(data: IRenderData<any>): string {\r\n      let name = 'lm-TabBar-tab';\r\n      /* <DEPRECATED> */\r\n      name += ' p-TabBar-tab';\r\n      /* </DEPRECATED> */\r\n      if (data.title.className) {\r\n        name += ` ${data.title.className}`;\r\n      }\r\n      if (data.title.closable) {\r\n        name += ' lm-mod-closable';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-closable';\r\n        /* </DEPRECATED> */\r\n      }\r\n      if (data.current) {\r\n        name += ' lm-mod-current';\r\n        /* <DEPRECATED> */\r\n        name += ' p-mod-current';\r\n        /* </DEPRECATED> */\r\n      }\r\n      return name;\r\n    }\r\n\r\n    /**\r\n     * Create the dataset for a tab.\r\n     *\r\n     * @param data - The data to use for the tab.\r\n     *\r\n     * @returns The dataset for the tab.\r\n     */\r\n    createTabDataset(data: IRenderData<any>): ElementDataset {\r\n      return data.title.dataset;\r\n    }\r\n\r\n    /**\r\n     * Create the class name for the tab icon.\r\n     *\r\n     * @param data - The data to use for the tab.\r\n     *\r\n     * @returns The full class name for the tab icon.\r\n     */\r\n    createIconClass(data: IRenderData<any>): string {\r\n      let name = 'lm-TabBar-tabIcon';\r\n      /* <DEPRECATED> */\r\n      name += ' p-TabBar-tabIcon';\r\n      /* </DEPRECATED> */\r\n      let extra = data.title.iconClass;\r\n      return extra ? `${name} ${extra}` : name;\r\n    }\r\n\r\n    private _tabID = 0;\r\n    private _tabKeys = new WeakMap<Title<any>, string>();\r\n  }\r\n\r\n  /**\r\n   * The default `Renderer` instance.\r\n   */\r\n  export\r\n  const defaultRenderer = new Renderer();\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * The start drag distance threshold.\r\n   */\r\n  export\r\n  const DRAG_THRESHOLD = 5;\r\n\r\n  /**\r\n   * The detach distance threshold.\r\n   */\r\n  export\r\n  const DETACH_THRESHOLD = 20;\r\n\r\n  /**\r\n   * A struct which holds the drag data for a tab bar.\r\n   */\r\n  export\r\n  interface IDragData {\r\n    /**\r\n     * The tab node being dragged.\r\n     */\r\n    tab: HTMLElement;\r\n\r\n    /**\r\n     * The index of the tab being dragged.\r\n     */\r\n    index: number;\r\n\r\n    /**\r\n     * The mouse press client X position.\r\n     */\r\n    pressX: number;\r\n\r\n    /**\r\n     * The mouse press client Y position.\r\n     */\r\n    pressY: number;\r\n\r\n    /**\r\n     * The offset left/top of the tab being dragged.\r\n     *\r\n     * This will be `-1` if the drag is not active.\r\n     */\r\n    tabPos: number;\r\n\r\n    /**\r\n     * The offset width/height of the tab being dragged.\r\n     *\r\n     * This will be `-1` if the drag is not active.\r\n     */\r\n    tabSize: number;\r\n\r\n    /**\r\n     * The original mouse X/Y position in tab coordinates.\r\n     *\r\n     * This will be `-1` if the drag is not active.\r\n     */\r\n    tabPressPos: number;\r\n\r\n    /**\r\n     * The tab target index upon mouse release.\r\n     *\r\n     * This will be `-1` if the drag is not active.\r\n     */\r\n    targetIndex: number;\r\n\r\n    /**\r\n     * The array of tab layout objects snapped at drag start.\r\n     *\r\n     * This will be `null` if the drag is not active.\r\n     */\r\n    tabLayout: ITabLayout[] | null;\r\n\r\n    /**\r\n     * The bounding client rect of the tab bar content node.\r\n     *\r\n     * This will be `null` if the drag is not active.\r\n     */\r\n    contentRect: ClientRect | null;\r\n\r\n    /**\r\n     * The disposable to clean up the cursor override.\r\n     *\r\n     * This will be `null` if the drag is not active.\r\n     */\r\n    override: IDisposable | null;\r\n\r\n    /**\r\n     * Whether the drag is currently active.\r\n     */\r\n    dragActive: boolean;\r\n\r\n    /**\r\n     * Whether the drag has been aborted.\r\n     */\r\n    dragAborted: boolean;\r\n\r\n    /**\r\n     * Whether a detach request as been made.\r\n     */\r\n    detachRequested: boolean;\r\n  }\r\n\r\n  /**\r\n   * An object which holds layout data for a tab.\r\n   */\r\n  export\r\n  interface ITabLayout {\r\n    /**\r\n     * The left/top margin value for the tab.\r\n     */\r\n    margin: number;\r\n\r\n    /**\r\n     * The offset left/top position of the tab.\r\n     */\r\n    pos: number;\r\n\r\n    /**\r\n     * The offset width/height of the tab.\r\n     */\r\n    size: number;\r\n  }\r\n\r\n  /**\r\n   * Create the DOM node for a tab bar.\r\n   */\r\n  export\r\n  function createNode(): HTMLDivElement {\r\n    let node = document.createElement('div');\r\n    let content = document.createElement('ul');\r\n    content.className = 'lm-TabBar-content';\r\n    /* <DEPRECATED> */\r\n    content.classList.add('p-TabBar-content');\r\n    /* </DEPRECATED> */\r\n    node.appendChild(content);\r\n    return node;\r\n  }\r\n\r\n  /**\r\n   * Coerce a title or options into a real title.\r\n   */\r\n  export\r\n  function asTitle<T>(value: Title<T> | Title.IOptions<T>): Title<T> {\r\n    return value instanceof Title ? value : new Title<T>(value);\r\n  }\r\n\r\n  /**\r\n   * Parse the transition duration for a tab node.\r\n   */\r\n  export\r\n  function parseTransitionDuration(tab: HTMLElement): number {\r\n    let style = window.getComputedStyle(tab);\r\n    return 1000 * (parseFloat(style.transitionDuration!) || 0);\r\n  }\r\n\r\n  /**\r\n   * Get a snapshot of the current tab layout values.\r\n   */\r\n  export\r\n  function snapTabLayout(tabs: HTMLCollection, orientation: TabBar.Orientation): ITabLayout[] {\r\n    let layout = new Array<ITabLayout>(tabs.length);\r\n    for (let i = 0, n = tabs.length; i < n; ++i) {\r\n      let node = tabs[i] as HTMLElement;\r\n      let style = window.getComputedStyle(node);\r\n      if (orientation === 'horizontal') {\r\n        layout[i] = {\r\n          pos: node.offsetLeft,\r\n          size: node.offsetWidth,\r\n          margin: parseFloat(style.marginLeft!) || 0\r\n        };\r\n      } else {\r\n        layout[i] = {\r\n          pos: node.offsetTop,\r\n          size: node.offsetHeight,\r\n          margin: parseFloat(style.marginTop!) || 0\r\n        };\r\n      }\r\n    }\r\n    return layout;\r\n  }\r\n\r\n  /**\r\n   * Test if the event exceeds the drag threshold.\r\n   */\r\n  export\r\n  function dragExceeded(data: IDragData, event: MouseEvent): boolean {\r\n    let dx = Math.abs(event.clientX - data.pressX);\r\n    let dy = Math.abs(event.clientY - data.pressY);\r\n    return dx >= DRAG_THRESHOLD || dy >= DRAG_THRESHOLD;\r\n  }\r\n\r\n  /**\r\n   * Test if the event exceeds the drag detach threshold.\r\n   */\r\n  export\r\n  function detachExceeded(data: IDragData, event: MouseEvent): boolean {\r\n    let rect = data.contentRect!;\r\n    return (\r\n      (event.clientX < rect.left - DETACH_THRESHOLD) ||\r\n      (event.clientX >= rect.right + DETACH_THRESHOLD) ||\r\n      (event.clientY < rect.top - DETACH_THRESHOLD) ||\r\n      (event.clientY >= rect.bottom + DETACH_THRESHOLD)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Update the relative tab positions and computed target index.\r\n   */\r\n  export\r\n  function layoutTabs(tabs: HTMLCollection, data: IDragData, event: MouseEvent, orientation: TabBar.Orientation): void {\r\n    // Compute the orientation-sensitive values.\r\n    let pressPos: number;\r\n    let localPos: number;\r\n    let clientPos: number;\r\n    let clientSize: number;\r\n    if (orientation === 'horizontal') {\r\n      pressPos = data.pressX;\r\n      localPos = event.clientX - data.contentRect!.left;\r\n      clientPos = event.clientX;\r\n      clientSize = data.contentRect!.width;\r\n    } else {\r\n      pressPos = data.pressY;\r\n      localPos = event.clientY - data.contentRect!.top;\r\n      clientPos = event.clientY;\r\n      clientSize = data.contentRect!.height;\r\n    }\r\n\r\n    // Compute the target data.\r\n    let targetIndex = data.index;\r\n    let targetPos = localPos - data.tabPressPos;\r\n    let targetEnd = targetPos + data.tabSize;\r\n\r\n    // Update the relative tab positions.\r\n    for (let i = 0, n = tabs.length; i < n; ++i) {\r\n      let pxPos: string;\r\n      let layout = data.tabLayout![i];\r\n      let threshold = layout.pos + (layout.size >> 1);\r\n      if (i < data.index && targetPos < threshold) {\r\n        pxPos = `${data.tabSize + data.tabLayout![i + 1].margin}px`;\r\n        targetIndex = Math.min(targetIndex, i);\r\n      } else if (i > data.index && targetEnd > threshold) {\r\n        pxPos = `${-data.tabSize - layout.margin}px`;\r\n        targetIndex = Math.max(targetIndex, i);\r\n      } else if (i === data.index) {\r\n        let ideal = clientPos - pressPos;\r\n        let limit = clientSize - (data.tabPos + data.tabSize);\r\n        pxPos = `${Math.max(-data.tabPos, Math.min(ideal, limit))}px`;\r\n      } else {\r\n        pxPos = '';\r\n      }\r\n      if (orientation === 'horizontal') {\r\n        (tabs[i] as HTMLElement).style.left = pxPos;\r\n      } else {\r\n        (tabs[i] as HTMLElement).style.top = pxPos;\r\n      }\r\n    }\r\n\r\n    // Update the computed target index.\r\n    data.targetIndex = targetIndex;\r\n  }\r\n\r\n  /**\r\n   * Position the drag tab at its final resting relative position.\r\n   */\r\n  export\r\n  function finalizeTabPosition(data: IDragData, orientation: TabBar.Orientation): void {\r\n    // Compute the orientation-sensitive client size.\r\n    let clientSize: number;\r\n    if (orientation === 'horizontal') {\r\n      clientSize = data.contentRect!.width;\r\n    } else {\r\n      clientSize = data.contentRect!.height;\r\n    }\r\n\r\n    // Compute the ideal final tab position.\r\n    let ideal: number;\r\n    if (data.targetIndex === data.index) {\r\n      ideal = 0;\r\n    } else if (data.targetIndex > data.index) {\r\n      let tgt = data.tabLayout![data.targetIndex];\r\n      ideal = tgt.pos + tgt.size - data.tabSize - data.tabPos;\r\n    } else {\r\n      let tgt = data.tabLayout![data.targetIndex];\r\n      ideal = tgt.pos - data.tabPos;\r\n    }\r\n\r\n    // Compute the tab position limit.\r\n    let limit = clientSize - (data.tabPos + data.tabSize);\r\n    let final = Math.max(-data.tabPos, Math.min(ideal, limit));\r\n\r\n    // Set the final orientation-sensitive position.\r\n    if (orientation === 'horizontal') {\r\n      data.tab.style.left = `${final}px`;\r\n    } else {\r\n      data.tab.style.top = `${final}px`;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Reset the relative positions of the given tabs.\r\n   */\r\n  export\r\n  function resetTabPositions(tabs: HTMLCollection, orientation: TabBar.Orientation): void {\r\n    each(tabs, tab => {\r\n      if (orientation === 'horizontal') {\r\n        (tab as HTMLElement).style.left = '';\r\n      } else {\r\n        (tab as HTMLElement).style.top = '';\r\n      }\r\n    });\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  IIterator, each, find, toArray\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  MimeData\r\n} from '@lumino/coreutils';\r\n\r\nimport {\r\n  IDisposable\r\n} from '@lumino/disposable';\r\n\r\nimport {\r\n  ElementExt, Platform\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Drag, IDragEvent\r\n} from '@lumino/dragdrop';\r\n\r\nimport {\r\n  ConflatableMessage, Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  AttachedProperty\r\n} from '@lumino/properties';\r\n\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  DockLayout\r\n} from './docklayout';\r\n\r\nimport {\r\n  TabBar\r\n} from './tabbar';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A widget which provides a flexible docking area for widgets.\r\n */\r\nexport\r\nclass DockPanel extends Widget {\r\n  /**\r\n   * Construct a new dock panel.\r\n   *\r\n   * @param options - The options for initializing the panel.\r\n   */\r\n  constructor(options: DockPanel.IOptions = {}) {\r\n    super();\r\n    this.addClass('lm-DockPanel');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-DockPanel');\r\n    /* </DEPRECATED> */\r\n    this._mode = options.mode || 'multiple-document';\r\n    this._renderer = options.renderer || DockPanel.defaultRenderer;\r\n    this._edges = options.edges || Private.DEFAULT_EDGES;\r\n    if (options.tabsMovable !== undefined) {\r\n      this._tabsMovable = options.tabsMovable;\r\n    }\r\n    if(options.tabsConstrained !== undefined){\r\n      this._tabsConstrained = options.tabsConstrained;\r\n    }\r\n\r\n    // Toggle the CSS mode attribute.\r\n    this.dataset['mode'] = this._mode;\r\n\r\n    // Create the delegate renderer for the layout.\r\n    let renderer: DockPanel.IRenderer = {\r\n      createTabBar: () => this._createTabBar(),\r\n      createHandle: () => this._createHandle()\r\n    };\r\n\r\n    // Set up the dock layout for the panel.\r\n    this.layout = new DockLayout({ renderer, spacing: options.spacing });\r\n\r\n    // Set up the overlay drop indicator.\r\n    this.overlay = options.overlay || new DockPanel.Overlay();\r\n    this.node.appendChild(this.overlay.node);\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the panel.\r\n   */\r\n  dispose(): void {\r\n    // Ensure the mouse is released.\r\n    this._releaseMouse();\r\n\r\n    // Hide the overlay.\r\n    this.overlay.hide(0);\r\n\r\n    // Cancel a drag if one is in progress.\r\n    if (this._drag) {\r\n      this._drag.dispose();\r\n    }\r\n\r\n    // Dispose of the base class.\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the layout configuration is modified.\r\n   *\r\n   * #### Notes\r\n   * This signal is emitted whenever the current layout configuration\r\n   * may have changed.\r\n   *\r\n   * This signal is emitted asynchronously in a collapsed fashion, so\r\n   * that multiple synchronous modifications results in only a single\r\n   * emit of the signal.\r\n   */\r\n  get layoutModified(): ISignal<this, void> {\r\n    return this._layoutModified;\r\n  }\r\n\r\n  /**\r\n   * The overlay used by the dock panel.\r\n   */\r\n  readonly overlay: DockPanel.IOverlay;\r\n\r\n  /**\r\n   * The renderer used by the dock panel.\r\n   */\r\n  get renderer(): DockPanel.IRenderer {\r\n    return (this.layout as DockLayout).renderer;\r\n  }\r\n\r\n  /**\r\n   * Get the spacing between the widgets.\r\n   */\r\n  get spacing(): number {\r\n    return (this.layout as DockLayout).spacing;\r\n  }\r\n\r\n  /**\r\n   * Set the spacing between the widgets.\r\n   */\r\n  set spacing(value: number) {\r\n    (this.layout as DockLayout).spacing = value;\r\n  }\r\n\r\n  /**\r\n   * Get the mode for the dock panel.\r\n   */\r\n  get mode(): DockPanel.Mode {\r\n    return this._mode;\r\n  }\r\n\r\n  /**\r\n   * Set the mode for the dock panel.\r\n   *\r\n   * #### Notes\r\n   * Changing the mode is a destructive operation with respect to the\r\n   * panel's layout configuration. If layout state must be preserved,\r\n   * save the current layout config before changing the mode.\r\n   */\r\n  set mode(value: DockPanel.Mode) {\r\n    // Bail early if the mode does not change.\r\n    if (this._mode === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal mode.\r\n    this._mode = value;\r\n\r\n    // Toggle the CSS mode attribute.\r\n    this.dataset['mode'] = value;\r\n\r\n    // Get the layout for the panel.\r\n    let layout = this.layout as DockLayout;\r\n\r\n    // Configure the layout for the specified mode.\r\n    switch (value) {\r\n    case 'multiple-document':\r\n      each(layout.tabBars(), tabBar => { tabBar.show(); });\r\n      break;\r\n    case 'single-document':\r\n      layout.restoreLayout(Private.createSingleDocumentConfig(this));\r\n      break;\r\n    default:\r\n      throw 'unreachable';\r\n    }\r\n\r\n    // Schedule an emit of the layout modified signal.\r\n    MessageLoop.postMessage(this, Private.LayoutModified);\r\n  }\r\n\r\n  /**\r\n   * Whether the tabs can be dragged / moved at runtime.\r\n   */\r\n  get tabsMovable(): boolean {\r\n    return this._tabsMovable;\r\n  }\r\n  \r\n\r\n  /**\r\n   * Enable / Disable draggable / movable tabs.\r\n   */\r\n  set tabsMovable(value: boolean) {\r\n    this._tabsMovable = value;\r\n    each(this.tabBars(), (tabbar) => { tabbar.tabsMovable = value });\r\n  }\r\n\r\n  /**\r\n   * Whether the tabs are constrained to their source dock panel\r\n   */\r\n  get tabsConstrained(): boolean{\r\n    return this._tabsConstrained;\r\n  }\r\n\r\n  /**\r\n   * Constrain/Allow tabs to be dragged outside of this dock panel\r\n   */\r\n  set tabsConstrained(value:boolean) {\r\n    this._tabsConstrained = value;\r\n  }\r\n\r\n  /**\r\n   * Whether the dock panel is empty.\r\n   */\r\n  get isEmpty(): boolean {\r\n    return (this.layout as DockLayout).isEmpty;\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the user widgets in the panel.\r\n   *\r\n   * @returns A new iterator over the user widgets in the panel.\r\n   *\r\n   * #### Notes\r\n   * This iterator does not include the generated tab bars.\r\n   */\r\n  widgets(): IIterator<Widget> {\r\n    return (this.layout as DockLayout).widgets();\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the selected widgets in the panel.\r\n   *\r\n   * @returns A new iterator over the selected user widgets.\r\n   *\r\n   * #### Notes\r\n   * This iterator yields the widgets corresponding to the current tab\r\n   * of each tab bar in the panel.\r\n   */\r\n  selectedWidgets(): IIterator<Widget> {\r\n    return (this.layout as DockLayout).selectedWidgets();\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the tab bars in the panel.\r\n   *\r\n   * @returns A new iterator over the tab bars in the panel.\r\n   *\r\n   * #### Notes\r\n   * This iterator does not include the user widgets.\r\n   */\r\n  tabBars(): IIterator<TabBar<Widget>> {\r\n    return (this.layout as DockLayout).tabBars();\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the handles in the panel.\r\n   *\r\n   * @returns A new iterator over the handles in the panel.\r\n   */\r\n  handles(): IIterator<HTMLDivElement> {\r\n    return (this.layout as DockLayout).handles();\r\n  }\r\n\r\n  /**\r\n   * Select a specific widget in the dock panel.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * #### Notes\r\n   * This will make the widget the current widget in its tab area.\r\n   */\r\n  selectWidget(widget: Widget): void {\r\n    // Find the tab bar which contains the widget.\r\n    let tabBar = find(this.tabBars(), bar => {\r\n      return bar.titles.indexOf(widget.title) !== -1;\r\n    });\r\n\r\n    // Throw an error if no tab bar is found.\r\n    if (!tabBar) {\r\n      throw new Error('Widget is not contained in the dock panel.');\r\n    }\r\n\r\n    // Ensure the widget is the current widget.\r\n    tabBar.currentTitle = widget.title;\r\n  }\r\n\r\n  /**\r\n   * Activate a specified widget in the dock panel.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * #### Notes\r\n   * This will select and activate the given widget.\r\n   */\r\n  activateWidget(widget: Widget): void {\r\n    this.selectWidget(widget);\r\n    widget.activate();\r\n  }\r\n\r\n  /**\r\n   * Save the current layout configuration of the dock panel.\r\n   *\r\n   * @returns A new config object for the current layout state.\r\n   *\r\n   * #### Notes\r\n   * The return value can be provided to the `restoreLayout` method\r\n   * in order to restore the layout to its current configuration.\r\n   */\r\n  saveLayout(): DockPanel.ILayoutConfig {\r\n    return (this.layout as DockLayout).saveLayout();\r\n  }\r\n\r\n  /**\r\n   * Restore the layout to a previously saved configuration.\r\n   *\r\n   * @param config - The layout configuration to restore.\r\n   *\r\n   * #### Notes\r\n   * Widgets which currently belong to the layout but which are not\r\n   * contained in the config will be unparented.\r\n   *\r\n   * The dock panel automatically reverts to `'multiple-document'`\r\n   * mode when a layout config is restored.\r\n   */\r\n  restoreLayout(config: DockPanel.ILayoutConfig): void {\r\n    // Reset the mode.\r\n    this._mode = 'multiple-document';\r\n\r\n    // Restore the layout.\r\n    (this.layout as DockLayout).restoreLayout(config);\r\n\r\n    // Flush the message loop on IE and Edge to prevent flicker.\r\n    if (Platform.IS_EDGE || Platform.IS_IE) {\r\n      MessageLoop.flush();\r\n    }\r\n\r\n    // Schedule an emit of the layout modified signal.\r\n    MessageLoop.postMessage(this, Private.LayoutModified);\r\n  }\r\n\r\n  /**\r\n   * Add a widget to the dock panel.\r\n   *\r\n   * @param widget - The widget to add to the dock panel.\r\n   *\r\n   * @param options - The additional options for adding the widget.\r\n   *\r\n   * #### Notes\r\n   * If the panel is in single document mode, the options are ignored\r\n   * and the widget is always added as tab in the hidden tab bar.\r\n   */\r\n  addWidget(widget: Widget, options: DockPanel.IAddOptions = {}): void {\r\n    // Add the widget to the layout.\r\n    if (this._mode === 'single-document') {\r\n      (this.layout as DockLayout).addWidget(widget);\r\n    } else {\r\n      (this.layout as DockLayout).addWidget(widget, options);\r\n    }\r\n\r\n    // Schedule an emit of the layout modified signal.\r\n    MessageLoop.postMessage(this, Private.LayoutModified);\r\n  }\r\n\r\n  /**\r\n   * Process a message sent to the widget.\r\n   *\r\n   * @param msg - The message sent to the widget.\r\n   */\r\n  processMessage(msg: Message): void {\r\n    if (msg.type === 'layout-modified') {\r\n      this._layoutModified.emit(undefined);\r\n    } else {\r\n      super.processMessage(msg);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the DOM events for the dock panel.\r\n   *\r\n   * @param event - The DOM event sent to the panel.\r\n   *\r\n   * #### Notes\r\n   * This method implements the DOM `EventListener` interface and is\r\n   * called in response to events on the panel's DOM node. It should\r\n   * not be called directly by user code.\r\n   */\r\n  handleEvent(event: Event): void {\r\n    switch (event.type) {\r\n    case 'lm-dragenter':\r\n      this._evtDragEnter(event as IDragEvent);\r\n      break;\r\n    case 'lm-dragleave':\r\n      this._evtDragLeave(event as IDragEvent);\r\n      break;\r\n    case 'lm-dragover':\r\n      this._evtDragOver(event as IDragEvent);\r\n      break;\r\n    case 'lm-drop':\r\n      this._evtDrop(event as IDragEvent);\r\n      break;\r\n    case 'touchstart':\r\n      event = Drag.convertTouchToMouseEvent(event as TouchEvent);\r\n    case 'mousedown':\r\n      this._evtMouseDown(event as MouseEvent);\r\n      break;\r\n    case 'touchmove':\r\n      event = Drag.convertTouchToMouseEvent(event as TouchEvent);\r\n    case 'mousemove':\r\n      this._evtMouseMove(event as MouseEvent);\r\n      break;\r\n    case 'touchend':\r\n      event = Drag.convertTouchToMouseEvent(event as TouchEvent);\r\n    case 'mouseup':\r\n      this._evtMouseUp(event as MouseEvent);\r\n      break;\r\n    case 'keydown':\r\n      this._evtKeyDown(event as KeyboardEvent);\r\n      break;\r\n    case 'contextmenu':\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    this.node.addEventListener('lm-dragenter', this);\r\n    this.node.addEventListener('lm-dragleave', this);\r\n    this.node.addEventListener('lm-dragover', this);\r\n    this.node.addEventListener('lm-drop', this);\r\n    this.node.addEventListener('mousedown', this);\r\n    this.node.addEventListener('touchstart', this);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-detach'` message.\r\n   */\r\n  protected onAfterDetach(msg: Message): void {\r\n    this.node.removeEventListener('lm-dragenter', this);\r\n    this.node.removeEventListener('lm-dragleave', this);\r\n    this.node.removeEventListener('lm-dragover', this);\r\n    this.node.removeEventListener('lm-drop', this);\r\n    this.node.removeEventListener('mousedown', this);\r\n    this.node.removeEventListener('touchstart', this);\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-added'` message.\r\n   */\r\n  protected onChildAdded(msg: Widget.ChildMessage): void {\r\n    // Ignore the generated tab bars.\r\n    if (Private.isGeneratedTabBarProperty.get(msg.child)) {\r\n      return;\r\n    }\r\n\r\n    // Add the widget class to the child.\r\n    msg.child.addClass('lm-DockPanel-widget');\r\n    /* <DEPRECATED> */\r\n    msg.child.addClass('p-DockPanel-widget');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-removed'` message.\r\n   */\r\n  protected onChildRemoved(msg: Widget.ChildMessage): void {\r\n    // Ignore the generated tab bars.\r\n    if (Private.isGeneratedTabBarProperty.get(msg.child)) {\r\n      return;\r\n    }\r\n\r\n    // Remove the widget class from the child.\r\n    msg.child.removeClass('lm-DockPanel-widget');\r\n    /* <DEPRECATED> */\r\n    msg.child.removeClass('p-DockPanel-widget');\r\n    /* </DEPRECATED> */\r\n\r\n    // Schedule an emit of the layout modified signal.\r\n    MessageLoop.postMessage(this, Private.LayoutModified);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'lm-dragenter'` event for the dock panel.\r\n   */\r\n  private _evtDragEnter(event: IDragEvent): void {\r\n    // If the factory mime type is present, mark the event as\r\n    // handled in order to get the rest of the drag events.\r\n    if (event.mimeData.hasData('application/vnd.lumino.widget-factory')) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'lm-dragleave'` event for the dock panel.\r\n   */\r\n  private _evtDragLeave(event: IDragEvent): void {\r\n    // Mark the event as handled.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // The new target might be a descendant, so we might still handle the drop.\r\n    // Hide asynchronously so that if a lm-dragover event bubbles up to us, the\r\n    // hide is cancelled by the lm-dragover handler's show overlay logic.\r\n    this.overlay.hide(1)\r\n  }\r\n\r\n  /**\r\n   * Handle the `'lm-dragover'` event for the dock panel.\r\n   */\r\n  private _evtDragOver(event: IDragEvent): void {\r\n    // Mark the event as handled.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Show the drop indicator overlay and update the drop\r\n    // action based on the drop target zone under the mouse.\r\n    if ((this._tabsConstrained && event.source !== this) || this._showOverlay(event.clientX, event.clientY) === 'invalid') {\r\n      event.dropAction = 'none';\r\n    } else {\r\n      event.dropAction = event.proposedAction;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'lm-drop'` event for the dock panel.\r\n   */\r\n  private _evtDrop(event: IDragEvent): void {\r\n    // Mark the event as handled.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Hide the drop indicator overlay.\r\n    this.overlay.hide(0);\r\n\r\n    // Bail if the proposed action is to do nothing.\r\n    if (event.proposedAction === 'none') {\r\n      event.dropAction = 'none';\r\n      return;\r\n    }\r\n\r\n    // Find the drop target under the mouse.\r\n    let { clientX, clientY } = event;\r\n    let { zone, target } = Private.findDropTarget(\r\n      this,\r\n      clientX,\r\n      clientY,\r\n      this._edges\r\n    );\r\n\r\n    // Bail if the drop zone is invalid.\r\n    if (zone === 'invalid') {\r\n      event.dropAction = 'none';\r\n      return;\r\n    }\r\n\r\n    // Bail if the factory mime type has invalid data.\r\n    let mimeData = event.mimeData;\r\n    let factory = mimeData.getData('application/vnd.lumino.widget-factory');\r\n    if (typeof factory !== 'function') {\r\n      event.dropAction = 'none';\r\n      return;\r\n    }\r\n\r\n    // Bail if the factory does not produce a widget.\r\n    let widget = factory();\r\n    if (!(widget instanceof Widget)) {\r\n      event.dropAction = 'none';\r\n      return;\r\n    }\r\n\r\n    // Bail if the widget is an ancestor of the dock panel.\r\n    if (widget.contains(this)) {\r\n      event.dropAction = 'none';\r\n      return;\r\n    }\r\n\r\n    // Find the reference widget for the drop target.\r\n    let ref = target ? Private.getDropRef(target.tabBar) : null;\r\n\r\n    // Add the widget according to the indicated drop zone.\r\n    switch(zone) {\r\n    case 'root-all':\r\n      this.addWidget(widget);\r\n      break;\r\n    case 'root-top':\r\n      this.addWidget(widget, { mode: 'split-top' });\r\n      break;\r\n    case 'root-left':\r\n      this.addWidget(widget, { mode: 'split-left' });\r\n      break;\r\n    case 'root-right':\r\n      this.addWidget(widget, { mode: 'split-right' });\r\n      break;\r\n    case 'root-bottom':\r\n      this.addWidget(widget, { mode: 'split-bottom' });\r\n      break;\r\n    case 'widget-all':\r\n      this.addWidget(widget, { mode: 'tab-after', ref });\r\n      break;\r\n    case 'widget-top':\r\n      this.addWidget(widget, { mode: 'split-top', ref });\r\n      break;\r\n    case 'widget-left':\r\n      this.addWidget(widget, { mode: 'split-left', ref });\r\n      break;\r\n    case 'widget-right':\r\n      this.addWidget(widget, { mode: 'split-right', ref });\r\n      break;\r\n    case 'widget-bottom':\r\n      this.addWidget(widget, { mode: 'split-bottom', ref });\r\n      break;\r\n    case 'widget-tab':\r\n      this.addWidget(widget, { mode: 'tab-after', ref });\r\n      break;\r\n    default:\r\n      throw 'unreachable';\r\n    }\r\n\r\n    // Accept the proposed drop action.\r\n    event.dropAction = event.proposedAction;\r\n\r\n    // Activate the dropped widget.\r\n    this.activateWidget(widget);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'keydown'` event for the dock panel.\r\n   */\r\n  private _evtKeyDown(event: KeyboardEvent): void {\r\n    // Stop input events during drag.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Release the mouse if `Escape` is pressed.\r\n    if (event.keyCode === 27) {\r\n      // Finalize the mouse release.\r\n      this._releaseMouse();\r\n\r\n      // Schedule an emit of the layout modified signal.\r\n      MessageLoop.postMessage(this, Private.LayoutModified);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousedown'` event for the dock panel.\r\n   */\r\n  private _evtMouseDown(event: MouseEvent): void {\r\n    // Do nothing if the left mouse button is not pressed.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Find the handle which contains the mouse target, if any.\r\n    let layout = this.layout as DockLayout;\r\n    let target = event.target as HTMLElement;\r\n    let handle = find(layout.handles(), handle => handle.contains(target));\r\n    if (!handle) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event when a handle is pressed.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Add the extra document listeners.\r\n    document.addEventListener('keydown', this, true);\r\n    document.addEventListener('mouseup', this, true);\r\n    document.addEventListener('touchend', this, true);\r\n    document.addEventListener('mousemove', this, true);\r\n    document.addEventListener('touchmove', this, true);\r\n    document.addEventListener('contextmenu', this, true);\r\n\r\n    // Compute the offset deltas for the handle press.\r\n    let rect = handle.getBoundingClientRect();\r\n    let deltaX = event.clientX - rect.left;\r\n    let deltaY = event.clientY - rect.top;\r\n\r\n    // Override the cursor and store the press data.\r\n    let style = window.getComputedStyle(handle);\r\n    let override = Drag.overrideCursor(style.cursor!);\r\n    this._pressData = { handle, deltaX, deltaY, override };\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousemove'` event for the dock panel.\r\n   */\r\n  private _evtMouseMove(event: MouseEvent): void {\r\n    // Bail early if no drag is in progress.\r\n    if (!this._pressData) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event when dragging a handle.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Compute the desired offset position for the handle.\r\n    let rect = this.node.getBoundingClientRect();\r\n    let xPos = event.clientX - rect.left - this._pressData.deltaX;\r\n    let yPos = event.clientY - rect.top - this._pressData.deltaY;\r\n\r\n    // Set the handle as close to the desired position as possible.\r\n    let layout = this.layout as DockLayout;\r\n    layout.moveHandle(this._pressData.handle, xPos, yPos);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mouseup'` event for the dock panel.\r\n   */\r\n  private _evtMouseUp(event: MouseEvent): void {\r\n    // Do nothing if the left mouse button is not released.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event when releasing a handle.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Finalize the mouse release.\r\n    this._releaseMouse();\r\n\r\n    // Schedule an emit of the layout modified signal.\r\n    MessageLoop.postMessage(this, Private.LayoutModified);\r\n  }\r\n\r\n  /**\r\n   * Release the mouse grab for the dock panel.\r\n   */\r\n  private _releaseMouse(): void {\r\n    // Bail early if no drag is in progress.\r\n    if (!this._pressData) {\r\n      return;\r\n    }\r\n\r\n    // Clear the override cursor.\r\n    this._pressData.override.dispose();\r\n    this._pressData = null;\r\n\r\n    // Remove the extra document listeners.\r\n    document.removeEventListener('keydown', this, true);\r\n    document.removeEventListener('mouseup', this, true);\r\n    document.removeEventListener('touchend', this, true);\r\n    document.removeEventListener('mousemove', this, true);\r\n    document.removeEventListener('touchmove', this, true);\r\n    document.removeEventListener('contextmenu', this, true);\r\n  }\r\n\r\n  /**\r\n   * Show the overlay indicator at the given client position.\r\n   *\r\n   * Returns the drop zone at the specified client position.\r\n   *\r\n   * #### Notes\r\n   * If the position is not over a valid zone, the overlay is hidden.\r\n   */\r\n  private _showOverlay(clientX: number, clientY: number): Private.DropZone {\r\n    // Find the dock target for the given client position.\r\n    let { zone, target } = Private.findDropTarget(\r\n      this,\r\n      clientX,\r\n      clientY,\r\n      this._edges\r\n    );\r\n\r\n    // If the drop zone is invalid, hide the overlay and bail.\r\n    if (zone === 'invalid') {\r\n      this.overlay.hide(100);\r\n      return zone;\r\n    }\r\n\r\n    // Setup the variables needed to compute the overlay geometry.\r\n    let top: number;\r\n    let left: number;\r\n    let right: number;\r\n    let bottom: number;\r\n    let box = ElementExt.boxSizing(this.node); // TODO cache this?\r\n    let rect = this.node.getBoundingClientRect();\r\n\r\n    // Compute the overlay geometry based on the dock zone.\r\n    switch (zone) {\r\n    case 'root-all':\r\n      top = box.paddingTop;\r\n      left = box.paddingLeft;\r\n      right = box.paddingRight;\r\n      bottom = box.paddingBottom;\r\n      break;\r\n    case 'root-top':\r\n      top = box.paddingTop;\r\n      left = box.paddingLeft;\r\n      right = box.paddingRight;\r\n      bottom = rect.height * Private.GOLDEN_RATIO;\r\n      break;\r\n    case 'root-left':\r\n      top = box.paddingTop;\r\n      left = box.paddingLeft;\r\n      right = rect.width * Private.GOLDEN_RATIO;\r\n      bottom = box.paddingBottom;\r\n      break;\r\n    case 'root-right':\r\n      top = box.paddingTop;\r\n      left = rect.width * Private.GOLDEN_RATIO;\r\n      right = box.paddingRight;\r\n      bottom = box.paddingBottom;\r\n      break;\r\n    case 'root-bottom':\r\n      top = rect.height * Private.GOLDEN_RATIO;\r\n      left = box.paddingLeft;\r\n      right = box.paddingRight;\r\n      bottom = box.paddingBottom;\r\n      break;\r\n    case 'widget-all':\r\n      top = target!.top;\r\n      left = target!.left;\r\n      right = target!.right;\r\n      bottom = target!.bottom;\r\n      break;\r\n    case 'widget-top':\r\n      top = target!.top;\r\n      left = target!.left;\r\n      right = target!.right;\r\n      bottom = target!.bottom + target!.height / 2;\r\n      break;\r\n    case 'widget-left':\r\n      top = target!.top;\r\n      left = target!.left;\r\n      right = target!.right + target!.width / 2;\r\n      bottom = target!.bottom;\r\n      break;\r\n    case 'widget-right':\r\n      top = target!.top;\r\n      left = target!.left + target!.width / 2;\r\n      right = target!.right;\r\n      bottom = target!.bottom;\r\n      break;\r\n    case 'widget-bottom':\r\n      top = target!.top + target!.height / 2;\r\n      left = target!.left;\r\n      right = target!.right;\r\n      bottom = target!.bottom;\r\n      break;\r\n    case 'widget-tab':\r\n      const tabHeight = target!.tabBar.node.getBoundingClientRect().height;\r\n      top = target!.top;\r\n      left = target!.left;\r\n      right = target!.right;\r\n      bottom = target!.bottom + target!.height - tabHeight;\r\n      break;\r\n    default:\r\n      throw 'unreachable';\r\n    }\r\n\r\n    // Show the overlay with the computed geometry.\r\n    this.overlay.show({ top, left, right, bottom });\r\n\r\n    // Finally, return the computed drop zone.\r\n    return zone;\r\n  }\r\n\r\n  /**\r\n   * Create a new tab bar for use by the panel.\r\n   */\r\n  private _createTabBar(): TabBar<Widget> {\r\n    // Create the tab bar.\r\n    let tabBar = this._renderer.createTabBar();\r\n\r\n    // Set the generated tab bar property for the tab bar.\r\n    Private.isGeneratedTabBarProperty.set(tabBar, true);\r\n\r\n    // Hide the tab bar when in single document mode.\r\n    if (this._mode === 'single-document') {\r\n      tabBar.hide();\r\n    }\r\n\r\n    // Enforce necessary tab bar behavior.\r\n    // TODO do we really want to enforce *all* of these?\r\n    tabBar.tabsMovable = this._tabsMovable;\r\n    tabBar.allowDeselect = false;\r\n    tabBar.removeBehavior = 'select-previous-tab';\r\n    tabBar.insertBehavior = 'select-tab-if-needed';\r\n\r\n    // Connect the signal handlers for the tab bar.\r\n    tabBar.tabMoved.connect(this._onTabMoved, this);\r\n    tabBar.currentChanged.connect(this._onCurrentChanged, this);\r\n    tabBar.tabCloseRequested.connect(this._onTabCloseRequested, this);\r\n    tabBar.tabDetachRequested.connect(this._onTabDetachRequested, this);\r\n    tabBar.tabActivateRequested.connect(this._onTabActivateRequested, this);\r\n\r\n    // Return the initialized tab bar.\r\n    return tabBar;\r\n  }\r\n\r\n  /**\r\n   * Create a new handle for use by the panel.\r\n   */\r\n  private _createHandle(): HTMLDivElement {\r\n    return this._renderer.createHandle();\r\n  }\r\n\r\n  /**\r\n   * Handle the `tabMoved` signal from a tab bar.\r\n   */\r\n  private _onTabMoved(): void {\r\n    MessageLoop.postMessage(this, Private.LayoutModified);\r\n  }\r\n\r\n  /**\r\n   * Handle the `currentChanged` signal from a tab bar.\r\n   */\r\n  private _onCurrentChanged(sender: TabBar<Widget>, args: TabBar.ICurrentChangedArgs<Widget>): void {\r\n    // Extract the previous and current title from the args.\r\n    let { previousTitle, currentTitle } = args;\r\n\r\n    // Hide the previous widget.\r\n    if (previousTitle) {\r\n      previousTitle.owner.hide();\r\n    }\r\n\r\n    // Show the current widget.\r\n    if (currentTitle) {\r\n      currentTitle.owner.show();\r\n    }\r\n\r\n    // Flush the message loop on IE and Edge to prevent flicker.\r\n    if (Platform.IS_EDGE || Platform.IS_IE) {\r\n      MessageLoop.flush();\r\n    }\r\n\r\n    // Schedule an emit of the layout modified signal.\r\n    MessageLoop.postMessage(this, Private.LayoutModified);\r\n  }\r\n\r\n  /**\r\n   * Handle the `tabActivateRequested` signal from a tab bar.\r\n   */\r\n  private _onTabActivateRequested(sender: TabBar<Widget>, args: TabBar.ITabActivateRequestedArgs<Widget>): void {\r\n    args.title.owner.activate();\r\n  }\r\n\r\n  /**\r\n   * Handle the `tabCloseRequested` signal from a tab bar.\r\n   */\r\n  private _onTabCloseRequested(sender: TabBar<Widget>, args: TabBar.ITabCloseRequestedArgs<Widget>): void {\r\n    args.title.owner.close();\r\n  }\r\n\r\n  /**\r\n   * Handle the `tabDetachRequested` signal from a tab bar.\r\n   */\r\n  private _onTabDetachRequested(sender: TabBar<Widget>, args: TabBar.ITabDetachRequestedArgs<Widget>): void {\r\n    // Do nothing if a drag is already in progress.\r\n    if (this._drag) {\r\n      return;\r\n    }\r\n\r\n    // Release the tab bar's hold on the mouse.\r\n    sender.releaseMouse();\r\n\r\n    // Extract the data from the args.\r\n    let { title, tab, clientX, clientY } = args;\r\n\r\n    // Setup the mime data for the drag operation.\r\n    let mimeData = new MimeData();\r\n    let factory = () => title.owner;\r\n    mimeData.setData('application/vnd.lumino.widget-factory', factory);\r\n\r\n    // Create the drag image for the drag operation.\r\n    let dragImage = tab.cloneNode(true) as HTMLElement;\r\n\r\n    // Create the drag object to manage the drag-drop operation.\r\n    this._drag = new Drag({\r\n      mimeData, dragImage,\r\n      proposedAction: 'move',\r\n      supportedActions: 'move',\r\n      source: this\r\n    });\r\n\r\n    // Hide the tab node in the original tab.\r\n    tab.classList.add('lm-mod-hidden');\r\n    /* <DEPRECATED> */\r\n    tab.classList.add('p-mod-hidden');\r\n    /* </DEPRECATED> */;\r\n\r\n    // Create the cleanup callback.\r\n    let cleanup = (() => {\r\n      this._drag = null;\r\n      tab.classList.remove('lm-mod-hidden');\r\n      /* <DEPRECATED> */\r\n      tab.classList.remove('p-mod-hidden');\r\n      /* </DEPRECATED> */;\r\n    });\r\n\r\n    // Start the drag operation and cleanup when done.\r\n    this._drag.start(clientX, clientY).then(cleanup);\r\n  }\r\n\r\n  private _edges: DockPanel.IEdges;\r\n  private _mode: DockPanel.Mode;\r\n  private _drag: Drag | null = null;\r\n  private _renderer: DockPanel.IRenderer;\r\n  private _tabsMovable: boolean = true;\r\n  private _tabsConstrained: boolean = false;\r\n  private _pressData: Private.IPressData | null = null;\r\n  private _layoutModified = new Signal<this, void>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `DockPanel` class statics.\r\n */\r\nexport\r\nnamespace DockPanel {\r\n  /**\r\n   * An options object for creating a dock panel.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The overlay to use with the dock panel.\r\n     *\r\n     * The default is a new `Overlay` instance.\r\n     */\r\n    overlay?: IOverlay;\r\n\r\n    /**\r\n     * The renderer to use for the dock panel.\r\n     *\r\n     * The default is a shared renderer instance.\r\n     */\r\n    renderer?: IRenderer;\r\n\r\n    /**\r\n     * The spacing between the items in the panel.\r\n     *\r\n     * The default is `4`.\r\n     */\r\n    spacing?: number;\r\n\r\n    /**\r\n     * The mode for the dock panel.\r\n     *\r\n     * The default is `'multiple-document'`.\r\n     */\r\n    mode?: DockPanel.Mode;\r\n\r\n    /**\r\n     * The sizes of the edge drop zones, in pixels.\r\n     * If not given, default values will be used.\r\n     */\r\n    edges?: IEdges;\r\n\r\n    /**\r\n     * Allow tabs to be draggable / movable by user.\r\n     *\r\n     * The default is `'true'`.\r\n     */\r\n    tabsMovable?: boolean;\r\n\r\n    /**\r\n     * Constrain tabs to this dock panel\r\n     * \r\n     * The default is `'false'`.\r\n     */\r\n    tabsConstrained?: boolean;\r\n  }\r\n\r\n  /**\r\n   * The sizes of the edge drop zones, in pixels.\r\n   */\r\n  export interface IEdges {\r\n    /**\r\n     * The size of the top edge drop zone.\r\n     */\r\n    top: number;\r\n\r\n    /**\r\n     * The size of the right edge drop zone.\r\n     */\r\n    right: number;\r\n\r\n    /**\r\n     * The size of the bottom edge drop zone.\r\n     */\r\n    bottom: number;\r\n\r\n    /**\r\n     * The size of the left edge drop zone.\r\n     */\r\n    left: number;\r\n  };\r\n\r\n  /**\r\n   * A type alias for the supported dock panel modes.\r\n   */\r\n  export\r\n  type Mode = (\r\n    /**\r\n     * The single document mode.\r\n     *\r\n     * In this mode, only a single widget is visible at a time, and that\r\n     * widget fills the available layout space. No tab bars are visible.\r\n     */\r\n    'single-document' |\r\n\r\n    /**\r\n     * The multiple document mode.\r\n     *\r\n     * In this mode, multiple documents are displayed in separate tab\r\n     * areas, and those areas can be individually resized by the user.\r\n     */\r\n    'multiple-document'\r\n  );\r\n\r\n  /**\r\n   * A type alias for a layout configuration object.\r\n   */\r\n  export\r\n  type ILayoutConfig = DockLayout.ILayoutConfig;\r\n\r\n  /**\r\n   * A type alias for the supported insertion modes.\r\n   */\r\n  export\r\n  type InsertMode = DockLayout.InsertMode;\r\n\r\n  /**\r\n   * A type alias for the add widget options.\r\n   */\r\n  export\r\n  type IAddOptions = DockLayout.IAddOptions;\r\n\r\n  /**\r\n   * An object which holds the geometry for overlay positioning.\r\n   */\r\n  export\r\n  interface IOverlayGeometry {\r\n    /**\r\n     * The distance between the overlay and parent top edges.\r\n     */\r\n    top: number;\r\n\r\n    /**\r\n     * The distance between the overlay and parent left edges.\r\n     */\r\n    left: number;\r\n\r\n    /**\r\n     * The distance between the overlay and parent right edges.\r\n     */\r\n    right: number;\r\n\r\n    /**\r\n     * The distance between the overlay and parent bottom edges.\r\n     */\r\n    bottom: number;\r\n  }\r\n\r\n  /**\r\n   * An object which manages the overlay node for a dock panel.\r\n   */\r\n  export\r\n  interface IOverlay {\r\n    /**\r\n     * The DOM node for the overlay.\r\n     */\r\n    readonly node: HTMLDivElement;\r\n\r\n    /**\r\n     * Show the overlay using the given overlay geometry.\r\n     *\r\n     * @param geo - The desired geometry for the overlay.\r\n     *\r\n     * #### Notes\r\n     * The given geometry values assume the node will use absolute\r\n     * positioning.\r\n     *\r\n     * This is called on every mouse move event during a drag in order\r\n     * to update the position of the overlay. It should be efficient.\r\n     */\r\n    show(geo: IOverlayGeometry): void;\r\n\r\n    /**\r\n     * Hide the overlay node.\r\n     *\r\n     * @param delay - The delay (in ms) before hiding the overlay.\r\n     *   A delay value <= 0 should hide the overlay immediately.\r\n     *\r\n     * #### Notes\r\n     * This is called whenever the overlay node should been hidden.\r\n     */\r\n    hide(delay: number): void;\r\n  }\r\n\r\n  /**\r\n   * A concrete implementation of `IOverlay`.\r\n   *\r\n   * This is the default overlay implementation for a dock panel.\r\n   */\r\n  export\r\n  class Overlay implements IOverlay {\r\n    /**\r\n     * Construct a new overlay.\r\n     */\r\n    constructor() {\r\n      this.node = document.createElement('div');\r\n      this.node.classList.add('lm-DockPanel-overlay');\r\n      this.node.classList.add('lm-mod-hidden');\r\n      /* <DEPRECATED> */\r\n      this.node.classList.add('p-DockPanel-overlay');\r\n      this.node.classList.add('p-mod-hidden');\r\n      /* </DEPRECATED> */;\r\n      this.node.style.position = 'absolute';\r\n    }\r\n\r\n    /**\r\n     * The DOM node for the overlay.\r\n     */\r\n    readonly node: HTMLDivElement;\r\n\r\n    /**\r\n     * Show the overlay using the given overlay geometry.\r\n     *\r\n     * @param geo - The desired geometry for the overlay.\r\n     */\r\n    show(geo: IOverlayGeometry): void {\r\n      // Update the position of the overlay.\r\n      let style = this.node.style;\r\n      style.top = `${geo.top}px`;\r\n      style.left = `${geo.left}px`;\r\n      style.right = `${geo.right}px`;\r\n      style.bottom = `${geo.bottom}px`;\r\n\r\n      // Clear any pending hide timer.\r\n      clearTimeout(this._timer);\r\n      this._timer = -1;\r\n\r\n      // If the overlay is already visible, we're done.\r\n      if (!this._hidden) {\r\n        return;\r\n      }\r\n\r\n      // Clear the hidden flag.\r\n      this._hidden = false;\r\n\r\n      // Finally, show the overlay.\r\n      this.node.classList.remove('lm-mod-hidden');\r\n      /* <DEPRECATED> */\r\n      this.node.classList.remove('p-mod-hidden');\r\n      /* </DEPRECATED> */;\r\n    }\r\n\r\n    /**\r\n     * Hide the overlay node.\r\n     *\r\n     * @param delay - The delay (in ms) before hiding the overlay.\r\n     *   A delay value <= 0 will hide the overlay immediately.\r\n     */\r\n    hide(delay: number): void {\r\n      // Do nothing if the overlay is already hidden.\r\n      if (this._hidden) {\r\n        return;\r\n      }\r\n\r\n      // Hide immediately if the delay is <= 0.\r\n      if (delay <= 0) {\r\n        clearTimeout(this._timer);\r\n        this._timer = -1;\r\n        this._hidden = true;\r\n        this.node.classList.add('lm-mod-hidden');\r\n        /* <DEPRECATED> */\r\n        this.node.classList.add('p-mod-hidden');\r\n        /* </DEPRECATED> */;\r\n        return;\r\n      }\r\n\r\n      // Do nothing if a hide is already pending.\r\n      if (this._timer !== -1) {\r\n        return;\r\n      }\r\n\r\n      // Otherwise setup the hide timer.\r\n      this._timer = window.setTimeout(() => {\r\n        this._timer = -1;\r\n        this._hidden = true;\r\n        this.node.classList.add('lm-mod-hidden');\r\n        /* <DEPRECATED> */\r\n        this.node.classList.add('p-mod-hidden');\r\n        /* </DEPRECATED> */;\r\n      }, delay);\r\n    }\r\n\r\n    private _timer = -1;\r\n    private _hidden = true;\r\n  }\r\n\r\n  /**\r\n   * A type alias for a dock panel renderer;\r\n   */\r\n  export\r\n  type IRenderer = DockLayout.IRenderer;\r\n\r\n  /**\r\n   * The default implementation of `IRenderer`.\r\n   */\r\n  export\r\n  class Renderer implements IRenderer {\r\n    /**\r\n     * Create a new tab bar for use with a dock panel.\r\n     *\r\n     * @returns A new tab bar for a dock panel.\r\n     */\r\n    createTabBar(): TabBar<Widget> {\r\n      let bar = new TabBar<Widget>();\r\n      bar.addClass('lm-DockPanel-tabBar');\r\n      /* <DEPRECATED> */\r\n      bar.addClass('p-DockPanel-tabBar');\r\n      /* </DEPRECATED> */\r\n      return bar;\r\n    }\r\n\r\n    /**\r\n     * Create a new handle node for use with a dock panel.\r\n     *\r\n     * @returns A new handle node for a dock panel.\r\n     */\r\n    createHandle(): HTMLDivElement {\r\n      let handle = document.createElement('div');\r\n      handle.className = 'lm-DockPanel-handle';\r\n      /* <DEPRECATED> */\r\n      handle.classList.add('p-DockPanel-handle');\r\n      /* </DEPRECATED> */;\r\n      return handle;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The default `Renderer` instance.\r\n   */\r\n  export\r\n  const defaultRenderer = new Renderer();\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * A fraction used for sizing root panels; ~= `1 / golden_ratio`.\r\n   */\r\n  export\r\n  const GOLDEN_RATIO = 0.618;\r\n\r\n  /**\r\n   * The default sizes for the edge drop zones, in pixels.\r\n   */\r\n  export const DEFAULT_EDGES = {\r\n    /**\r\n     * The size of the top edge dock zone for the root panel, in pixels.\r\n     * This is different from the others to distinguish between the top\r\n     * tab bar and the top root zone.\r\n     */\r\n    top: 12,\r\n\r\n    /**\r\n     * The size of the edge dock zone for the root panel, in pixels.\r\n     */\r\n    right: 40,\r\n\r\n    /**\r\n     * The size of the edge dock zone for the root panel, in pixels.\r\n     */\r\n    bottom: 40,\r\n\r\n    /**\r\n     * The size of the edge dock zone for the root panel, in pixels.\r\n     */\r\n    left: 40\r\n  };\r\n\r\n  /**\r\n   * A singleton `'layout-modified'` conflatable message.\r\n   */\r\n  export\r\n  const LayoutModified = new ConflatableMessage('layout-modified');\r\n\r\n  /**\r\n   * An object which holds mouse press data.\r\n   */\r\n  export\r\n  interface IPressData {\r\n    /**\r\n     * The handle which was pressed.\r\n     */\r\n    handle: HTMLDivElement;\r\n\r\n    /**\r\n     * The X offset of the press in handle coordinates.\r\n     */\r\n    deltaX: number;\r\n\r\n    /**\r\n     * The Y offset of the press in handle coordinates.\r\n     */\r\n    deltaY: number;\r\n\r\n    /**\r\n     * The disposable which will clear the override cursor.\r\n     */\r\n    override: IDisposable;\r\n  }\r\n\r\n  /**\r\n   * A type alias for a drop zone.\r\n   */\r\n  export\r\n  type DropZone = (\r\n    /**\r\n     * An invalid drop zone.\r\n     */\r\n    'invalid' |\r\n\r\n    /**\r\n     * The entirety of the root dock area.\r\n     */\r\n    'root-all' |\r\n\r\n    /**\r\n     * The top portion of the root dock area.\r\n     */\r\n    'root-top' |\r\n\r\n    /**\r\n     * The left portion of the root dock area.\r\n     */\r\n    'root-left' |\r\n\r\n    /**\r\n     * The right portion of the root dock area.\r\n     */\r\n    'root-right' |\r\n\r\n    /**\r\n     * The bottom portion of the root dock area.\r\n     */\r\n    'root-bottom' |\r\n\r\n    /**\r\n     * The entirety of a tabbed widget area.\r\n     */\r\n    'widget-all' |\r\n\r\n    /**\r\n     * The top portion of tabbed widget area.\r\n     */\r\n    'widget-top' |\r\n\r\n    /**\r\n     * The left portion of tabbed widget area.\r\n     */\r\n    'widget-left' |\r\n\r\n    /**\r\n     * The right portion of tabbed widget area.\r\n     */\r\n    'widget-right' |\r\n\r\n    /**\r\n     * The bottom portion of tabbed widget area.\r\n     */\r\n    'widget-bottom' |\r\n\r\n    /**\r\n     * The the bar of a tabbed widget area.\r\n     */\r\n    'widget-tab'\r\n  );\r\n\r\n  /**\r\n   * An object which holds the drop target zone and widget.\r\n   */\r\n  export\r\n  interface IDropTarget {\r\n    /**\r\n     * The semantic zone for the mouse position.\r\n     */\r\n    zone: DropZone;\r\n\r\n    /**\r\n     * The tab area geometry for the drop zone, or `null`.\r\n     */\r\n    target: DockLayout.ITabAreaGeometry | null;\r\n  }\r\n\r\n  /**\r\n   * An attached property used to track generated tab bars.\r\n   */\r\n  export\r\n  const isGeneratedTabBarProperty = new AttachedProperty<Widget, boolean>({\r\n    name: 'isGeneratedTabBar',\r\n    create: () => false\r\n  });\r\n\r\n  /**\r\n   * Create a single document config for the widgets in a dock panel.\r\n   */\r\n  export\r\n  function createSingleDocumentConfig(panel: DockPanel): DockPanel.ILayoutConfig {\r\n    // Return an empty config if the panel is empty.\r\n    if (panel.isEmpty) {\r\n      return { main: null };\r\n    }\r\n\r\n    // Get a flat array of the widgets in the panel.\r\n    let widgets = toArray(panel.widgets());\r\n\r\n    // Get the first selected widget in the panel.\r\n    let selected = panel.selectedWidgets().next();\r\n\r\n    // Compute the current index for the new config.\r\n    let currentIndex = selected ? widgets.indexOf(selected) : -1;\r\n\r\n    // Return the single document config.\r\n    return { main: { type: 'tab-area', widgets, currentIndex } };\r\n  }\r\n\r\n  /**\r\n   * Find the drop target at the given client position.\r\n   */\r\n  export\r\n  function findDropTarget(\r\n    panel: DockPanel,\r\n    clientX: number,\r\n    clientY: number,\r\n    edges: DockPanel.IEdges\r\n  ): IDropTarget {\r\n    // Bail if the mouse is not over the dock panel.\r\n    if (!ElementExt.hitTest(panel.node, clientX, clientY)) {\r\n      return { zone: 'invalid', target: null };\r\n    }\r\n\r\n    // Look up the layout for the panel.\r\n    let layout = panel.layout as DockLayout;\r\n\r\n    // If the layout is empty, indicate the entire root drop zone.\r\n    if (layout.isEmpty) {\r\n      return { zone: 'root-all', target: null };\r\n    }\r\n\r\n    // Test the edge zones when in multiple document mode.\r\n    if (panel.mode === 'multiple-document') {\r\n      // Get the client rect for the dock panel.\r\n      let panelRect = panel.node.getBoundingClientRect();\r\n\r\n      // Compute the distance to each edge of the panel.\r\n      let pl = clientX - panelRect.left + 1;\r\n      let pt = clientY - panelRect.top + 1;\r\n      let pr = panelRect.right - clientX;\r\n      let pb = panelRect.bottom - clientY;\r\n\r\n      // Find the minimum distance to an edge.\r\n      let pd = Math.min(pt, pr, pb, pl);\r\n\r\n      // Return a root zone if the mouse is within an edge.\r\n      switch (pd) {\r\n        case pt:\r\n          if (pt < edges.top) {\r\n            return { zone: 'root-top', target: null };\r\n          }\r\n          break;\r\n        case pr:\r\n          if (pr < edges.right) {\r\n            return { zone: 'root-right', target: null };\r\n          }\r\n          break;\r\n        case pb:\r\n          if (pb < edges.bottom) {\r\n            return { zone: 'root-bottom', target: null };\r\n          }\r\n          break;\r\n        case pl:\r\n          if (pl < edges.left) {\r\n            return { zone: 'root-left', target: null };\r\n          }\r\n          break;\r\n        default:\r\n          throw 'unreachable';\r\n      }\r\n    }\r\n\r\n    // Hit test the dock layout at the given client position.\r\n    let target = layout.hitTestTabAreas(clientX, clientY);\r\n\r\n    // Bail if no target area was found.\r\n    if (!target) {\r\n      return { zone: 'invalid', target: null };\r\n    }\r\n\r\n    // Return the whole tab area when in single document mode.\r\n    if (panel.mode === 'single-document') {\r\n      return { zone: 'widget-all', target };\r\n    }\r\n\r\n    // Compute the distance to each edge of the tab area.\r\n    let al = target.x - target.left + 1;\r\n    let at = target.y - target.top + 1;\r\n    let ar = target.left + target.width - target.x;\r\n    let ab = target.top + target.height - target.y;\r\n\r\n    const tabHeight = target.tabBar.node.getBoundingClientRect().height;\r\n    if (at < tabHeight) {\r\n      return { zone: 'widget-tab', target };\r\n    }\r\n\r\n    // Get the X and Y edge sizes for the area.\r\n    let rx = Math.round(target.width / 3);\r\n    let ry = Math.round(target.height / 3);\r\n\r\n    // If the mouse is not within an edge, indicate the entire area.\r\n    if (al > rx && ar > rx && at > ry && ab > ry) {\r\n      return { zone: 'widget-all', target };\r\n    }\r\n\r\n    // Scale the distances by the slenderness ratio.\r\n    al /= rx;\r\n    at /= ry;\r\n    ar /= rx;\r\n    ab /= ry;\r\n\r\n    // Find the minimum distance to the area edge.\r\n    let ad = Math.min(al, at, ar, ab);\r\n\r\n    // Find the widget zone for the area edge.\r\n    let zone: DropZone;\r\n    switch (ad) {\r\n    case al:\r\n      zone = 'widget-left';\r\n      break;\r\n    case at:\r\n      zone = 'widget-top';\r\n      break;\r\n    case ar:\r\n      zone = 'widget-right';\r\n      break;\r\n    case ab:\r\n      zone = 'widget-bottom';\r\n      break;\r\n    default:\r\n      throw 'unreachable';\r\n    }\r\n\r\n    // Return the final drop target.\r\n    return { zone, target };\r\n  }\r\n\r\n  /**\r\n   * Get the drop reference widget for a tab bar.\r\n   */\r\n  export\r\n  function getDropRef(tabBar: TabBar<Widget>): Widget | null {\r\n    if (tabBar.titles.length === 0) {\r\n      return null;\r\n    }\r\n    if (tabBar.currentTitle) {\r\n      return tabBar.currentTitle.owner;\r\n    }\r\n    return tabBar.titles[tabBar.titles.length - 1].owner;\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, each, filter, find, max\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  IDisposable\r\n} from '@lumino/disposable';\r\n\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A class which tracks focus among a set of widgets.\r\n *\r\n * This class is useful when code needs to keep track of the most\r\n * recently focused widget(s) among a set of related widgets.\r\n */\r\nexport\r\nclass FocusTracker<T extends Widget> implements IDisposable {\r\n  /**\r\n   * Construct a new focus tracker.\r\n   */\r\n  constructor() { }\r\n\r\n  /**\r\n   * Dispose of the resources held by the tracker.\r\n   */\r\n  dispose(): void {\r\n    // Do nothing if the tracker is already disposed.\r\n    if (this._counter < 0) {\r\n      return;\r\n    }\r\n\r\n    // Mark the tracker as disposed.\r\n    this._counter = -1;\r\n\r\n    // Clear the connections for the tracker.\r\n    Signal.clearData(this);\r\n\r\n    // Remove all event listeners.\r\n    each(this._widgets, w => {\r\n      w.node.removeEventListener('focus', this, true);\r\n      w.node.removeEventListener('blur', this, true);\r\n    });\r\n\r\n    // Clear the internal data structures.\r\n    this._activeWidget = null;\r\n    this._currentWidget = null;\r\n    this._nodes.clear();\r\n    this._numbers.clear();\r\n    this._widgets.length = 0;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the current widget has changed.\r\n   */\r\n  get currentChanged(): ISignal<this, FocusTracker.IChangedArgs<T>> {\r\n    return this._currentChanged;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the active widget has changed.\r\n   */\r\n  get activeChanged(): ISignal<this, FocusTracker.IChangedArgs<T>> {\r\n    return this._activeChanged;\r\n  }\r\n\r\n  /**\r\n   * A flag indicating whether the tracker is disposed.\r\n   */\r\n  get isDisposed(): boolean {\r\n    return this._counter < 0;\r\n  }\r\n\r\n  /**\r\n   * The current widget in the tracker.\r\n   *\r\n   * #### Notes\r\n   * The current widget is the widget among the tracked widgets which\r\n   * has the *descendant node* which has most recently been focused.\r\n   *\r\n   * The current widget will not be updated if the node loses focus. It\r\n   * will only be updated when a different tracked widget gains focus.\r\n   *\r\n   * If the current widget is removed from the tracker, the previous\r\n   * current widget will be restored.\r\n   *\r\n   * This behavior is intended to follow a user's conceptual model of\r\n   * a semantically \"current\" widget, where the \"last thing of type X\"\r\n   * to be interacted with is the \"current instance of X\", regardless\r\n   * of whether that instance still has focus.\r\n   */\r\n  get currentWidget(): T | null {\r\n    return this._currentWidget;\r\n  }\r\n\r\n  /**\r\n   * The active widget in the tracker.\r\n   *\r\n   * #### Notes\r\n   * The active widget is the widget among the tracked widgets which\r\n   * has the *descendant node* which is currently focused.\r\n   */\r\n  get activeWidget(): T | null {\r\n    return this._activeWidget;\r\n  }\r\n\r\n  /**\r\n   * A read only array of the widgets being tracked.\r\n   */\r\n  get widgets(): ReadonlyArray<T> {\r\n    return this._widgets;\r\n  }\r\n\r\n  /**\r\n   * Get the focus number for a particular widget in the tracker.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The focus number for the given widget, or `-1` if the\r\n   *   widget has not had focus since being added to the tracker, or\r\n   *   is not contained by the tracker.\r\n   *\r\n   * #### Notes\r\n   * The focus number indicates the relative order in which the widgets\r\n   * have gained focus. A widget with a larger number has gained focus\r\n   * more recently than a widget with a smaller number.\r\n   *\r\n   * The `currentWidget` will always have the largest focus number.\r\n   *\r\n   * All widgets start with a focus number of `-1`, which indicates that\r\n   * the widget has not been focused since being added to the tracker.\r\n   */\r\n  focusNumber(widget: T): number {\r\n    let n = this._numbers.get(widget);\r\n    return n === undefined ? -1 : n;\r\n  }\r\n\r\n  /**\r\n   * Test whether the focus tracker contains a given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns `true` if the widget is tracked, `false` otherwise.\r\n   */\r\n  has(widget: T): boolean {\r\n    return this._numbers.has(widget);\r\n  }\r\n\r\n  /**\r\n   * Add a widget to the focus tracker.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * #### Notes\r\n   * A widget will be automatically removed from the tracker if it\r\n   * is disposed after being added.\r\n   *\r\n   * If the widget is already tracked, this is a no-op.\r\n   */\r\n  add(widget: T): void {\r\n    // Do nothing if the widget is already tracked.\r\n    if (this._numbers.has(widget)) {\r\n      return;\r\n    }\r\n\r\n    // Test whether the widget has focus.\r\n    let focused = widget.node.contains(document.activeElement);\r\n\r\n    // Set up the initial focus number.\r\n    let n = focused ? this._counter++ : -1;\r\n\r\n    // Add the widget to the internal data structures.\r\n    this._widgets.push(widget);\r\n    this._numbers.set(widget, n);\r\n    this._nodes.set(widget.node, widget);\r\n\r\n    // Set up the event listeners. The capturing phase must be used\r\n    // since the 'focus' and 'blur' events don't bubble and Firefox\r\n    // doesn't support the 'focusin' or 'focusout' events.\r\n    widget.node.addEventListener('focus', this, true);\r\n    widget.node.addEventListener('blur', this, true);\r\n\r\n    // Connect the disposed signal handler.\r\n    widget.disposed.connect(this._onWidgetDisposed, this);\r\n\r\n    // Set the current and active widgets if needed.\r\n    if (focused) {\r\n      this._setWidgets(widget, widget);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove a widget from the focus tracker.\r\n   *\r\n   * #### Notes\r\n   * If the widget is the `currentWidget`, the previous current widget\r\n   * will become the new `currentWidget`.\r\n   *\r\n   * A widget will be automatically removed from the tracker if it\r\n   * is disposed after being added.\r\n   *\r\n   * If the widget is not tracked, this is a no-op.\r\n   */\r\n  remove(widget: T): void {\r\n    // Bail early if the widget is not tracked.\r\n    if (!this._numbers.has(widget)) {\r\n      return;\r\n    }\r\n\r\n    // Disconnect the disposed signal handler.\r\n    widget.disposed.disconnect(this._onWidgetDisposed, this);\r\n\r\n    // Remove the event listeners.\r\n    widget.node.removeEventListener('focus', this, true);\r\n    widget.node.removeEventListener('blur', this, true);\r\n\r\n    // Remove the widget from the internal data structures.\r\n    ArrayExt.removeFirstOf(this._widgets, widget);\r\n    this._nodes.delete(widget.node);\r\n    this._numbers.delete(widget);\r\n\r\n    // Bail early if the widget is not the current widget.\r\n    if (this._currentWidget !== widget) {\r\n      return;\r\n    }\r\n\r\n    // Filter the widgets for those which have had focus.\r\n    let valid = filter(this._widgets, w => this._numbers.get(w) !== -1);\r\n\r\n    // Get the valid widget with the max focus number.\r\n    let previous = max(valid, (first, second) => {\r\n      let a = this._numbers.get(first)!;\r\n      let b = this._numbers.get(second)!;\r\n      return a - b;\r\n    }) || null;\r\n\r\n    // Set the current and active widgets.\r\n    this._setWidgets(previous, null);\r\n  }\r\n\r\n  /**\r\n   * Handle the DOM events for the focus tracker.\r\n   *\r\n   * @param event - The DOM event sent to the panel.\r\n   *\r\n   * #### Notes\r\n   * This method implements the DOM `EventListener` interface and is\r\n   * called in response to events on the tracked nodes. It should\r\n   * not be called directly by user code.\r\n   */\r\n  handleEvent(event: Event): void {\r\n    switch (event.type) {\r\n    case 'focus':\r\n      this._evtFocus(event as FocusEvent);\r\n      break;\r\n    case 'blur':\r\n      this._evtBlur(event as FocusEvent);\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set the current and active widgets for the tracker.\r\n   */\r\n  private _setWidgets(current: T | null, active: T | null): void {\r\n    // Swap the current widget.\r\n    let oldCurrent = this._currentWidget;\r\n    this._currentWidget = current;\r\n\r\n    // Swap the active widget.\r\n    let oldActive = this._activeWidget;\r\n    this._activeWidget = active;\r\n\r\n    // Emit the `currentChanged` signal if needed.\r\n    if (oldCurrent !== current) {\r\n      this._currentChanged.emit({ oldValue: oldCurrent, newValue: current });\r\n    }\r\n\r\n    // Emit the `activeChanged` signal if needed.\r\n    if (oldActive !== active) {\r\n      this._activeChanged.emit({ oldValue: oldActive, newValue: active });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'focus'` event for a tracked widget.\r\n   */\r\n  private _evtFocus(event: FocusEvent): void {\r\n    // Find the widget which gained focus, which is known to exist.\r\n    let widget = this._nodes.get(event.currentTarget as HTMLElement)!;\r\n\r\n    // Update the focus number if necessary.\r\n    if (widget !== this._currentWidget) {\r\n      this._numbers.set(widget, this._counter++);\r\n    }\r\n\r\n    // Set the current and active widgets.\r\n    this._setWidgets(widget, widget);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'blur'` event for a tracked widget.\r\n   */\r\n  private _evtBlur(event: FocusEvent): void {\r\n    // Find the widget which lost focus, which is known to exist.\r\n    let widget = this._nodes.get(event.currentTarget as HTMLElement)!;\r\n\r\n    // Get the node which being focused after this blur.\r\n    let focusTarget = event.relatedTarget as HTMLElement;\r\n\r\n    // If no other node is being focused, clear the active widget.\r\n    if (!focusTarget) {\r\n      this._setWidgets(this._currentWidget, null);\r\n      return;\r\n    }\r\n\r\n    // Bail if the focus widget is not changing.\r\n    if (widget.node.contains(focusTarget)) {\r\n      return;\r\n    }\r\n\r\n    // If no tracked widget is being focused, clear the active widget.\r\n    if (!find(this._widgets, w => w.node.contains(focusTarget))) {\r\n      this._setWidgets(this._currentWidget, null);\r\n      return;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `disposed` signal for a tracked widget.\r\n   */\r\n  private _onWidgetDisposed(sender: T): void {\r\n    this.remove(sender);\r\n  }\r\n\r\n  private _counter = 0;\r\n  private _widgets: T[] = [];\r\n  private _activeWidget: T | null = null;\r\n  private _currentWidget: T | null = null;\r\n  private _numbers = new Map<T, number>();\r\n  private _nodes = new Map<HTMLElement, T>();\r\n  private _activeChanged = new Signal<this, FocusTracker.IChangedArgs<T>>(this);\r\n  private _currentChanged = new Signal<this, FocusTracker.IChangedArgs<T>>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `FocusTracker` class statics.\r\n */\r\nexport\r\nnamespace FocusTracker {\r\n  /**\r\n   * An arguments object for the changed signals.\r\n   */\r\n  export\r\n  interface IChangedArgs<T extends Widget> {\r\n    /**\r\n     * The old value for the widget.\r\n     */\r\n    oldValue: T | null;\r\n\r\n    /**\r\n     * The new value for the widget.\r\n     */\r\n    newValue: T | null;\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, IIterator, each, map\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  AttachedProperty\r\n} from '@lumino/properties';\r\n\r\nimport {\r\n  BoxEngine, BoxSizer\r\n} from './boxengine';\r\n\r\nimport {\r\n Layout, LayoutItem\r\n} from './layout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A layout which arranges its widgets in a grid.\r\n */\r\nexport\r\nclass GridLayout extends Layout {\r\n  /**\r\n   * Construct a new grid layout.\r\n   *\r\n   * @param options - The options for initializing the layout.\r\n   */\r\n  constructor(options: GridLayout.IOptions = {}) {\r\n    super(options);\r\n    if (options.rowCount !== undefined) {\r\n      Private.reallocSizers(this._rowSizers, options.rowCount);\r\n    }\r\n    if (options.columnCount !== undefined) {\r\n      Private.reallocSizers(this._columnSizers, options.columnCount);\r\n    }\r\n    if (options.rowSpacing !== undefined) {\r\n      this._rowSpacing = Private.clampValue(options.rowSpacing);\r\n    }\r\n    if (options.columnSpacing !== undefined) {\r\n      this._columnSpacing = Private.clampValue(options.columnSpacing);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the layout.\r\n   */\r\n  dispose(): void {\r\n    // Dispose of the widgets and layout items.\r\n    each(this._items, item => {\r\n      let widget = item.widget;\r\n      item.dispose();\r\n      widget.dispose();\r\n    });\r\n\r\n    // Clear the layout state.\r\n    this._box = null;\r\n    this._items.length = 0;\r\n    this._rowStarts.length = 0;\r\n    this._rowSizers.length = 0;\r\n    this._columnStarts.length = 0;\r\n    this._columnSizers.length = 0;\r\n\r\n    // Dispose of the rest of the layout.\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * Get the number of rows in the layout.\r\n   */\r\n  get rowCount(): number {\r\n    return this._rowSizers.length;\r\n  }\r\n\r\n  /**\r\n   * Set the number of rows in the layout.\r\n   *\r\n   * #### Notes\r\n   * The minimum row count is `1`.\r\n   */\r\n  set rowCount(value: number) {\r\n    // Do nothing if the row count does not change.\r\n    if (value === this.rowCount) {\r\n      return;\r\n    }\r\n\r\n    // Reallocate the row sizers.\r\n    Private.reallocSizers(this._rowSizers, value);\r\n\r\n    // Schedule a fit of the parent.\r\n    if (this.parent) {\r\n      this.parent.fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the number of columns in the layout.\r\n   */\r\n  get columnCount(): number {\r\n    return this._columnSizers.length;\r\n  }\r\n\r\n  /**\r\n   * Set the number of columns in the layout.\r\n   *\r\n   * #### Notes\r\n   * The minimum column count is `1`.\r\n   */\r\n  set columnCount(value: number) {\r\n    // Do nothing if the column count does not change.\r\n    if (value === this.columnCount) {\r\n      return;\r\n    }\r\n\r\n    // Reallocate the column sizers.\r\n    Private.reallocSizers(this._columnSizers, value);\r\n\r\n    // Schedule a fit of the parent.\r\n    if (this.parent) {\r\n      this.parent.fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the row spacing for the layout.\r\n   */\r\n  get rowSpacing(): number {\r\n    return this._rowSpacing;\r\n  }\r\n\r\n  /**\r\n   * Set the row spacing for the layout.\r\n   */\r\n  set rowSpacing(value: number) {\r\n    // Clamp the spacing to the allowed range.\r\n    value = Private.clampValue(value);\r\n\r\n    // Bail if the spacing does not change\r\n    if (this._rowSpacing === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal spacing.\r\n    this._rowSpacing = value;\r\n\r\n    // Schedule a fit of the parent.\r\n    if (this.parent) {\r\n      this.parent.fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the column spacing for the layout.\r\n   */\r\n  get columnSpacing(): number {\r\n    return this._columnSpacing;\r\n  }\r\n\r\n  /**\r\n   * Set the col spacing for the layout.\r\n   */\r\n  set columnSpacing(value: number) {\r\n    // Clamp the spacing to the allowed range.\r\n    value = Private.clampValue(value);\r\n\r\n    // Bail if the spacing does not change\r\n    if (this._columnSpacing === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal spacing.\r\n    this._columnSpacing = value;\r\n\r\n    // Schedule a fit of the parent.\r\n    if (this.parent) {\r\n      this.parent.fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the stretch factor for a specific row.\r\n   *\r\n   * @param index - The row index of interest.\r\n   *\r\n   * @returns The stretch factor for the row.\r\n   *\r\n   * #### Notes\r\n   * This returns `-1` if the index is out of range.\r\n   */\r\n  rowStretch(index: number): number {\r\n    let sizer = this._rowSizers[index];\r\n    return sizer ? sizer.stretch : -1;\r\n  }\r\n\r\n  /**\r\n   * Set the stretch factor for a specific row.\r\n   *\r\n   * @param index - The row index of interest.\r\n   *\r\n   * @param value - The stretch factor for the row.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the index is out of range.\r\n   */\r\n  setRowStretch(index: number, value: number): void {\r\n    // Look up the row sizer.\r\n    let sizer = this._rowSizers[index];\r\n\r\n    // Bail if the index is out of range.\r\n    if (!sizer) {\r\n      return;\r\n    }\r\n\r\n    // Clamp the value to the allowed range.\r\n    value = Private.clampValue(value);\r\n\r\n    // Bail if the stretch does not change.\r\n    if (sizer.stretch === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the sizer stretch.\r\n    sizer.stretch = value;\r\n\r\n    // Schedule an update of the parent.\r\n    if (this.parent) {\r\n      this.parent.update();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the stretch factor for a specific column.\r\n   *\r\n   * @param index - The column index of interest.\r\n   *\r\n   * @returns The stretch factor for the column.\r\n   *\r\n   * #### Notes\r\n   * This returns `-1` if the index is out of range.\r\n   */\r\n  columnStretch(index: number): number {\r\n    let sizer = this._columnSizers[index];\r\n    return sizer ? sizer.stretch : -1;\r\n  }\r\n\r\n  /**\r\n   * Set the stretch factor for a specific column.\r\n   *\r\n   * @param index - The column index of interest.\r\n   *\r\n   * @param value - The stretch factor for the column.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the index is out of range.\r\n   */\r\n  setColumnStretch(index: number, value: number): void {\r\n    // Look up the column sizer.\r\n    let sizer = this._columnSizers[index];\r\n\r\n    // Bail if the index is out of range.\r\n    if (!sizer) {\r\n      return;\r\n    }\r\n\r\n    // Clamp the value to the allowed range.\r\n    value = Private.clampValue(value);\r\n\r\n    // Bail if the stretch does not change.\r\n    if (sizer.stretch === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the sizer stretch.\r\n    sizer.stretch = value;\r\n\r\n    // Schedule an update of the parent.\r\n    if (this.parent) {\r\n      this.parent.update();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the widgets in the layout.\r\n   *\r\n   * @returns A new iterator over the widgets in the layout.\r\n   */\r\n  iter(): IIterator<Widget> {\r\n    return map(this._items, item => item.widget);\r\n  }\r\n\r\n  /**\r\n   * Add a widget to the grid layout.\r\n   *\r\n   * @param widget - The widget to add to the layout.\r\n   *\r\n   * #### Notes\r\n   * If the widget is already contained in the layout, this is no-op.\r\n   */\r\n  addWidget(widget: Widget): void {\r\n    // Look up the index for the widget.\r\n    let i = ArrayExt.findFirstIndex(this._items, it => it.widget === widget);\r\n\r\n    // Bail if the widget is already in the layout.\r\n    if (i !== -1) {\r\n      return;\r\n    }\r\n\r\n    // Add the widget to the layout.\r\n    this._items.push(new LayoutItem(widget));\r\n\r\n    // Attach the widget to the parent.\r\n    if (this.parent) {\r\n      this.attachWidget(widget);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove a widget from the grid layout.\r\n   *\r\n   * @param widget - The widget to remove from the layout.\r\n   *\r\n   * #### Notes\r\n   * A widget is automatically removed from the layout when its `parent`\r\n   * is set to `null`. This method should only be invoked directly when\r\n   * removing a widget from a layout which has yet to be installed on a\r\n   * parent widget.\r\n   *\r\n   * This method does *not* modify the widget's `parent`.\r\n   */\r\n  removeWidget(widget: Widget): void {\r\n    // Look up the index for the widget.\r\n    let i = ArrayExt.findFirstIndex(this._items, it => it.widget === widget);\r\n\r\n    // Bail if the widget is not in the layout.\r\n    if (i === -1) {\r\n      return;\r\n    }\r\n\r\n    // Remove the widget from the layout.\r\n    let item = ArrayExt.removeAt(this._items, i)!;\r\n\r\n    // Detach the widget from the parent.\r\n    if (this.parent) {\r\n      this.detachWidget(widget);\r\n    }\r\n\r\n    // Dispose the layout item.\r\n    item.dispose();\r\n  }\r\n\r\n  /**\r\n   * Perform layout initialization which requires the parent widget.\r\n   */\r\n  protected init(): void {\r\n    super.init();\r\n    each(this, widget => { this.attachWidget(widget); });\r\n  }\r\n\r\n  /**\r\n   * Attach a widget to the parent's DOM node.\r\n   *\r\n   * @param widget - The widget to attach to the parent.\r\n   */\r\n  protected attachWidget(widget: Widget): void {\r\n    // Send a `'before-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    }\r\n\r\n    // Add the widget's node to the parent.\r\n    this.parent!.node.appendChild(widget.node);\r\n\r\n    // Send an `'after-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n    }\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * Detach a widget from the parent's DOM node.\r\n   *\r\n   * @param widget - The widget to detach from the parent.\r\n   */\r\n  protected detachWidget(widget: Widget): void {\r\n    // Send a `'before-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    }\r\n\r\n    // Remove the widget's node from the parent.\r\n    this.parent!.node.removeChild(widget.node);\r\n\r\n    // Send an `'after-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n    }\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-show'` message.\r\n   */\r\n  protected onBeforeShow(msg: Message): void {\r\n    super.onBeforeShow(msg);\r\n    this.parent!.update();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    super.onBeforeAttach(msg);\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-shown'` message.\r\n   */\r\n  protected onChildShown(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-hidden'` message.\r\n   */\r\n  protected onChildHidden(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'resize'` message.\r\n   */\r\n  protected onResize(msg: Widget.ResizeMessage): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(msg.width, msg.height);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(-1, -1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'fit-request'` message.\r\n   */\r\n  protected onFitRequest(msg: Message): void {\r\n    if (this.parent!.isAttached) {\r\n      this._fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fit the layout to the total size required by the widgets.\r\n   */\r\n  private _fit(): void {\r\n    // Reset the min sizes of the sizers.\r\n    for (let i = 0, n = this.rowCount; i < n; ++i) {\r\n      this._rowSizers[i].minSize = 0;\r\n    }\r\n    for (let i = 0, n = this.columnCount; i < n; ++i) {\r\n      this._columnSizers[i].minSize = 0;\r\n    }\r\n\r\n    // Filter for the visible layout items.\r\n    let items = this._items.filter(it => !it.isHidden);\r\n\r\n    // Fit the layout items.\r\n    for (let i = 0, n = items.length; i < n; ++i) {\r\n      items[i].fit();\r\n    }\r\n\r\n    // Get the max row and column index.\r\n    let maxRow = this.rowCount - 1;\r\n    let maxCol = this.columnCount - 1;\r\n\r\n    // Sort the items by row span.\r\n    items.sort(Private.rowSpanCmp);\r\n\r\n    // Update the min sizes of the row sizers.\r\n    for (let i = 0, n = items.length; i < n; ++i) {\r\n      // Fetch the item.\r\n      let item = items[i];\r\n\r\n      // Get the row bounds for the item.\r\n      let config = GridLayout.getCellConfig(item.widget);\r\n      let r1 = Math.min(config.row, maxRow);\r\n      let r2 = Math.min(config.row + config.rowSpan - 1, maxRow);\r\n\r\n      // Distribute the minimum height to the sizers as needed.\r\n      Private.distributeMin(this._rowSizers, r1, r2, item.minHeight);\r\n    }\r\n\r\n    // Sort the items by column span.\r\n    items.sort(Private.columnSpanCmp);\r\n\r\n    // Update the min sizes of the column sizers.\r\n    for (let i = 0, n = items.length; i < n; ++i) {\r\n      // Fetch the item.\r\n      let item = items[i];\r\n\r\n      // Get the column bounds for the item.\r\n      let config = GridLayout.getCellConfig(item.widget);\r\n      let c1 = Math.min(config.column, maxCol);\r\n      let c2 = Math.min(config.column + config.columnSpan - 1, maxCol);\r\n\r\n      // Distribute the minimum width to the sizers as needed.\r\n      Private.distributeMin(this._columnSizers, c1, c2, item.minWidth);\r\n    }\r\n\r\n    // If no size constraint is needed, just update the parent.\r\n    if (this.fitPolicy === 'set-no-constraint') {\r\n      MessageLoop.sendMessage(this.parent!, Widget.Msg.UpdateRequest);\r\n      return;\r\n    }\r\n\r\n    // Set up the computed min size.\r\n    let minH = maxRow * this._rowSpacing;\r\n    let minW = maxCol * this._columnSpacing;\r\n\r\n    // Add the sizer minimums to the computed min size.\r\n    for (let i = 0, n = this.rowCount; i < n; ++i) {\r\n      minH += this._rowSizers[i].minSize;\r\n    }\r\n    for (let i = 0, n = this.columnCount; i < n; ++i) {\r\n      minW += this._columnSizers[i].minSize;\r\n    }\r\n\r\n    // Update the box sizing and add it to the computed min size.\r\n    let box = this._box = ElementExt.boxSizing(this.parent!.node);\r\n    minW += box.horizontalSum;\r\n    minH += box.verticalSum;\r\n\r\n    // Update the parent's min size constraints.\r\n    let style = this.parent!.node.style;\r\n    style.minWidth = `${minW}px`;\r\n    style.minHeight = `${minH}px`;\r\n\r\n    // Set the dirty flag to ensure only a single update occurs.\r\n    this._dirty = true;\r\n\r\n    // Notify the ancestor that it should fit immediately. This may\r\n    // cause a resize of the parent, fulfilling the required update.\r\n    if (this.parent!.parent) {\r\n      MessageLoop.sendMessage(this.parent!.parent!, Widget.Msg.FitRequest);\r\n    }\r\n\r\n    // If the dirty flag is still set, the parent was not resized.\r\n    // Trigger the required update on the parent widget immediately.\r\n    if (this._dirty) {\r\n      MessageLoop.sendMessage(this.parent!, Widget.Msg.UpdateRequest);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the layout position and size of the widgets.\r\n   *\r\n   * The parent offset dimensions should be `-1` if unknown.\r\n   */\r\n  private _update(offsetWidth: number, offsetHeight: number): void {\r\n    // Clear the dirty flag to indicate the update occurred.\r\n    this._dirty = false;\r\n\r\n    // Measure the parent if the offset dimensions are unknown.\r\n    if (offsetWidth < 0) {\r\n      offsetWidth = this.parent!.node.offsetWidth;\r\n    }\r\n    if (offsetHeight < 0) {\r\n      offsetHeight = this.parent!.node.offsetHeight;\r\n    }\r\n\r\n    // Ensure the parent box sizing data is computed.\r\n    if (!this._box) {\r\n      this._box = ElementExt.boxSizing(this.parent!.node);\r\n    }\r\n\r\n    // Compute the layout area adjusted for border and padding.\r\n    let top = this._box.paddingTop;\r\n    let left = this._box.paddingLeft;\r\n    let width = offsetWidth - this._box.horizontalSum;\r\n    let height = offsetHeight - this._box.verticalSum;\r\n\r\n    // Get the max row and column index.\r\n    let maxRow = this.rowCount - 1;\r\n    let maxCol = this.columnCount - 1;\r\n\r\n    // Compute the total fixed row and column space.\r\n    let fixedRowSpace = maxRow * this._rowSpacing;\r\n    let fixedColSpace = maxCol * this._columnSpacing;\r\n\r\n    // Distribute the available space to the box sizers.\r\n    BoxEngine.calc(this._rowSizers, Math.max(0, height - fixedRowSpace));\r\n    BoxEngine.calc(this._columnSizers, Math.max(0, width - fixedColSpace));\r\n\r\n    // Update the row start positions.\r\n    for (let i = 0, pos = top, n = this.rowCount; i < n; ++i) {\r\n      this._rowStarts[i] = pos;\r\n      pos += this._rowSizers[i].size + this._rowSpacing;\r\n    }\r\n\r\n    // Update the column start positions.\r\n    for (let i = 0, pos = left, n = this.columnCount; i < n; ++i) {\r\n      this._columnStarts[i] = pos;\r\n      pos += this._columnSizers[i].size + this._columnSpacing;\r\n    }\r\n\r\n    // Update the geometry of the layout items.\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      // Fetch the item.\r\n      let item = this._items[i];\r\n\r\n      // Ignore hidden items.\r\n      if (item.isHidden) {\r\n        continue;\r\n      }\r\n\r\n      // Fetch the cell bounds for the widget.\r\n      let config = GridLayout.getCellConfig(item.widget);\r\n      let r1 = Math.min(config.row, maxRow);\r\n      let c1 = Math.min(config.column, maxCol);\r\n      let r2 = Math.min(config.row + config.rowSpan - 1, maxRow);\r\n      let c2 = Math.min(config.column + config.columnSpan - 1, maxCol);\r\n\r\n      // Compute the cell geometry.\r\n      let x = this._columnStarts[c1];\r\n      let y = this._rowStarts[r1];\r\n      let w = this._columnStarts[c2] + this._columnSizers[c2].size - x;\r\n      let h = this._rowStarts[r2] + this._rowSizers[r2].size - y;\r\n\r\n      // Update the geometry of the layout item.\r\n      item.update(x, y, w, h);\r\n    }\r\n  }\r\n\r\n  private _dirty = false;\r\n  private _rowSpacing = 4;\r\n  private _columnSpacing = 4;\r\n  private _items: LayoutItem[] = [];\r\n  private _rowStarts: number[] = [];\r\n  private _columnStarts: number[] = [];\r\n  private _rowSizers: BoxSizer[] = [new BoxSizer()];\r\n  private _columnSizers: BoxSizer[] = [new BoxSizer()];\r\n  private _box: ElementExt.IBoxSizing | null = null;\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `GridLayout` class statics.\r\n */\r\nexport\r\nnamespace GridLayout {\r\n  /**\r\n   * An options object for initializing a grid layout.\r\n   */\r\n  export\r\n  interface IOptions extends Layout.IOptions {\r\n    /**\r\n     * The initial row count for the layout.\r\n     *\r\n     * The default is `1`.\r\n     */\r\n    rowCount?: number;\r\n\r\n    /**\r\n     * The initial column count for the layout.\r\n     *\r\n     * The default is `1`.\r\n     */\r\n    columnCount?: number;\r\n\r\n    /**\r\n     * The spacing between rows in the layout.\r\n     *\r\n     * The default is `4`.\r\n     */\r\n    rowSpacing?: number;\r\n\r\n    /**\r\n     * The spacing between columns in the layout.\r\n     *\r\n     * The default is `4`.\r\n     */\r\n    columnSpacing?: number;\r\n  }\r\n\r\n  /**\r\n   * An object which holds the cell configuration for a widget.\r\n   */\r\n  export\r\n  interface ICellConfig {\r\n    /**\r\n     * The row index for the widget.\r\n     */\r\n    readonly row: number;\r\n\r\n    /**\r\n     * The column index for the widget.\r\n     */\r\n    readonly column: number;\r\n\r\n    /**\r\n     * The row span for the widget.\r\n     */\r\n    readonly rowSpan: number;\r\n\r\n    /**\r\n     * The column span for the widget.\r\n     */\r\n    readonly columnSpan: number;\r\n  }\r\n\r\n  /**\r\n   * Get the cell config for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The cell config for the widget.\r\n   */\r\n  export\r\n  function getCellConfig(widget: Widget): ICellConfig {\r\n    return Private.cellConfigProperty.get(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the cell config for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the cell config.\r\n   */\r\n  export\r\n  function setCellConfig(widget: Widget, value: Partial<ICellConfig>): void {\r\n    Private.cellConfigProperty.set(widget, Private.normalizeConfig(value));\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * The property descriptor for the widget cell config.\r\n   */\r\n  export\r\n  const cellConfigProperty = new AttachedProperty<Widget, GridLayout.ICellConfig>({\r\n    name: 'cellConfig',\r\n    create: () => ({ row: 0, column: 0, rowSpan: 1, columnSpan: 1 }),\r\n    changed: onChildCellConfigChanged\r\n  });\r\n\r\n  /**\r\n   * Normalize a partial cell config object.\r\n   */\r\n  export\r\n  function normalizeConfig(config: Partial<GridLayout.ICellConfig>): GridLayout.ICellConfig {\r\n    let row = Math.max(0, Math.floor(config.row || 0));\r\n    let column = Math.max(0, Math.floor(config.column || 0));\r\n    let rowSpan = Math.max(1, Math.floor(config.rowSpan || 0));\r\n    let columnSpan = Math.max(1, Math.floor(config.columnSpan || 0));\r\n    return { row, column, rowSpan, columnSpan };\r\n  }\r\n\r\n  /**\r\n   * Clamp a value to an integer >= 0.\r\n   */\r\n  export\r\n  function clampValue(value: number): number {\r\n    return Math.max(0, Math.floor(value));\r\n  }\r\n\r\n  /**\r\n   * A sort comparison function for row spans.\r\n   */\r\n  export\r\n  function rowSpanCmp(a: LayoutItem, b: LayoutItem): number {\r\n    let c1 = cellConfigProperty.get(a.widget);\r\n    let c2 = cellConfigProperty.get(b.widget);\r\n    return c1.rowSpan - c2.rowSpan;\r\n  }\r\n\r\n  /**\r\n   * A sort comparison function for column spans.\r\n   */\r\n  export\r\n  function columnSpanCmp(a: LayoutItem, b: LayoutItem): number {\r\n    let c1 = cellConfigProperty.get(a.widget);\r\n    let c2 = cellConfigProperty.get(b.widget);\r\n    return c1.columnSpan - c2.columnSpan;\r\n  }\r\n\r\n  /**\r\n   * Reallocate the box sizers for the given grid dimensions.\r\n   */\r\n  export\r\n  function reallocSizers(sizers: BoxSizer[], count: number): void {\r\n    // Coerce the count to the valid range.\r\n    count = Math.max(1, Math.floor(count));\r\n\r\n    // Add the missing sizers.\r\n    while (sizers.length < count) {\r\n      sizers.push(new BoxSizer());\r\n    }\r\n\r\n    // Remove the extra sizers.\r\n    if (sizers.length > count) {\r\n      sizers.length = count;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Distribute a min size constraint across a range of sizers.\r\n   */\r\n  export\r\n  function distributeMin(sizers: BoxSizer[], i1: number, i2: number, minSize: number): void {\r\n    // Sanity check the indices.\r\n    if (i2 < i1) {\r\n      return;\r\n    }\r\n\r\n    // Handle the simple case of no cell span.\r\n    if (i1 === i2) {\r\n      let sizer = sizers[i1];\r\n      sizer.minSize = Math.max(sizer.minSize, minSize);\r\n      return;\r\n    }\r\n\r\n    // Compute the total current min size of the span.\r\n    let totalMin = 0;\r\n    for (let i = i1; i <= i2; ++i) {\r\n      totalMin += sizers[i].minSize;\r\n    }\r\n\r\n    // Do nothing if the total is greater than the required.\r\n    if (totalMin >= minSize) {\r\n      return;\r\n    }\r\n\r\n    // Compute the portion of the space to allocate to each sizer.\r\n    let portion = (minSize - totalMin) / (i2 - i1 + 1);\r\n\r\n    // Add the portion to each sizer.\r\n    for (let i = i1; i <= i2; ++i) {\r\n      sizers[i].minSize += portion;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The change handler for the child cell config property.\r\n   */\r\n  function onChildCellConfigChanged(child: Widget): void {\r\n    if (child.parent && child.parent.layout instanceof GridLayout) {\r\n      child.parent.fit();\r\n    }\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  getKeyboardLayout\r\n} from '@lumino/keyboard';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  ElementARIAAttrs, ElementDataset, VirtualDOM, VirtualElement, h\r\n} from '@lumino/virtualdom';\r\n\r\nimport {\r\n  Menu\r\n} from './menu';\r\n\r\nimport {\r\n  Title\r\n} from './title';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A widget which displays menus as a canonical menu bar.\r\n */\r\nexport\r\nclass MenuBar extends Widget {\r\n  /**\r\n   * Construct a new menu bar.\r\n   *\r\n   * @param options - The options for initializing the menu bar.\r\n   */\r\n  constructor(options: MenuBar.IOptions = {}) {\r\n    super({ node: Private.createNode() });\r\n    this.addClass('lm-MenuBar');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-MenuBar');\r\n    /* </DEPRECATED> */\r\n    this.setFlag(Widget.Flag.DisallowLayout);\r\n    this.renderer = options.renderer || MenuBar.defaultRenderer;\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the widget.\r\n   */\r\n  dispose(): void {\r\n    this._closeChildMenu();\r\n    this._menus.length = 0;\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * The renderer used by the menu bar.\r\n   */\r\n  readonly renderer: MenuBar.IRenderer;\r\n\r\n  /**\r\n   * The child menu of the menu bar.\r\n   *\r\n   * #### Notes\r\n   * This will be `null` if the menu bar does not have an open menu.\r\n   */\r\n  get childMenu(): Menu | null {\r\n    return this._childMenu;\r\n  }\r\n\r\n  /**\r\n   * Get the menu bar content node.\r\n   *\r\n   * #### Notes\r\n   * This is the node which holds the menu title nodes.\r\n   *\r\n   * Modifying this node directly can lead to undefined behavior.\r\n   */\r\n  get contentNode(): HTMLUListElement {\r\n    return this.node.getElementsByClassName('lm-MenuBar-content')[0] as HTMLUListElement;\r\n  }\r\n\r\n  /**\r\n   * Get the currently active menu.\r\n   */\r\n  get activeMenu(): Menu | null {\r\n    return this._menus[this._activeIndex] || null;\r\n  }\r\n\r\n  /**\r\n   * Set the currently active menu.\r\n   *\r\n   * #### Notes\r\n   * If the menu does not exist, the menu will be set to `null`.\r\n   */\r\n  set activeMenu(value: Menu | null) {\r\n    this.activeIndex = value ? this._menus.indexOf(value) : -1;\r\n  }\r\n\r\n  /**\r\n   * Get the index of the currently active menu.\r\n   *\r\n   * #### Notes\r\n   * This will be `-1` if no menu is active.\r\n   */\r\n  get activeIndex(): number {\r\n    return this._activeIndex;\r\n  }\r\n\r\n  /**\r\n   * Set the index of the currently active menu.\r\n   *\r\n   * #### Notes\r\n   * If the menu cannot be activated, the index will be set to `-1`.\r\n   */\r\n  set activeIndex(value: number) {\r\n    // Adjust the value for an out of range index.\r\n    if (value < 0 || value >= this._menus.length) {\r\n      value = -1;\r\n    }\r\n\r\n    // Bail early if the index will not change.\r\n    if (this._activeIndex === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the active index.\r\n    this._activeIndex = value;\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * A read-only array of the menus in the menu bar.\r\n   */\r\n  get menus(): ReadonlyArray<Menu> {\r\n    return this._menus;\r\n  }\r\n\r\n  /**\r\n   * Open the active menu and activate its first menu item.\r\n   *\r\n   * #### Notes\r\n   * If there is no active menu, this is a no-op.\r\n   */\r\n  openActiveMenu(): void {\r\n    // Bail early if there is no active item.\r\n    if (this._activeIndex === -1) {\r\n      return;\r\n    }\r\n\r\n    // Open the child menu.\r\n    this._openChildMenu();\r\n\r\n    // Activate the first item in the child menu.\r\n    if (this._childMenu) {\r\n      this._childMenu.activeIndex = -1;\r\n      this._childMenu.activateNextItem();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a menu to the end of the menu bar.\r\n   *\r\n   * @param menu - The menu to add to the menu bar.\r\n   *\r\n   * #### Notes\r\n   * If the menu is already added to the menu bar, it will be moved.\r\n   */\r\n  addMenu(menu: Menu): void {\r\n    this.insertMenu(this._menus.length, menu);\r\n  }\r\n\r\n  /**\r\n   * Insert a menu into the menu bar at the specified index.\r\n   *\r\n   * @param index - The index at which to insert the menu.\r\n   *\r\n   * @param menu - The menu to insert into the menu bar.\r\n   *\r\n   * #### Notes\r\n   * The index will be clamped to the bounds of the menus.\r\n   *\r\n   * If the menu is already added to the menu bar, it will be moved.\r\n   */\r\n  insertMenu(index: number, menu: Menu): void {\r\n    // Close the child menu before making changes.\r\n    this._closeChildMenu();\r\n\r\n    // Look up the index of the menu.\r\n    let i = this._menus.indexOf(menu);\r\n\r\n    // Clamp the insert index to the array bounds.\r\n    let j = Math.max(0, Math.min(index, this._menus.length));\r\n\r\n    // If the menu is not in the array, insert it.\r\n    if (i === -1) {\r\n      // Insert the menu into the array.\r\n      ArrayExt.insert(this._menus, j, menu);\r\n\r\n      // Add the styling class to the menu.\r\n      menu.addClass('lm-MenuBar-menu');\r\n      /* <DEPRECATED> */\r\n      menu.addClass('p-MenuBar-menu');\r\n      /* </DEPRECATED> */\r\n\r\n      // Connect to the menu signals.\r\n      menu.aboutToClose.connect(this._onMenuAboutToClose, this);\r\n      menu.menuRequested.connect(this._onMenuMenuRequested, this);\r\n      menu.title.changed.connect(this._onTitleChanged, this);\r\n\r\n      // Schedule an update of the items.\r\n      this.update();\r\n\r\n      // There is nothing more to do.\r\n      return;\r\n    }\r\n\r\n    // Otherwise, the menu exists in the array and should be moved.\r\n\r\n    // Adjust the index if the location is at the end of the array.\r\n    if (j === this._menus.length) {\r\n      j--;\r\n    }\r\n\r\n    // Bail if there is no effective move.\r\n    if (i === j) {\r\n      return;\r\n    }\r\n\r\n    // Move the menu to the new locations.\r\n    ArrayExt.move(this._menus, i, j);\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Remove a menu from the menu bar.\r\n   *\r\n   * @param menu - The menu to remove from the menu bar.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the menu is not in the menu bar.\r\n   */\r\n  removeMenu(menu: Menu): void {\r\n    this.removeMenuAt(this._menus.indexOf(menu));\r\n  }\r\n\r\n  /**\r\n   * Remove the menu at a given index from the menu bar.\r\n   *\r\n   * @param index - The index of the menu to remove.\r\n   *\r\n   * #### Notes\r\n   * This is a no-op if the index is out of range.\r\n   */\r\n  removeMenuAt(index: number): void {\r\n    // Close the child menu before making changes.\r\n    this._closeChildMenu();\r\n\r\n    // Remove the menu from the array.\r\n    let menu = ArrayExt.removeAt(this._menus, index);\r\n\r\n    // Bail if the index is out of range.\r\n    if (!menu) {\r\n      return;\r\n    }\r\n\r\n    // Disconnect from the menu signals.\r\n    menu.aboutToClose.disconnect(this._onMenuAboutToClose, this);\r\n    menu.menuRequested.disconnect(this._onMenuMenuRequested, this);\r\n    menu.title.changed.disconnect(this._onTitleChanged, this);\r\n\r\n    // Remove the styling class from the menu.\r\n    menu.removeClass('lm-MenuBar-menu');\r\n    /* <DEPRECATED> */\r\n    menu.removeClass('p-MenuBar-menu');\r\n    /* </DEPRECATED> */\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Remove all menus from the menu bar.\r\n   */\r\n  clearMenus(): void {\r\n    // Bail if there is nothing to remove.\r\n    if (this._menus.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Close the child menu before making changes.\r\n    this._closeChildMenu();\r\n\r\n    // Disconnect from the menu signals and remove the styling class.\r\n    for (let menu of this._menus) {\r\n      menu.aboutToClose.disconnect(this._onMenuAboutToClose, this);\r\n      menu.menuRequested.disconnect(this._onMenuMenuRequested, this);\r\n      menu.title.changed.disconnect(this._onTitleChanged, this);\r\n      menu.removeClass('lm-MenuBar-menu');\r\n      /* <DEPRECATED> */\r\n      menu.removeClass('p-MenuBar-menu');\r\n      /* </DEPRECATED> */\r\n    }\r\n\r\n    // Clear the menus array.\r\n    this._menus.length = 0;\r\n\r\n    // Schedule an update of the items.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Handle the DOM events for the menu bar.\r\n   *\r\n   * @param event - The DOM event sent to the menu bar.\r\n   *\r\n   * #### Notes\r\n   * This method implements the DOM `EventListener` interface and is\r\n   * called in response to events on the menu bar's DOM nodes. It\r\n   * should not be called directly by user code.\r\n   */\r\n  handleEvent(event: Event): void {\r\n    switch (event.type) {\r\n    case 'keydown':\r\n      this._evtKeyDown(event as KeyboardEvent);\r\n      break;\r\n    case 'mousedown':\r\n      this._evtMouseDown(event as MouseEvent);\r\n      break;\r\n    case 'mousemove':\r\n      this._evtMouseMove(event as MouseEvent);\r\n      break;\r\n    case 'mouseleave':\r\n      this._evtMouseLeave(event as MouseEvent);\r\n      break;\r\n    case 'contextmenu':\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    this.node.addEventListener('keydown', this);\r\n    this.node.addEventListener('mousedown', this);\r\n    this.node.addEventListener('mousemove', this);\r\n    this.node.addEventListener('mouseleave', this);\r\n    this.node.addEventListener('contextmenu', this);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-detach'` message.\r\n   */\r\n  protected onAfterDetach(msg: Message): void {\r\n    this.node.removeEventListener('keydown', this);\r\n    this.node.removeEventListener('mousedown', this);\r\n    this.node.removeEventListener('mousemove', this);\r\n    this.node.removeEventListener('mouseleave', this);\r\n    this.node.removeEventListener('contextmenu', this);\r\n    this._closeChildMenu();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'activate-request'` message.\r\n   */\r\n  protected onActivateRequest(msg: Message): void {\r\n    if (this.isAttached) {\r\n      this.node.focus();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    let menus = this._menus;\r\n    let renderer = this.renderer;\r\n    let activeIndex = this._activeIndex;\r\n    let content = new Array<VirtualElement>(menus.length);\r\n    for (let i = 0, n = menus.length; i < n; ++i) {\r\n      let title = menus[i].title;\r\n      let active = i === activeIndex;\r\n      content[i] = renderer.renderItem({ title, active });\r\n    }\r\n    VirtualDOM.render(content, this.contentNode);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'keydown'` event for the menu bar.\r\n   */\r\n  private _evtKeyDown(event: KeyboardEvent): void {\r\n    // A menu bar handles all keydown events.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Fetch the key code for the event.\r\n    let kc = event.keyCode;\r\n\r\n    // Enter, Up Arrow, Down Arrow\r\n    if (kc === 13 || kc === 38 || kc === 40) {\r\n      this.openActiveMenu();\r\n      return;\r\n    }\r\n\r\n    // Escape\r\n    if (kc === 27) {\r\n      this._closeChildMenu();\r\n      this.activeIndex = -1;\r\n      this.node.blur();\r\n      return;\r\n    }\r\n\r\n    // Left Arrow\r\n    if (kc === 37) {\r\n      let i = this._activeIndex;\r\n      let n = this._menus.length;\r\n      this.activeIndex = i === 0 ? n - 1 : i - 1;\r\n      return;\r\n    }\r\n\r\n    // Right Arrow\r\n    if (kc === 39) {\r\n      let i = this._activeIndex;\r\n      let n = this._menus.length;\r\n      this.activeIndex = i === n - 1 ? 0 : i + 1;\r\n      return;\r\n    }\r\n\r\n    // Get the pressed key character.\r\n    let key = getKeyboardLayout().keyForKeydownEvent(event);\r\n\r\n    // Bail if the key is not valid.\r\n    if (!key) {\r\n      return;\r\n    }\r\n\r\n    // Search for the next best matching mnemonic item.\r\n    let start = this._activeIndex + 1;\r\n    let result = Private.findMnemonic(this._menus, key, start);\r\n\r\n    // Handle the requested mnemonic based on the search results.\r\n    // If exactly one mnemonic is matched, that menu is opened.\r\n    // Otherwise, the next mnemonic is activated if available,\r\n    // followed by the auto mnemonic if available.\r\n    if (result.index !== -1 && !result.multiple) {\r\n      this.activeIndex = result.index;\r\n      this.openActiveMenu();\r\n    } else if (result.index !== -1) {\r\n      this.activeIndex = result.index;\r\n    } else if (result.auto !== -1) {\r\n      this.activeIndex = result.auto;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousedown'` event for the menu bar.\r\n   */\r\n  private _evtMouseDown(event: MouseEvent): void {\r\n    // Bail if the mouse press was not on the menu bar. This can occur\r\n    // when the document listener is installed for an active menu bar.\r\n    if (!ElementExt.hitTest(this.node, event.clientX, event.clientY)) {\r\n      return;\r\n    }\r\n\r\n    // Stop the propagation of the event. Immediate propagation is\r\n    // also stopped so that an open menu does not handle the event.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    event.stopImmediatePropagation();\r\n\r\n    // Check if the mouse is over one of the menu items.\r\n    let index = ArrayExt.findFirstIndex(this.contentNode.children, node => {\r\n      return ElementExt.hitTest(node, event.clientX, event.clientY);\r\n    });\r\n\r\n    // If the press was not on an item, close the child menu.\r\n    if (index === -1) {\r\n      this._closeChildMenu();\r\n      return;\r\n    }\r\n\r\n    // If the press was not the left mouse button, do nothing further.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Otherwise, toggle the open state of the child menu.\r\n    if (this._childMenu) {\r\n      this._closeChildMenu();\r\n      this.activeIndex = index;\r\n    } else {\r\n      this.activeIndex = index;\r\n      this._openChildMenu();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousemove'` event for the menu bar.\r\n   */\r\n  private _evtMouseMove(event: MouseEvent): void {\r\n    // Check if the mouse is over one of the menu items.\r\n    let index = ArrayExt.findFirstIndex(this.contentNode.children, node => {\r\n      return ElementExt.hitTest(node, event.clientX, event.clientY);\r\n    });\r\n\r\n    // Bail early if the active index will not change.\r\n    if (index === this._activeIndex) {\r\n      return;\r\n    }\r\n\r\n    // Bail early if a child menu is open and the mouse is not over\r\n    // an item. This allows the child menu to be kept open when the\r\n    // mouse is over the empty part of the menu bar.\r\n    if (index === -1 && this._childMenu) {\r\n      return;\r\n    }\r\n\r\n    // Update the active index to the hovered item.\r\n    this.activeIndex = index;\r\n\r\n    // Open the new menu if a menu is already open.\r\n    if (this._childMenu) {\r\n      this._openChildMenu();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mouseleave'` event for the menu bar.\r\n   */\r\n  private _evtMouseLeave(event: MouseEvent): void {\r\n    // Reset the active index if there is no open menu.\r\n    if (!this._childMenu) {\r\n      this.activeIndex = -1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Open the child menu at the active index immediately.\r\n   *\r\n   * If a different child menu is already open, it will be closed,\r\n   * even if there is no active menu.\r\n   */\r\n  private _openChildMenu(): void {\r\n    // If there is no active menu, close the current menu.\r\n    let newMenu = this.activeMenu;\r\n    if (!newMenu) {\r\n      this._closeChildMenu();\r\n      return;\r\n    }\r\n\r\n    // Bail if there is no effective menu change.\r\n    let oldMenu = this._childMenu;\r\n    if (oldMenu === newMenu) {\r\n      return;\r\n    }\r\n\r\n    // Swap the internal menu reference.\r\n    this._childMenu = newMenu;\r\n\r\n    // Close the current menu, or setup for the new menu.\r\n    if (oldMenu) {\r\n      oldMenu.close();\r\n    } else {\r\n      this.addClass('lm-mod-active');\r\n      /* <DEPRECATED> */\r\n      this.addClass('p-mod-active');\r\n      /* </DEPRECATED> */\r\n      document.addEventListener('mousedown', this, true);\r\n    }\r\n\r\n    // Ensure the menu bar is updated and look up the item node.\r\n    MessageLoop.sendMessage(this, Widget.Msg.UpdateRequest);\r\n    let itemNode = this.contentNode.children[this._activeIndex];\r\n\r\n    // Get the positioning data for the new menu.\r\n    let { left, bottom } = (itemNode as HTMLElement).getBoundingClientRect();\r\n\r\n    // Open the new menu at the computed location.\r\n    newMenu.open(left, bottom, { forceX: true, forceY: true });\r\n  }\r\n\r\n  /**\r\n   * Close the child menu immediately.\r\n   *\r\n   * This is a no-op if a child menu is not open.\r\n   */\r\n  private _closeChildMenu(): void {\r\n    // Bail if no child menu is open.\r\n    if (!this._childMenu) {\r\n      return;\r\n    }\r\n\r\n    // Remove the active class from the menu bar.\r\n    this.removeClass('lm-mod-active');\r\n    /* <DEPRECATED> */\r\n    this.removeClass('p-mod-active');\r\n    /* </DEPRECATED> */\r\n\r\n    // Remove the document listeners.\r\n    document.removeEventListener('mousedown', this, true);\r\n\r\n    // Clear the internal menu reference.\r\n    let menu = this._childMenu;\r\n    this._childMenu = null;\r\n\r\n    // Close the menu.\r\n    menu.close();\r\n\r\n    // Reset the active index.\r\n    this.activeIndex = -1;\r\n  }\r\n\r\n  /**\r\n   * Handle the `aboutToClose` signal of a menu.\r\n   */\r\n  private _onMenuAboutToClose(sender: Menu): void {\r\n    // Bail if the sender is not the child menu.\r\n    if (sender !== this._childMenu) {\r\n      return;\r\n    }\r\n\r\n    // Remove the active class from the menu bar.\r\n    this.removeClass('lm-mod-active');\r\n    /* <DEPRECATED> */\r\n    this.removeClass('p-mod-active');\r\n    /* </DEPRECATED> */\r\n\r\n    // Remove the document listeners.\r\n    document.removeEventListener('mousedown', this, true);\r\n\r\n    // Clear the internal menu reference.\r\n    this._childMenu = null;\r\n\r\n    // Reset the active index.\r\n    this.activeIndex = -1;\r\n  }\r\n\r\n  /**\r\n   * Handle the `menuRequested` signal of a child menu.\r\n   */\r\n  private _onMenuMenuRequested(sender: Menu, args: 'next' | 'previous'): void {\r\n    // Bail if the sender is not the child menu.\r\n    if (sender !== this._childMenu) {\r\n      return;\r\n    }\r\n\r\n    // Look up the active index and menu count.\r\n    let i = this._activeIndex;\r\n    let n = this._menus.length;\r\n\r\n    // Active the next requested index.\r\n    switch (args) {\r\n    case 'next':\r\n      this.activeIndex = i === n - 1 ? 0 : i + 1;\r\n      break;\r\n    case 'previous':\r\n      this.activeIndex = i === 0 ? n - 1 : i - 1;\r\n      break;\r\n    }\r\n\r\n    // Open the active menu.\r\n    this.openActiveMenu();\r\n  }\r\n\r\n  /**\r\n   * Handle the `changed` signal of a title object.\r\n   */\r\n  private _onTitleChanged(): void {\r\n    this.update();\r\n  }\r\n\r\n  private _activeIndex = -1;\r\n  private _menus: Menu[] = [];\r\n  private _childMenu: Menu | null = null;\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `MenuBar` class statics.\r\n */\r\nexport\r\nnamespace MenuBar {\r\n  /**\r\n   * An options object for creating a menu bar.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * A custom renderer for creating menu bar content.\r\n     *\r\n     * The default is a shared renderer instance.\r\n     */\r\n    renderer?: IRenderer;\r\n  }\r\n\r\n  /**\r\n   * An object which holds the data to render a menu bar item.\r\n   */\r\n  export\r\n  interface IRenderData {\r\n    /**\r\n     * The title to be rendered.\r\n     */\r\n    readonly title: Title<Widget>;\r\n\r\n    /**\r\n     * Whether the item is the active item.\r\n     */\r\n    readonly active: boolean;\r\n  }\r\n\r\n  /**\r\n   * A renderer for use with a menu bar.\r\n   */\r\n  export\r\n  interface IRenderer {\r\n    /**\r\n     * Render the virtual element for a menu bar item.\r\n     *\r\n     * @param data - The data to use for rendering the item.\r\n     *\r\n     * @returns A virtual element representing the item.\r\n     */\r\n    renderItem(data: IRenderData): VirtualElement;\r\n  }\r\n\r\n  /**\r\n   * The default implementation of `IRenderer`.\r\n   *\r\n   * #### Notes\r\n   * Subclasses are free to reimplement rendering methods as needed.\r\n   */\r\n  export\r\n  class Renderer implements IRenderer {\r\n    /**\r\n     * Construct a new renderer.\r\n     */\r\n    constructor() { }\r\n\r\n    /**\r\n     * Render the virtual element for a menu bar item.\r\n     *\r\n     * @param data - The data to use for rendering the item.\r\n     *\r\n     * @returns A virtual element representing the item.\r\n     */\r\n    renderItem(data: IRenderData): VirtualElement {\r\n      let className = this.createItemClass(data);\r\n      let dataset = this.createItemDataset(data);\r\n      let aria = this.createItemARIA(data);\r\n      return (\r\n        h.li({ className, dataset, ...aria },\r\n          this.renderIcon(data),\r\n          this.renderLabel(data)\r\n        )\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Render the icon element for a menu bar item.\r\n     *\r\n     * @param data - The data to use for rendering the icon.\r\n     *\r\n     * @returns A virtual element representing the item icon.\r\n     */\r\n    renderIcon(data: IRenderData): VirtualElement {\r\n      let className = this.createIconClass(data);\r\n\r\n      /* <DEPRECATED> */\r\n      if (typeof data.title.icon === 'string') {\r\n        return h.div({className}, data.title.iconLabel);\r\n      }\r\n      /* </DEPRECATED> */\r\n\r\n      // if data.title.icon is undefined, it will be ignored\r\n      return h.div({className}, data.title.icon!, data.title.iconLabel);\r\n    }\r\n\r\n    /**\r\n     * Render the label element for a menu item.\r\n     *\r\n     * @param data - The data to use for rendering the label.\r\n     *\r\n     * @returns A virtual element representing the item label.\r\n     */\r\n    renderLabel(data: IRenderData): VirtualElement {\r\n      let content = this.formatLabel(data);\r\n      return h.div({ className:\r\n        'lm-MenuBar-itemLabel'\r\n          /* <DEPRECATED> */\r\n            + ' p-MenuBar-itemLabel'\r\n          /* </DEPRECATED> */\r\n      }, content);\r\n    }\r\n\r\n    /**\r\n     * Create the class name for the menu bar item.\r\n     *\r\n     * @param data - The data to use for the class name.\r\n     *\r\n     * @returns The full class name for the menu item.\r\n     */\r\n    createItemClass(data: IRenderData): string {\r\n      let name = 'lm-MenuBar-item';\r\n      /* <DEPRECATED> */\r\n      name += ' p-MenuBar-item';\r\n      /* </DEPRECATED> */\r\n      if (data.title.className) {\r\n        name += ` ${data.title.className}`;\r\n      }\r\n      if (data.active) {\r\n        name += ' lm-mod-active';\r\n      /* <DEPRECATED> */\r\n      name += ' p-mod-active';\r\n      /* </DEPRECATED> */\r\n      }\r\n      return name;\r\n    }\r\n\r\n    /**\r\n     * Create the dataset for a menu bar item.\r\n     *\r\n     * @param data - The data to use for the item.\r\n     *\r\n     * @returns The dataset for the menu bar item.\r\n     */\r\n    createItemDataset(data: IRenderData): ElementDataset {\r\n      return data.title.dataset;\r\n    }\r\n\r\n    /**\r\n     * Create the aria attributes for menu bar item.\r\n     * \r\n     * @param data - The data to use for the aria attributes.\r\n     * \r\n     * @returns The aria attributes object for the item.\r\n     */\r\n    createItemARIA(data: IRenderData): ElementARIAAttrs {\r\n      return {role: 'menuitem', 'aria-haspopup': 'true'};\r\n    }\r\n\r\n    /**\r\n     * Create the class name for the menu bar item icon.\r\n     *\r\n     * @param data - The data to use for the class name.\r\n     *\r\n     * @returns The full class name for the item icon.\r\n     */\r\n    createIconClass(data: IRenderData): string {\r\n      let name = 'lm-MenuBar-itemIcon';\r\n      /* <DEPRECATED> */\r\n      name += ' p-MenuBar-itemIcon';\r\n      /* </DEPRECATED> */\r\n      let extra = data.title.iconClass;\r\n      return extra ? `${name} ${extra}` : name;\r\n    }\r\n\r\n    /**\r\n     * Create the render content for the label node.\r\n     *\r\n     * @param data - The data to use for the label content.\r\n     *\r\n     * @returns The content to add to the label node.\r\n     */\r\n    formatLabel(data: IRenderData): h.Child {\r\n      // Fetch the label text and mnemonic index.\r\n      let { label, mnemonic } = data.title;\r\n\r\n      // If the index is out of range, do not modify the label.\r\n      if (mnemonic < 0 || mnemonic >= label.length) {\r\n        return label;\r\n      }\r\n\r\n      // Split the label into parts.\r\n      let prefix = label.slice(0, mnemonic);\r\n      let suffix = label.slice(mnemonic + 1);\r\n      let char = label[mnemonic];\r\n\r\n      // Wrap the mnemonic character in a span.\r\n      let span = h.span({\r\n        className: 'lm-MenuBar-itemMnemonic'\r\n          /* <DEPRECATED> */\r\n          + ' p-MenuBar-itemMnemonic'\r\n          /* </DEPRECATED> */\r\n      }, char);\r\n\r\n      // Return the content parts.\r\n      return [prefix, span, suffix];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The default `Renderer` instance.\r\n   */\r\n  export\r\n  const defaultRenderer = new Renderer();\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * Create the DOM node for a menu bar.\r\n   */\r\n  export\r\n  function createNode(): HTMLDivElement {\r\n    let node = document.createElement('div');\r\n    let content = document.createElement('ul');\r\n    content.className = 'lm-MenuBar-content';\r\n    /* <DEPRECATED> */\r\n    content.classList.add('p-MenuBar-content');\r\n    /* </DEPRECATED> */\r\n    node.appendChild(content);\r\n    content.setAttribute('role', 'menubar');\r\n    node.tabIndex = -1;\r\n    return node;\r\n  }\r\n\r\n  /**\r\n   * The results of a mnemonic search.\r\n   */\r\n  export\r\n  interface IMnemonicResult {\r\n    /**\r\n     * The index of the first matching mnemonic item, or `-1`.\r\n     */\r\n    index: number;\r\n\r\n    /**\r\n     * Whether multiple mnemonic items matched.\r\n     */\r\n    multiple: boolean;\r\n\r\n    /**\r\n     * The index of the first auto matched non-mnemonic item.\r\n     */\r\n    auto: number;\r\n  }\r\n\r\n  /**\r\n   * Find the best matching mnemonic item.\r\n   *\r\n   * The search starts at the given index and wraps around.\r\n   */\r\n  export\r\n  function findMnemonic(menus: ReadonlyArray<Menu>, key: string, start: number): IMnemonicResult {\r\n    // Setup the result variables.\r\n    let index = -1;\r\n    let auto = -1;\r\n    let multiple = false;\r\n\r\n    // Normalize the key to upper case.\r\n    let upperKey = key.toUpperCase();\r\n\r\n    // Search the items from the given start index.\r\n    for (let i = 0, n = menus.length; i < n; ++i) {\r\n      // Compute the wrapped index.\r\n      let k = (i + start) % n;\r\n\r\n      // Look up the menu title.\r\n      let title = menus[k].title;\r\n\r\n      // Ignore titles with an empty label.\r\n      if (title.label.length === 0) {\r\n        continue;\r\n      }\r\n\r\n      // Look up the mnemonic index for the label.\r\n      let mn = title.mnemonic;\r\n\r\n      // Handle a valid mnemonic index.\r\n      if (mn >= 0 && mn < title.label.length) {\r\n        if (title.label[mn].toUpperCase() === upperKey) {\r\n          if (index === -1) {\r\n            index = k;\r\n          } else {\r\n            multiple = true;\r\n          }\r\n        }\r\n        continue;\r\n      }\r\n\r\n      // Finally, handle the auto index if possible.\r\n      if (auto === -1 && title.label[0].toUpperCase() === upperKey) {\r\n        auto = k;\r\n      }\r\n    }\r\n\r\n    // Return the search results.\r\n    return { index, multiple, auto };\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  IDisposable\r\n} from '@lumino/disposable';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Drag\r\n} from '@lumino/dragdrop';\r\n\r\nimport {\r\n  Message\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A widget which implements a canonical scroll bar.\r\n */\r\nexport\r\nclass ScrollBar extends Widget {\r\n  /**\r\n   * Construct a new scroll bar.\r\n   *\r\n   * @param options - The options for initializing the scroll bar.\r\n   */\r\n  constructor(options: ScrollBar.IOptions = {}) {\r\n    super({ node: Private.createNode() });\r\n    this.addClass('lm-ScrollBar');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-ScrollBar');\r\n    /* </DEPRECATED> */\r\n    this.setFlag(Widget.Flag.DisallowLayout);\r\n\r\n    // Set the orientation.\r\n    this._orientation = options.orientation || 'vertical';\r\n    this.dataset['orientation'] = this._orientation;\r\n\r\n    // Parse the rest of the options.\r\n    if (options.maximum !== undefined) {\r\n      this._maximum = Math.max(0, options.maximum);\r\n    }\r\n    if (options.page !== undefined) {\r\n      this._page = Math.max(0, options.page);\r\n    }\r\n    if (options.value !== undefined) {\r\n      this._value = Math.max(0, Math.min(options.value, this._maximum));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the user moves the scroll thumb.\r\n   *\r\n   * #### Notes\r\n   * The payload is the current value of the scroll bar.\r\n   */\r\n  get thumbMoved(): ISignal<this, number> {\r\n    return this._thumbMoved;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the user clicks a step button.\r\n   *\r\n   * #### Notes\r\n   * The payload is whether a decrease or increase is requested.\r\n   */\r\n  get stepRequested(): ISignal<this, 'decrement' | 'increment'> {\r\n    return this._stepRequested;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the user clicks the scroll track.\r\n   *\r\n   * #### Notes\r\n   * The payload is whether a decrease or increase is requested.\r\n   */\r\n  get pageRequested(): ISignal<this, 'decrement' | 'increment'> {\r\n    return this._pageRequested;\r\n  }\r\n\r\n  /**\r\n   * Get the orientation of the scroll bar.\r\n   */\r\n  get orientation(): ScrollBar.Orientation {\r\n    return this._orientation;\r\n  }\r\n\r\n  /**\r\n   * Set the orientation of the scroll bar.\r\n   */\r\n  set orientation(value: ScrollBar.Orientation) {\r\n    // Do nothing if the orientation does not change.\r\n    if (this._orientation === value) {\r\n      return;\r\n    }\r\n\r\n    // Release the mouse before making changes.\r\n    this._releaseMouse();\r\n\r\n    // Update the internal orientation.\r\n    this._orientation = value;\r\n    this.dataset['orientation'] = value;\r\n\r\n    // Schedule an update the scroll bar.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Get the current value of the scroll bar.\r\n   */\r\n  get value(): number {\r\n    return this._value;\r\n  }\r\n\r\n  /**\r\n   * Set the current value of the scroll bar.\r\n   *\r\n   * #### Notes\r\n   * The value will be clamped to the range `[0, maximum]`.\r\n   */\r\n  set value(value: number) {\r\n    // Clamp the value to the allowable range.\r\n    value = Math.max(0, Math.min(value, this._maximum));\r\n\r\n    // Do nothing if the value does not change.\r\n    if (this._value === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal value.\r\n    this._value = value;\r\n\r\n    // Schedule an update the scroll bar.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Get the page size of the scroll bar.\r\n   *\r\n   * #### Notes\r\n   * The page size is the amount of visible content in the scrolled\r\n   * region, expressed in data units. It determines the size of the\r\n   * scroll bar thumb.\r\n   */\r\n  get page(): number {\r\n    return this._page;\r\n  }\r\n\r\n  /**\r\n   * Set the page size of the scroll bar.\r\n   *\r\n   * #### Notes\r\n   * The page size will be clamped to the range `[0, Infinity]`.\r\n   */\r\n  set page(value: number) {\r\n    // Clamp the page size to the allowable range.\r\n    value = Math.max(0, value);\r\n\r\n    // Do nothing if the value does not change.\r\n    if (this._page === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal page size.\r\n    this._page = value;\r\n\r\n    // Schedule an update the scroll bar.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Get the maximum value of the scroll bar.\r\n   */\r\n  get maximum(): number {\r\n    return this._maximum;\r\n  }\r\n\r\n  /**\r\n   * Set the maximum value of the scroll bar.\r\n   *\r\n   * #### Notes\r\n   * The max size will be clamped to the range `[0, Infinity]`.\r\n   */\r\n  set maximum(value: number) {\r\n    // Clamp the value to the allowable range.\r\n    value = Math.max(0, value);\r\n\r\n    // Do nothing if the value does not change.\r\n    if (this._maximum === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal values.\r\n    this._maximum = value;\r\n\r\n    // Clamp the current value to the new range.\r\n    this._value = Math.min(this._value, value);\r\n\r\n    // Schedule an update the scroll bar.\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * The scroll bar decrement button node.\r\n   *\r\n   * #### Notes\r\n   * Modifying this node directly can lead to undefined behavior.\r\n   */\r\n  get decrementNode(): HTMLDivElement {\r\n    return this.node.getElementsByClassName('lm-ScrollBar-button')[0] as HTMLDivElement;\r\n  }\r\n\r\n  /**\r\n   * The scroll bar increment button node.\r\n   *\r\n   * #### Notes\r\n   * Modifying this node directly can lead to undefined behavior.\r\n   */\r\n  get incrementNode(): HTMLDivElement {\r\n    return this.node.getElementsByClassName('lm-ScrollBar-button')[1] as HTMLDivElement;\r\n  }\r\n\r\n  /**\r\n   * The scroll bar track node.\r\n   *\r\n   * #### Notes\r\n   * Modifying this node directly can lead to undefined behavior.\r\n   */\r\n  get trackNode(): HTMLDivElement {\r\n    return this.node.getElementsByClassName('lm-ScrollBar-track')[0] as HTMLDivElement;\r\n  }\r\n\r\n  /**\r\n   * The scroll bar thumb node.\r\n   *\r\n   * #### Notes\r\n   * Modifying this node directly can lead to undefined behavior.\r\n   */\r\n  get thumbNode(): HTMLDivElement {\r\n    return this.node.getElementsByClassName('lm-ScrollBar-thumb')[0] as HTMLDivElement;\r\n  }\r\n\r\n  /**\r\n   * Handle the DOM events for the scroll bar.\r\n   *\r\n   * @param event - The DOM event sent to the scroll bar.\r\n   *\r\n   * #### Notes\r\n   * This method implements the DOM `EventListener` interface and is\r\n   * called in response to events on the scroll bar's DOM node.\r\n   *\r\n   * This should not be called directly by user code.\r\n   */\r\n  handleEvent(event: Event): void {\r\n    switch (event.type) {\r\n    case 'mousedown':\r\n      this._evtMouseDown(event as MouseEvent);\r\n      break;\r\n    case 'mousemove':\r\n      this._evtMouseMove(event as MouseEvent);\r\n      break;\r\n    case 'mouseup':\r\n      this._evtMouseUp(event as MouseEvent);\r\n      break;\r\n    case 'keydown':\r\n      this._evtKeyDown(event as KeyboardEvent);\r\n      break;\r\n    case 'contextmenu':\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A method invoked on a 'before-attach' message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    this.node.addEventListener('mousedown', this);\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * A method invoked on an 'after-detach' message.\r\n   */\r\n  protected onAfterDetach(msg: Message): void {\r\n    this.node.removeEventListener('mousedown', this);\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * A method invoked on an 'update-request' message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    // Convert the value and page into percentages.\r\n    let value = this._value * 100 / this._maximum;\r\n    let page = this._page * 100 / (this._page + this._maximum);\r\n\r\n    // Clamp the value and page to the relevant range.\r\n    value = Math.max(0, Math.min(value, 100));\r\n    page = Math.max(0, Math.min(page, 100));\r\n\r\n    // Fetch the thumb style.\r\n    let thumbStyle = this.thumbNode.style;\r\n\r\n    // Update the thumb style for the current orientation.\r\n    if (this._orientation === 'horizontal') {\r\n      thumbStyle.top = '';\r\n      thumbStyle.height = '';\r\n      thumbStyle.left = `${value}%`;\r\n      thumbStyle.width = `${page}%`;\r\n      thumbStyle.transform = `translate(${-value}%, 0%)`;\r\n    } else {\r\n      thumbStyle.left = '';\r\n      thumbStyle.width = '';\r\n      thumbStyle.top = `${value}%`;\r\n      thumbStyle.height = `${page}%`;\r\n      thumbStyle.transform = `translate(0%, ${-value}%)`;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'keydown'` event for the scroll bar.\r\n   */\r\n  private _evtKeyDown(event: KeyboardEvent): void {\r\n    // Stop all input events during drag.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Ignore anything except the `Escape` key.\r\n    if (event.keyCode !== 27) {\r\n      return;\r\n    }\r\n\r\n    // Fetch the previous scroll value.\r\n    let value = this._pressData ? this._pressData.value : -1;\r\n\r\n    // Release the mouse.\r\n    this._releaseMouse();\r\n\r\n    // Restore the old scroll value if possible.\r\n    if (value !== -1) {\r\n      this._moveThumb(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousedown'` event for the scroll bar.\r\n   */\r\n  private _evtMouseDown(event: MouseEvent): void {\r\n    // Do nothing if it's not a left mouse press.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Send an activate request to the scroll bar. This can be\r\n    // used by message hooks to activate something relevant.\r\n    this.activate();\r\n\r\n    // Do nothing if the mouse is already captured.\r\n    if (this._pressData) {\r\n      return;\r\n    }\r\n\r\n    // Find the pressed scroll bar part.\r\n    let part = Private.findPart(this, event.target as HTMLElement);\r\n\r\n    // Do nothing if the part is not of interest.\r\n    if (!part) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event propagation.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Override the mouse cursor.\r\n    let override = Drag.overrideCursor('default');\r\n\r\n    // Set up the press data.\r\n    this._pressData = {\r\n      part, override,\r\n      delta: -1, value: -1,\r\n      mouseX: event.clientX,\r\n      mouseY: event.clientY\r\n    };\r\n\r\n    // Add the extra event listeners.\r\n    document.addEventListener('mousemove', this, true);\r\n    document.addEventListener('mouseup', this, true);\r\n    document.addEventListener('keydown', this, true);\r\n    document.addEventListener('contextmenu', this, true);\r\n\r\n    // Handle a thumb press.\r\n    if (part === 'thumb') {\r\n      // Fetch the thumb node.\r\n      let thumbNode = this.thumbNode;\r\n\r\n      // Fetch the client rect for the thumb.\r\n      let thumbRect = thumbNode.getBoundingClientRect();\r\n\r\n      // Update the press data delta for the current orientation.\r\n      if (this._orientation === 'horizontal') {\r\n        this._pressData.delta = event.clientX - thumbRect.left;\r\n      } else {\r\n        this._pressData.delta = event.clientY - thumbRect.top;\r\n      }\r\n\r\n      // Add the active class to the thumb node.\r\n      thumbNode.classList.add('lm-mod-active');\r\n      /* <DEPRECATED> */\r\n      thumbNode.classList.add('p-mod-active');\r\n      /* </DEPRECATED> */\r\n\r\n      // Store the current value in the press data.\r\n      this._pressData.value = this._value;\r\n\r\n      // Finished.\r\n      return;\r\n    }\r\n\r\n    // Handle a track press.\r\n    if (part === 'track') {\r\n      // Fetch the client rect for the thumb.\r\n      let thumbRect = this.thumbNode.getBoundingClientRect();\r\n\r\n      // Determine the direction for the page request.\r\n      let dir: 'decrement' | 'increment';\r\n      if (this._orientation === 'horizontal') {\r\n        dir = event.clientX < thumbRect.left ? 'decrement' : 'increment';\r\n      } else {\r\n        dir = event.clientY < thumbRect.top ? 'decrement' : 'increment';\r\n      }\r\n\r\n      // Start the repeat timer.\r\n      this._repeatTimer = window.setTimeout(this._onRepeat, 350);\r\n\r\n      // Emit the page requested signal.\r\n      this._pageRequested.emit(dir);\r\n\r\n      // Finished.\r\n      return;\r\n    }\r\n\r\n    // Handle a decrement button press.\r\n    if (part === 'decrement') {\r\n      // Add the active class to the decrement node.\r\n      this.decrementNode.classList.add('lm-mod-active');\r\n      /* <DEPRECATED> */\r\n      this.decrementNode.classList.add('p-mod-active');\r\n      /* </DEPRECATED> */\r\n\r\n      // Start the repeat timer.\r\n      this._repeatTimer = window.setTimeout(this._onRepeat, 350);\r\n\r\n      // Emit the step requested signal.\r\n      this._stepRequested.emit('decrement');\r\n\r\n      // Finished.\r\n      return;\r\n    }\r\n\r\n    // Handle an increment button press.\r\n    if (part === 'increment') {\r\n\r\n      // Add the active class to the increment node.\r\n      this.incrementNode.classList.add('lm-mod-active');\r\n      /* <DEPRECATED> */\r\n      this.incrementNode.classList.add('p-mod-active');\r\n      /* </DEPRECATED> */\r\n\r\n      // Start the repeat timer.\r\n      this._repeatTimer = window.setTimeout(this._onRepeat, 350);\r\n\r\n      // Emit the step requested signal.\r\n      this._stepRequested.emit('increment');\r\n\r\n      // Finished.\r\n      return;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousemove'` event for the scroll bar.\r\n   */\r\n  private _evtMouseMove(event: MouseEvent): void {\r\n    // Do nothing if no drag is in progress.\r\n    if (!this._pressData) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event propagation.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Update the mouse position.\r\n    this._pressData.mouseX = event.clientX;\r\n    this._pressData.mouseY = event.clientY;\r\n\r\n    // Bail if the thumb is not being dragged.\r\n    if (this._pressData.part !== 'thumb') {\r\n      return;\r\n    }\r\n\r\n    // Get the client rect for the thumb and track.\r\n    let thumbRect = this.thumbNode.getBoundingClientRect();\r\n    let trackRect = this.trackNode.getBoundingClientRect();\r\n\r\n    // Fetch the scroll geometry based on the orientation.\r\n    let trackPos: number;\r\n    let trackSpan: number;\r\n    if (this._orientation === 'horizontal') {\r\n      trackPos = event.clientX - trackRect.left - this._pressData.delta;\r\n      trackSpan = trackRect.width - thumbRect.width;\r\n    } else {\r\n      trackPos = event.clientY - trackRect.top - this._pressData.delta;\r\n      trackSpan = trackRect.height - thumbRect.height;\r\n    }\r\n\r\n    // Compute the desired value from the scroll geometry.\r\n    let value = trackSpan === 0 ? 0 : trackPos * this._maximum / trackSpan;\r\n\r\n    // Move the thumb to the computed value.\r\n    this._moveThumb(value);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mouseup'` event for the scroll bar.\r\n   */\r\n  private _evtMouseUp(event: MouseEvent): void {\r\n    // Do nothing if it's not a left mouse release.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event propagation.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Release the mouse.\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * Release the mouse and restore the node states.\r\n   */\r\n  private _releaseMouse(): void {\r\n    // Bail if there is no press data.\r\n    if (!this._pressData) {\r\n      return;\r\n    }\r\n\r\n    // Clear the repeat timer.\r\n    clearTimeout(this._repeatTimer);\r\n    this._repeatTimer = -1;\r\n\r\n    // Clear the press data.\r\n    this._pressData.override.dispose();\r\n    this._pressData = null;\r\n\r\n    // Remove the extra event listeners.\r\n    document.removeEventListener('mousemove', this, true);\r\n    document.removeEventListener('mouseup', this, true);\r\n    document.removeEventListener('keydown', this, true);\r\n    document.removeEventListener('contextmenu', this, true);\r\n\r\n    // Remove the active classes from the nodes.\r\n    this.thumbNode.classList.remove('lm-mod-active');\r\n    this.decrementNode.classList.remove('lm-mod-active');\r\n    this.incrementNode.classList.remove('lm-mod-active');\r\n    /* <DEPRECATED> */\r\n    this.thumbNode.classList.remove('p-mod-active');\r\n    this.decrementNode.classList.remove('p-mod-active');\r\n    this.incrementNode.classList.remove('p-mod-active');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * Move the thumb to the specified position.\r\n   */\r\n  private _moveThumb(value: number): void {\r\n    // Clamp the value to the allowed range.\r\n    value = Math.max(0, Math.min(value, this._maximum));\r\n\r\n    // Bail if the value does not change.\r\n    if (this._value === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal value.\r\n    this._value = value;\r\n\r\n    // Schedule an update of the scroll bar.\r\n    this.update();\r\n\r\n    // Emit the thumb moved signal.\r\n    this._thumbMoved.emit(value);\r\n  }\r\n\r\n  /**\r\n   * A timeout callback for repeating the mouse press.\r\n   */\r\n  private _onRepeat = () => {\r\n    // Clear the repeat timer id.\r\n    this._repeatTimer = -1;\r\n\r\n    // Bail if the mouse has been released.\r\n    if (!this._pressData) {\r\n      return;\r\n    }\r\n\r\n    // Look up the part that was pressed.\r\n    let part = this._pressData.part;\r\n\r\n    // Bail if the thumb was pressed.\r\n    if (part === 'thumb') {\r\n      return;\r\n    }\r\n\r\n    // Schedule the timer for another repeat.\r\n    this._repeatTimer = window.setTimeout(this._onRepeat, 20);\r\n\r\n    // Get the current mouse position.\r\n    let mouseX = this._pressData.mouseX;\r\n    let mouseY = this._pressData.mouseY;\r\n\r\n    // Handle a decrement button repeat.\r\n    if (part === 'decrement') {\r\n      // Bail if the mouse is not over the button.\r\n      if (!ElementExt.hitTest(this.decrementNode, mouseX, mouseY)) {\r\n        return;\r\n      }\r\n\r\n      // Emit the step requested signal.\r\n      this._stepRequested.emit('decrement');\r\n\r\n      // Finished.\r\n      return;\r\n    }\r\n\r\n    // Handle an increment button repeat.\r\n    if (part === 'increment') {\r\n      // Bail if the mouse is not over the button.\r\n      if (!ElementExt.hitTest(this.incrementNode, mouseX, mouseY)) {\r\n        return;\r\n      }\r\n\r\n      // Emit the step requested signal.\r\n      this._stepRequested.emit('increment');\r\n\r\n      // Finished.\r\n      return;\r\n    }\r\n\r\n    // Handle a track repeat.\r\n    if (part === 'track') {\r\n      // Bail if the mouse is not over the track.\r\n      if (!ElementExt.hitTest(this.trackNode, mouseX, mouseY)) {\r\n        return;\r\n      }\r\n\r\n      // Fetch the thumb node.\r\n      let thumbNode = this.thumbNode;\r\n\r\n      // Bail if the mouse is over the thumb.\r\n      if (ElementExt.hitTest(thumbNode, mouseX, mouseY)) {\r\n        return;\r\n      }\r\n\r\n      // Fetch the client rect for the thumb.\r\n      let thumbRect = thumbNode.getBoundingClientRect();\r\n\r\n      // Determine the direction for the page request.\r\n      let dir: 'decrement' | 'increment';\r\n      if (this._orientation === 'horizontal') {\r\n        dir = mouseX < thumbRect.left ? 'decrement' : 'increment';\r\n      } else {\r\n        dir = mouseY < thumbRect.top ? 'decrement' : 'increment';\r\n      }\r\n\r\n      // Emit the page requested signal.\r\n      this._pageRequested.emit(dir);\r\n\r\n      // Finished.\r\n      return;\r\n    }\r\n  };\r\n\r\n  private _value = 0;\r\n  private _page = 10;\r\n  private _maximum = 100;\r\n  private _repeatTimer = -1;\r\n  private _orientation: ScrollBar.Orientation;\r\n  private _pressData: Private.IPressData | null = null;\r\n  private _thumbMoved = new Signal<this, number>(this);\r\n  private _stepRequested = new Signal<this, 'decrement' | 'increment'>(this);\r\n  private _pageRequested = new Signal<this, 'decrement' | 'increment'>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `ScrollBar` class statics.\r\n */\r\nexport\r\nnamespace ScrollBar {\r\n  /**\r\n   * A type alias for a scroll bar orientation.\r\n   */\r\n  export\r\n  type Orientation = 'horizontal' | 'vertical';\r\n\r\n  /**\r\n   * An options object for creating a scroll bar.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The orientation of the scroll bar.\r\n     *\r\n     * The default is `'vertical'`.\r\n     */\r\n    orientation?: Orientation;\r\n\r\n    /**\r\n     * The value for the scroll bar.\r\n     *\r\n     * The default is `0`.\r\n     */\r\n    value?: number;\r\n\r\n    /**\r\n     * The page size for the scroll bar.\r\n     *\r\n     * The default is `10`.\r\n     */\r\n    page?: number;\r\n\r\n    /**\r\n     * The maximum value for the scroll bar.\r\n     *\r\n     * The default is `100`.\r\n     */\r\n    maximum?: number;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * A type alias for the parts of a scroll bar.\r\n   */\r\n  export\r\n  type ScrollBarPart = 'thumb' | 'track' | 'decrement' | 'increment';\r\n\r\n  /**\r\n   * An object which holds mouse press data.\r\n   */\r\n  export\r\n  interface IPressData {\r\n    /**\r\n     * The scroll bar part which was pressed.\r\n     */\r\n    part: ScrollBarPart;\r\n\r\n    /**\r\n     * The offset of the press in thumb coordinates, or -1.\r\n     */\r\n    delta: number;\r\n\r\n    /**\r\n     * The scroll value at the time the thumb was pressed, or -1.\r\n     */\r\n    value: number;\r\n\r\n    /**\r\n     * The disposable which will clear the override cursor.\r\n     */\r\n    override: IDisposable;\r\n\r\n    /**\r\n     * The current X position of the mouse.\r\n     */\r\n    mouseX: number;\r\n\r\n    /**\r\n     * The current Y position of the mouse.\r\n     */\r\n    mouseY: number;\r\n  }\r\n\r\n  /**\r\n   * Create the DOM node for a scroll bar.\r\n   */\r\n  export\r\n  function createNode(): HTMLElement {\r\n    let node = document.createElement('div');\r\n    let decrement = document.createElement('div');\r\n    let increment = document.createElement('div');\r\n    let track = document.createElement('div');\r\n    let thumb = document.createElement('div');\r\n    decrement.className = 'lm-ScrollBar-button';\r\n    increment.className = 'lm-ScrollBar-button';\r\n    decrement.dataset['action'] = 'decrement';\r\n    increment.dataset['action'] = 'increment';\r\n    track.className = 'lm-ScrollBar-track';\r\n    thumb.className = 'lm-ScrollBar-thumb';\r\n    /* <DEPRECATED> */\r\n    decrement.classList.add('p-ScrollBar-button');\r\n    increment.classList.add('p-ScrollBar-button');\r\n    track.classList.add('p-ScrollBar-track');\r\n    thumb.classList.add('p-ScrollBar-thumb');\r\n    /* </DEPRECATED> */\r\n    track.appendChild(thumb);\r\n    node.appendChild(decrement);\r\n    node.appendChild(track);\r\n    node.appendChild(increment);\r\n    return node;\r\n  }\r\n\r\n  /**\r\n   * Find the scroll bar part which contains the given target.\r\n   */\r\n  export\r\n  function findPart(scrollBar: ScrollBar, target: HTMLElement): ScrollBarPart | null {\r\n    // Test the thumb.\r\n    if (scrollBar.thumbNode.contains(target)) {\r\n      return 'thumb';\r\n    }\r\n\r\n    // Test the track.\r\n    if (scrollBar.trackNode.contains(target)) {\r\n      return 'track';\r\n    }\r\n\r\n    // Test the decrement button.\r\n    if (scrollBar.decrementNode.contains(target)) {\r\n      return 'decrement';\r\n    }\r\n\r\n    // Test the increment button.\r\n    if (scrollBar.incrementNode.contains(target)) {\r\n      return 'increment';\r\n    }\r\n\r\n    // Indicate no match.\r\n    return null;\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  IIterator, each, empty, once\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  Layout\r\n} from './layout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A concrete layout implementation which holds a single widget.\r\n *\r\n * #### Notes\r\n * This class is useful for creating simple container widgets which\r\n * hold a single child. The child should be positioned with CSS.\r\n */\r\nexport\r\nclass SingletonLayout extends Layout {\r\n  /**\r\n   * Dispose of the resources held by the layout.\r\n   */\r\n  dispose(): void {\r\n    if (this._widget) {\r\n      let widget = this._widget;\r\n      this._widget = null;\r\n      widget.dispose();\r\n    }\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * Get the child widget for the layout.\r\n   */\r\n  get widget(): Widget | null {\r\n    return this._widget;\r\n  }\r\n\r\n  /**\r\n   * Set the child widget for the layout.\r\n   *\r\n   * #### Notes\r\n   * Setting the child widget will cause the old child widget to be\r\n   * automatically disposed. If that is not desired, set the parent\r\n   * of the old child to `null` before assigning a new child.\r\n   */\r\n  set widget(widget: Widget | null) {\r\n    // Remove the widget from its current parent. This is a no-op\r\n    // if the widget's parent is already the layout parent widget.\r\n    if (widget) {\r\n      widget.parent = this.parent;\r\n    }\r\n\r\n    // Bail early if the widget does not change.\r\n    if (this._widget === widget) {\r\n      return;\r\n    }\r\n\r\n    // Dispose of the old child widget.\r\n    if (this._widget) {\r\n      this._widget.dispose();\r\n    }\r\n\r\n    // Update the internal widget.\r\n    this._widget = widget;\r\n\r\n    // Attach the new child widget if needed.\r\n    if (this.parent && widget) {\r\n      this.attachWidget(widget);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create an iterator over the widgets in the layout.\r\n   *\r\n   * @returns A new iterator over the widgets in the layout.\r\n   */\r\n  iter(): IIterator<Widget> {\r\n    return this._widget ? once(this._widget) : empty<Widget>();\r\n  }\r\n\r\n  /**\r\n   * Remove a widget from the layout.\r\n   *\r\n   * @param widget - The widget to remove from the layout.\r\n   *\r\n   * #### Notes\r\n   * A widget is automatically removed from the layout when its `parent`\r\n   * is set to `null`. This method should only be invoked directly when\r\n   * removing a widget from a layout which has yet to be installed on a\r\n   * parent widget.\r\n   *\r\n   * This method does *not* modify the widget's `parent`.\r\n   */\r\n  removeWidget(widget: Widget): void {\r\n    // Bail early if the widget does not exist in the layout.\r\n    if (this._widget !== widget) {\r\n      return;\r\n    }\r\n\r\n    // Clear the internal widget.\r\n    this._widget = null;\r\n\r\n    // If the layout is parented, detach the widget from the DOM.\r\n    if (this.parent) {\r\n      this.detachWidget(widget);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Perform layout initialization which requires the parent widget.\r\n   */\r\n  protected init(): void {\r\n    super.init();\r\n    each(this, widget => { this.attachWidget(widget); });\r\n  }\r\n\r\n  /**\r\n   * Attach a widget to the parent's DOM node.\r\n   *\r\n   * @param index - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to attach to the parent.\r\n   *\r\n   * #### Notes\r\n   * This method is called automatically by the single layout at the\r\n   * appropriate time. It should not be called directly by user code.\r\n   *\r\n   * The default implementation adds the widgets's node to the parent's\r\n   * node at the proper location, and sends the appropriate attach\r\n   * messages to the widget if the parent is attached to the DOM.\r\n   *\r\n   * Subclasses may reimplement this method to control how the widget's\r\n   * node is added to the parent's node.\r\n   */\r\n  protected attachWidget(widget: Widget): void {\r\n    // Send a `'before-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    }\r\n\r\n    // Add the widget's node to the parent.\r\n    this.parent!.node.appendChild(widget.node);\r\n\r\n    // Send an `'after-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Detach a widget from the parent's DOM node.\r\n   *\r\n   * @param widget - The widget to detach from the parent.\r\n   *\r\n   * #### Notes\r\n   * This method is called automatically by the single layout at the\r\n   * appropriate time. It should not be called directly by user code.\r\n   *\r\n   * The default implementation removes the widget's node from the\r\n   * parent's node, and sends the appropriate detach messages to the\r\n   * widget if the parent is attached to the DOM.\r\n   *\r\n   * Subclasses may reimplement this method to control how the widget's\r\n   * node is removed from the parent's node.\r\n   */\r\n  protected detachWidget(widget: Widget): void {\r\n    // Send a `'before-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    }\r\n\r\n    // Remove the widget's node from the parent.\r\n    this.parent!.node.removeChild(widget.node);\r\n\r\n    // Send an `'after-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n    }\r\n  }\r\n\r\n  private _widget: Widget | null = null;\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, each\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  AttachedProperty\r\n} from '@lumino/properties';\r\n\r\nimport {\r\n  BoxEngine, BoxSizer\r\n} from './boxengine';\r\n\r\nimport {\r\n  LayoutItem\r\n} from './layout';\r\n\r\nimport {\r\n  PanelLayout\r\n} from './panellayout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A layout which arranges its widgets into resizable sections.\r\n */\r\nexport\r\nclass SplitLayout extends PanelLayout {\r\n  /**\r\n   * Construct a new split layout.\r\n   *\r\n   * @param options - The options for initializing the layout.\r\n   */\r\n  constructor(options: SplitLayout.IOptions) {\r\n    super();\r\n    this.renderer = options.renderer;\r\n    if (options.orientation !== undefined) {\r\n      this._orientation = options.orientation;\r\n    }\r\n    if (options.alignment !== undefined) {\r\n      this._alignment = options.alignment;\r\n    }\r\n    if (options.spacing !== undefined) {\r\n      this._spacing = Private.clampSpacing(options.spacing);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the layout.\r\n   */\r\n  dispose(): void {\r\n    // Dispose of the layout items.\r\n    each(this._items, item => { item.dispose(); });\r\n\r\n    // Clear the layout state.\r\n    this._box = null;\r\n    this._items.length = 0;\r\n    this._sizers.length = 0;\r\n    this._handles.length = 0;\r\n\r\n    // Dispose of the rest of the layout.\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * The renderer used by the split layout.\r\n   */\r\n  readonly renderer: SplitLayout.IRenderer;\r\n\r\n  /**\r\n   * Get the layout orientation for the split layout.\r\n   */\r\n  get orientation(): SplitLayout.Orientation {\r\n    return this._orientation;\r\n  }\r\n\r\n  /**\r\n   * Set the layout orientation for the split layout.\r\n   */\r\n  set orientation(value: SplitLayout.Orientation) {\r\n    if (this._orientation === value) {\r\n      return;\r\n    }\r\n    this._orientation = value;\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n    this.parent.dataset['orientation'] = value;\r\n    this.parent.fit();\r\n  }\r\n\r\n  /**\r\n   * Get the content alignment for the split layout.\r\n   *\r\n   * #### Notes\r\n   * This is the alignment of the widgets in the layout direction.\r\n   *\r\n   * The alignment has no effect if the widgets can expand  to fill the\r\n   * entire split layout.\r\n   */\r\n  get alignment(): SplitLayout.Alignment {\r\n    return this._alignment;\r\n  }\r\n\r\n  /**\r\n   * Set the content alignment for the split layout.\r\n   *\r\n   * #### Notes\r\n   * This is the alignment of the widgets in the layout direction.\r\n   *\r\n   * The alignment has no effect if the widgets can expand  to fill the\r\n   * entire split layout.\r\n   */\r\n  set alignment(value: SplitLayout.Alignment) {\r\n    if (this._alignment === value) {\r\n      return;\r\n    }\r\n    this._alignment = value;\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n    this.parent.dataset['alignment'] = value;\r\n    this.parent.update();\r\n  }\r\n\r\n  /**\r\n   * Get the inter-element spacing for the split layout.\r\n   */\r\n  get spacing(): number {\r\n    return this._spacing;\r\n  }\r\n\r\n  /**\r\n   * Set the inter-element spacing for the split layout.\r\n   */\r\n  set spacing(value: number) {\r\n    value = Private.clampSpacing(value);\r\n    if (this._spacing === value) {\r\n      return;\r\n    }\r\n    this._spacing = value;\r\n    if (!this.parent) {\r\n      return;\r\n    }\r\n    this.parent.fit();\r\n  }\r\n\r\n  /**\r\n   * A read-only array of the split handles in the layout.\r\n   */\r\n  get handles(): ReadonlyArray<HTMLDivElement> {\r\n    return this._handles;\r\n  }\r\n\r\n  /**\r\n   * Get the relative sizes of the widgets in the layout.\r\n   *\r\n   * @returns A new array of the relative sizes of the widgets.\r\n   *\r\n   * #### Notes\r\n   * The returned sizes reflect the sizes of the widgets normalized\r\n   * relative to their siblings.\r\n   *\r\n   * This method **does not** measure the DOM nodes.\r\n   */\r\n  relativeSizes(): number[] {\r\n    return Private.normalize(this._sizers.map(sizer => sizer.size));\r\n  }\r\n\r\n  /**\r\n   * Set the relative sizes for the widgets in the layout.\r\n   *\r\n   * @param sizes - The relative sizes for the widgets in the panel.\r\n   *\r\n   * #### Notes\r\n   * Extra values are ignored, too few will yield an undefined layout.\r\n   *\r\n   * The actual geometry of the DOM nodes is updated asynchronously.\r\n   */\r\n  setRelativeSizes(sizes: number[]): void {\r\n    // Copy the sizes and pad with zeros as needed.\r\n    let n = this._sizers.length;\r\n    let temp = sizes.slice(0, n);\r\n    while (temp.length < n) {\r\n      temp.push(0);\r\n    }\r\n\r\n    // Normalize the padded sizes.\r\n    let normed = Private.normalize(temp);\r\n\r\n    // Apply the normalized sizes to the sizers.\r\n    for (let i = 0; i < n; ++i) {\r\n      let sizer = this._sizers[i];\r\n      sizer.sizeHint = normed[i];\r\n      sizer.size = normed[i];\r\n    }\r\n\r\n    // Set the flag indicating the sizes are normalized.\r\n    this._hasNormedSizes = true;\r\n\r\n    // Trigger an update of the parent widget.\r\n    if (this.parent) {\r\n      this.parent.update();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Move the offset position of a split handle.\r\n   *\r\n   * @param index - The index of the handle of the interest.\r\n   *\r\n   * @param position - The desired offset position of the handle.\r\n   *\r\n   * #### Notes\r\n   * The position is relative to the offset parent.\r\n   *\r\n   * This will move the handle as close as possible to the desired\r\n   * position. The sibling widgets will be adjusted as necessary.\r\n   */\r\n  moveHandle(index: number, position: number): void {\r\n    // Bail if the index is invalid or the handle is hidden.\r\n    let handle = this._handles[index];\r\n    if (!handle || handle.classList.contains('lm-mod-hidden')) {\r\n      return;\r\n    }\r\n\r\n    // Compute the desired delta movement for the handle.\r\n    let delta: number;\r\n    if (this._orientation === 'horizontal') {\r\n      delta = position - handle.offsetLeft;\r\n    } else {\r\n      delta = position - handle.offsetTop;\r\n    }\r\n\r\n    // Bail if there is no handle movement.\r\n    if (delta === 0) {\r\n      return;\r\n    }\r\n\r\n    // Prevent widget resizing unless needed.\r\n    for (let sizer of this._sizers) {\r\n      if (sizer.size > 0) {\r\n        sizer.sizeHint = sizer.size;\r\n      }\r\n    }\r\n\r\n    // Adjust the sizers to reflect the handle movement.\r\n    BoxEngine.adjust(this._sizers, index, delta);\r\n\r\n    // Update the layout of the widgets.\r\n    if (this.parent) {\r\n      this.parent.update();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Perform layout initialization which requires the parent widget.\r\n   */\r\n  protected init(): void {\r\n    this.parent!.dataset['orientation'] = this.orientation;\r\n    this.parent!.dataset['alignment'] = this.alignment;\r\n    super.init();\r\n  }\r\n\r\n  /**\r\n   * Attach a widget to the parent's DOM node.\r\n   *\r\n   * @param index - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to attach to the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected attachWidget(index: number, widget: Widget): void {\r\n    // Create the item, handle, and sizer for the new widget.\r\n    let item = new LayoutItem(widget);\r\n    let handle = Private.createHandle(this.renderer);\r\n    let average = Private.averageSize(this._sizers);\r\n    let sizer = Private.createSizer(average);\r\n\r\n    // Insert the item, handle, and sizer into the internal arrays.\r\n    ArrayExt.insert(this._items, index, item);\r\n    ArrayExt.insert(this._sizers, index, sizer);\r\n    ArrayExt.insert(this._handles, index, handle);\r\n\r\n    // Send a `'before-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    }\r\n\r\n    // Add the widget and handle nodes to the parent.\r\n    this.parent!.node.appendChild(widget.node);\r\n    this.parent!.node.appendChild(handle);\r\n\r\n    // Send an `'after-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n    }\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * Move a widget in the parent's DOM node.\r\n   *\r\n   * @param fromIndex - The previous index of the widget in the layout.\r\n   *\r\n   * @param toIndex - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to move in the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected moveWidget(fromIndex: number, toIndex: number, widget: Widget): void {\r\n    // Move the item, sizer, and handle for the widget.\r\n    ArrayExt.move(this._items, fromIndex, toIndex);\r\n    ArrayExt.move(this._sizers, fromIndex, toIndex);\r\n    ArrayExt.move(this._handles, fromIndex, toIndex);\r\n\r\n    // Post a fit request to the parent to show/hide last handle.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * Detach a widget from the parent's DOM node.\r\n   *\r\n   * @param index - The previous index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to detach from the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected detachWidget(index: number, widget: Widget): void {\r\n    // Remove the item, handle, and sizer for the widget.\r\n    let item = ArrayExt.removeAt(this._items, index);\r\n    let handle = ArrayExt.removeAt(this._handles, index);\r\n    ArrayExt.removeAt(this._sizers, index);\r\n\r\n    // Send a `'before-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    }\r\n\r\n    // Remove the widget and handle nodes from the parent.\r\n    this.parent!.node.removeChild(widget.node);\r\n    this.parent!.node.removeChild(handle!);\r\n\r\n    // Send an `'after-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n    }\r\n\r\n    // Dispose of the layout item.\r\n    item!.dispose();\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-show'` message.\r\n   */\r\n  protected onBeforeShow(msg: Message): void {\r\n    super.onBeforeShow(msg);\r\n    this.parent!.update();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    super.onBeforeAttach(msg);\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-shown'` message.\r\n   */\r\n  protected onChildShown(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-hidden'` message.\r\n   */\r\n  protected onChildHidden(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'resize'` message.\r\n   */\r\n  protected onResize(msg: Widget.ResizeMessage): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(msg.width, msg.height);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(-1, -1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'fit-request'` message.\r\n   */\r\n  protected onFitRequest(msg: Message): void {\r\n    if (this.parent!.isAttached) {\r\n      this._fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fit the layout to the total size required by the widgets.\r\n   */\r\n  private _fit(): void {\r\n    // Update the handles and track the visible widget count.\r\n    let nVisible = 0;\r\n    let lastHandleIndex = -1;\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      if (this._items[i].isHidden) {\r\n        this._handles[i].classList.add('lm-mod-hidden');\r\n        /* <DEPRECATED> */\r\n        this._handles[i].classList.add('p-mod-hidden');\r\n        /* </DEPRECATED> */\r\n      } else {\r\n        this._handles[i].classList.remove('lm-mod-hidden');\r\n        /* <DEPRECATED> */\r\n        this._handles[i].classList.remove('p-mod-hidden');\r\n        /* </DEPRECATED> */\r\n        lastHandleIndex = i;\r\n        nVisible++;\r\n      }\r\n    }\r\n\r\n    // Hide the handle for the last visible widget.\r\n    if (lastHandleIndex !== -1) {\r\n      this._handles[lastHandleIndex].classList.add('lm-mod-hidden');\r\n      /* <DEPRECATED> */\r\n      this._handles[lastHandleIndex].classList.add('p-mod-hidden');\r\n      /* </DEPRECATED> */\r\n    }\r\n\r\n    // Update the fixed space for the visible items.\r\n    this._fixed = this._spacing * Math.max(0, nVisible - 1);\r\n\r\n    // Setup the computed minimum size.\r\n    let horz = this._orientation === 'horizontal';\r\n    let minW = horz ? this._fixed : 0;\r\n    let minH = horz ? 0 : this._fixed;\r\n\r\n    // Update the sizers and computed size limits.\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      // Fetch the item and corresponding box sizer.\r\n      let item = this._items[i];\r\n      let sizer = this._sizers[i];\r\n\r\n      // Prevent resizing unless necessary.\r\n      if (sizer.size > 0) {\r\n        sizer.sizeHint = sizer.size;\r\n      }\r\n\r\n      // If the item is hidden, it should consume zero size.\r\n      if (item.isHidden) {\r\n        sizer.minSize = 0;\r\n        sizer.maxSize = 0;\r\n        continue;\r\n      }\r\n\r\n      // Update the size limits for the item.\r\n      item.fit();\r\n\r\n      // Update the stretch factor.\r\n      sizer.stretch = SplitLayout.getStretch(item.widget);\r\n\r\n      // Update the sizer limits and computed min size.\r\n      if (horz) {\r\n        sizer.minSize = item.minWidth;\r\n        sizer.maxSize = item.maxWidth;\r\n        minW += item.minWidth;\r\n        minH = Math.max(minH, item.minHeight);\r\n      } else {\r\n        sizer.minSize = item.minHeight;\r\n        sizer.maxSize = item.maxHeight;\r\n        minH += item.minHeight;\r\n        minW = Math.max(minW, item.minWidth);\r\n      }\r\n    }\r\n\r\n    // Update the box sizing and add it to the computed min size.\r\n    let box = this._box = ElementExt.boxSizing(this.parent!.node);\r\n    minW += box.horizontalSum;\r\n    minH += box.verticalSum;\r\n\r\n    // Update the parent's min size constraints.\r\n    let style = this.parent!.node.style;\r\n    style.minWidth = `${minW}px`;\r\n    style.minHeight = `${minH}px`;\r\n\r\n    // Set the dirty flag to ensure only a single update occurs.\r\n    this._dirty = true;\r\n\r\n    // Notify the ancestor that it should fit immediately. This may\r\n    // cause a resize of the parent, fulfilling the required update.\r\n    if (this.parent!.parent) {\r\n      MessageLoop.sendMessage(this.parent!.parent!, Widget.Msg.FitRequest);\r\n    }\r\n\r\n    // If the dirty flag is still set, the parent was not resized.\r\n    // Trigger the required update on the parent widget immediately.\r\n    if (this._dirty) {\r\n      MessageLoop.sendMessage(this.parent!, Widget.Msg.UpdateRequest);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the layout position and size of the widgets.\r\n   *\r\n   * The parent offset dimensions should be `-1` if unknown.\r\n   */\r\n  private _update(offsetWidth: number, offsetHeight: number): void {\r\n    // Clear the dirty flag to indicate the update occurred.\r\n    this._dirty = false;\r\n\r\n    // Compute the visible item count.\r\n    let nVisible = 0;\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      nVisible += +!this._items[i].isHidden;\r\n    }\r\n\r\n    // Bail early if there are no visible items to layout.\r\n    if (nVisible === 0) {\r\n      return;\r\n    }\r\n\r\n    // Measure the parent if the offset dimensions are unknown.\r\n    if (offsetWidth < 0) {\r\n      offsetWidth = this.parent!.node.offsetWidth;\r\n    }\r\n    if (offsetHeight < 0) {\r\n      offsetHeight = this.parent!.node.offsetHeight;\r\n    }\r\n\r\n    // Ensure the parent box sizing data is computed.\r\n    if (!this._box) {\r\n      this._box = ElementExt.boxSizing(this.parent!.node);\r\n    }\r\n\r\n    // Compute the actual layout bounds adjusted for border and padding.\r\n    let top = this._box.paddingTop;\r\n    let left = this._box.paddingLeft;\r\n    let width = offsetWidth - this._box.horizontalSum;\r\n    let height = offsetHeight - this._box.verticalSum;\r\n\r\n    // Compute the adjusted layout space.\r\n    let space: number;\r\n    let horz = this._orientation === 'horizontal';\r\n    if (horz) {\r\n      space = Math.max(0, width - this._fixed);\r\n    } else {\r\n      space = Math.max(0, height - this._fixed);\r\n    }\r\n\r\n    // Scale the size hints if they are normalized.\r\n    if (this._hasNormedSizes) {\r\n      for (let sizer of this._sizers) {\r\n        sizer.sizeHint *= space;\r\n      }\r\n      this._hasNormedSizes = false;\r\n    }\r\n\r\n    // Distribute the layout space to the box sizers.\r\n    let delta = BoxEngine.calc(this._sizers, space);\r\n\r\n    // Set up the variables for justification and alignment offset.\r\n    let extra = 0;\r\n    let offset = 0;\r\n\r\n    // Account for alignment if there is extra layout space.\r\n    if (delta > 0) {\r\n      switch (this._alignment) {\r\n      case 'start':\r\n        break;\r\n      case 'center':\r\n        extra = 0;\r\n        offset = delta / 2;\r\n        break;\r\n      case 'end':\r\n        extra = 0;\r\n        offset = delta;\r\n        break;\r\n      case 'justify':\r\n        extra = delta / nVisible;\r\n        offset = 0;\r\n        break;\r\n      default:\r\n        throw 'unreachable';\r\n      }\r\n    }\r\n\r\n    // Layout the items using the computed box sizes.\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      // Fetch the item.\r\n      let item = this._items[i];\r\n\r\n      // Ignore hidden items.\r\n      if (item.isHidden) {\r\n        continue;\r\n      }\r\n\r\n      // Fetch the computed size for the widget.\r\n      let size = this._sizers[i].size;\r\n\r\n      // Fetch the style for the handle.\r\n      let handleStyle = this._handles[i].style;\r\n\r\n      // Update the widget and handle, and advance the relevant edge.\r\n      if (horz) {\r\n        item.update(left + offset, top, size + extra, height);\r\n        left += size + extra;\r\n        handleStyle.top = `${top}px`;\r\n        handleStyle.left = `${left + offset}px`;\r\n        handleStyle.width = `${this._spacing}px`;\r\n        handleStyle.height = `${height}px`;\r\n        left += this._spacing;\r\n      } else {\r\n        item.update(left, top + offset, width, size + extra);\r\n        top += size + extra;\r\n        handleStyle.top = `${top + offset}px`;\r\n        handleStyle.left = `${left}px`;\r\n        handleStyle.width = `${width}px`;\r\n        handleStyle.height = `${this._spacing}px`;\r\n        top += this._spacing;\r\n      }\r\n    }\r\n  }\r\n\r\n  private _fixed = 0;\r\n  private _spacing = 4;\r\n  private _dirty = false;\r\n  private _hasNormedSizes = false;\r\n  private _sizers: BoxSizer[] = [];\r\n  private _items: LayoutItem[] = [];\r\n  private _handles: HTMLDivElement[] = [];\r\n  private _box: ElementExt.IBoxSizing | null = null;\r\n  private _alignment: SplitLayout.Alignment = 'start';\r\n  private _orientation: SplitLayout.Orientation = 'horizontal';\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `SplitLayout` class statics.\r\n */\r\nexport\r\nnamespace SplitLayout {\r\n  /**\r\n   * A type alias for a split layout orientation.\r\n   */\r\n  export\r\n  type Orientation = 'horizontal' | 'vertical';\r\n\r\n  /**\r\n   * A type alias for a split layout alignment.\r\n   */\r\n  export\r\n  type Alignment = 'start' | 'center' | 'end' | 'justify';\r\n\r\n  /**\r\n   * An options object for initializing a split layout.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The renderer to use for the split layout.\r\n     */\r\n    renderer: IRenderer;\r\n\r\n    /**\r\n     * The orientation of the layout.\r\n     *\r\n     * The default is `'horizontal'`.\r\n     */\r\n    orientation?: Orientation;\r\n\r\n    /**\r\n     * The content alignment of the layout.\r\n     *\r\n     * The default is `'start'`.\r\n     */\r\n    alignment?: Alignment;\r\n\r\n    /**\r\n     * The spacing between items in the layout.\r\n     *\r\n     * The default is `4`.\r\n     */\r\n    spacing?: number;\r\n  }\r\n\r\n  /**\r\n   * A renderer for use with a split layout.\r\n   */\r\n  export\r\n  interface IRenderer {\r\n    /**\r\n     * Create a new handle for use with a split layout.\r\n     *\r\n     * @returns A new handle element.\r\n     */\r\n    createHandle(): HTMLDivElement;\r\n  }\r\n\r\n  /**\r\n   * Get the split layout stretch factor for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The split layout stretch factor for the widget.\r\n   */\r\n  export\r\n  function getStretch(widget: Widget): number {\r\n    return Private.stretchProperty.get(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the split layout stretch factor for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the stretch factor.\r\n   */\r\n  export\r\n  function setStretch(widget: Widget, value: number): void {\r\n    Private.stretchProperty.set(widget, value);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * The property descriptor for a widget stretch factor.\r\n   */\r\n  export\r\n  const stretchProperty = new AttachedProperty<Widget, number>({\r\n    name: 'stretch',\r\n    create: () => 0,\r\n    coerce: (owner, value) => Math.max(0, Math.floor(value)),\r\n    changed: onChildSizingChanged\r\n  });\r\n\r\n  /**\r\n   * Create a new box sizer with the given size hint.\r\n   */\r\n  export\r\n  function createSizer(size: number): BoxSizer {\r\n    let sizer = new BoxSizer();\r\n    sizer.sizeHint = Math.floor(size);\r\n    return sizer;\r\n  }\r\n\r\n  /**\r\n   * Create a new split handle node using the given renderer.\r\n   */\r\n  export\r\n  function createHandle(renderer: SplitLayout.IRenderer): HTMLDivElement {\r\n    let handle = renderer.createHandle();\r\n    handle.style.position = 'absolute';\r\n    return handle;\r\n  }\r\n\r\n  /**\r\n   * Clamp a spacing value to an integer >= 0.\r\n   */\r\n  export\r\n  function clampSpacing(value: number): number {\r\n    return Math.max(0, Math.floor(value));\r\n  }\r\n\r\n  /**\r\n   * Compute the average size of an array of box sizers.\r\n   */\r\n  export\r\n  function averageSize(sizers: BoxSizer[]): number {\r\n    return sizers.reduce((v, s) => v + s.size, 0) / sizers.length || 0;\r\n  }\r\n\r\n  /**\r\n   * Normalize an array of values.\r\n   */\r\n  export\r\n  function normalize(values: number[]): number[] {\r\n    let n = values.length;\r\n    if (n === 0) {\r\n      return [];\r\n    }\r\n    let sum = values.reduce((a, b) => a + Math.abs(b), 0);\r\n    return sum === 0 ? values.map(v => 1 / n) : values.map(v => v / sum);\r\n  }\r\n\r\n  /**\r\n   * The change handler for the attached sizing properties.\r\n   */\r\n  function onChildSizingChanged(child: Widget): void {\r\n    if (child.parent && child.parent.layout instanceof SplitLayout) {\r\n      child.parent.fit();\r\n    }\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  IDisposable\r\n} from '@lumino/disposable';\r\n\r\nimport {\r\n  Drag\r\n} from '@lumino/dragdrop';\r\n\r\nimport {\r\n  Message\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  Panel\r\n} from './panel';\r\n\r\nimport {\r\n  SplitLayout\r\n} from './splitlayout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A panel which arranges its widgets into resizable sections.\r\n *\r\n * #### Notes\r\n * This class provides a convenience wrapper around a [[SplitLayout]].\r\n */\r\nexport\r\nclass SplitPanel extends Panel {\r\n  /**\r\n   * Construct a new split panel.\r\n   *\r\n   * @param options - The options for initializing the split panel.\r\n   */\r\n  constructor(options: SplitPanel.IOptions = {}) {\r\n    super({ layout: Private.createLayout(options) });\r\n    this.addClass('lm-SplitPanel');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-SplitPanel');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * Dispose of the resources held by the panel.\r\n   */\r\n  dispose(): void {\r\n    this._releaseMouse();\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * Get the layout orientation for the split panel.\r\n   */\r\n  get orientation(): SplitPanel.Orientation {\r\n    return (this.layout as SplitLayout).orientation;\r\n  }\r\n\r\n  /**\r\n   * Set the layout orientation for the split panel.\r\n   */\r\n  set orientation(value: SplitPanel.Orientation) {\r\n    (this.layout as SplitLayout).orientation = value;\r\n  }\r\n\r\n  /**\r\n   * Get the content alignment for the split panel.\r\n   *\r\n   * #### Notes\r\n   * This is the alignment of the widgets in the layout direction.\r\n   *\r\n   * The alignment has no effect if the widgets can expand to fill the\r\n   * entire split panel.\r\n   */\r\n  get alignment(): SplitPanel.Alignment {\r\n    return (this.layout as SplitLayout).alignment;\r\n  }\r\n\r\n  /**\r\n   * Set the content alignment for the split panel.\r\n   *\r\n   * #### Notes\r\n   * This is the alignment of the widgets in the layout direction.\r\n   *\r\n   * The alignment has no effect if the widgets can expand to fill the\r\n   * entire split panel.\r\n   */\r\n  set alignment(value: SplitPanel.Alignment) {\r\n    (this.layout as SplitLayout).alignment = value;\r\n  }\r\n\r\n  /**\r\n   * Get the inter-element spacing for the split panel.\r\n   */\r\n  get spacing(): number {\r\n    return (this.layout as SplitLayout).spacing;\r\n  }\r\n\r\n  /**\r\n   * Set the inter-element spacing for the split panel.\r\n   */\r\n  set spacing(value: number) {\r\n    (this.layout as SplitLayout).spacing = value;\r\n  }\r\n\r\n  /**\r\n   * The renderer used by the split panel.\r\n   */\r\n  get renderer(): SplitPanel.IRenderer {\r\n    return (this.layout as SplitLayout).renderer;\r\n  }\r\n\r\n  /**\r\n   * A read-only array of the split handles in the panel.\r\n   */\r\n  get handles(): ReadonlyArray<HTMLDivElement> {\r\n    return (this.layout as SplitLayout).handles;\r\n  }\r\n\r\n  /**\r\n   * Get the relative sizes of the widgets in the panel.\r\n   *\r\n   * @returns A new array of the relative sizes of the widgets.\r\n   *\r\n   * #### Notes\r\n   * The returned sizes reflect the sizes of the widgets normalized\r\n   * relative to their siblings.\r\n   *\r\n   * This method **does not** measure the DOM nodes.\r\n   */\r\n  relativeSizes(): number[] {\r\n    return (this.layout as SplitLayout).relativeSizes();\r\n  }\r\n\r\n  /**\r\n   * Set the relative sizes for the widgets in the panel.\r\n   *\r\n   * @param sizes - The relative sizes for the widgets in the panel.\r\n   *\r\n   * #### Notes\r\n   * Extra values are ignored, too few will yield an undefined layout.\r\n   *\r\n   * The actual geometry of the DOM nodes is updated asynchronously.\r\n   */\r\n  setRelativeSizes(sizes: number[]): void {\r\n    (this.layout as SplitLayout).setRelativeSizes(sizes);\r\n  }\r\n\r\n  /**\r\n   * Handle the DOM events for the split panel.\r\n   *\r\n   * @param event - The DOM event sent to the panel.\r\n   *\r\n   * #### Notes\r\n   * This method implements the DOM `EventListener` interface and is\r\n   * called in response to events on the panel's DOM node. It should\r\n   * not be called directly by user code.\r\n   */\r\n  handleEvent(event: Event): void {\r\n    switch (event.type) {\r\n    case 'mousedown':\r\n      this._evtMouseDown(event as MouseEvent);\r\n      break;\r\n    case 'mousemove':\r\n      this._evtMouseMove(event as MouseEvent);\r\n      break;\r\n    case 'mouseup':\r\n      this._evtMouseUp(event as MouseEvent);\r\n      break;\r\n    case 'keydown':\r\n      this._evtKeyDown(event as KeyboardEvent);\r\n      break;\r\n    case 'contextmenu':\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    this.node.addEventListener('mousedown', this);\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'after-detach'` message.\r\n   */\r\n  protected onAfterDetach(msg: Message): void {\r\n    this.node.removeEventListener('mousedown', this);\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-added'` message.\r\n   */\r\n  protected onChildAdded(msg: Widget.ChildMessage): void {\r\n    msg.child.addClass('lm-SplitPanel-child');\r\n    /* <DEPRECATED> */\r\n    msg.child.addClass('p-SplitPanel-child');\r\n    /* </DEPRECATED> */\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-removed'` message.\r\n   */\r\n  protected onChildRemoved(msg: Widget.ChildMessage): void {\r\n    msg.child.removeClass('lm-SplitPanel-child');\r\n    /* <DEPRECATED> */\r\n    msg.child.removeClass('p-SplitPanel-child');\r\n    /* </DEPRECATED> */\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * Handle the `'keydown'` event for the split panel.\r\n   */\r\n  private _evtKeyDown(event: KeyboardEvent): void {\r\n    // Stop input events during drag.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Release the mouse if `Escape` is pressed.\r\n    if (event.keyCode === 27) {\r\n      this._releaseMouse();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousedown'` event for the split panel.\r\n   */\r\n  private _evtMouseDown(event: MouseEvent): void {\r\n    // Do nothing if the left mouse button is not pressed.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Find the handle which contains the mouse target, if any.\r\n    let layout = this.layout as SplitLayout;\r\n    let index = ArrayExt.findFirstIndex(layout.handles, handle => {\r\n      return handle.contains(event.target as HTMLElement);\r\n    });\r\n\r\n    // Bail early if the mouse press was not on a handle.\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event when a split handle is pressed.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Add the extra document listeners.\r\n    document.addEventListener('mouseup', this, true);\r\n    document.addEventListener('mousemove', this, true);\r\n    document.addEventListener('keydown', this, true);\r\n    document.addEventListener('contextmenu', this, true);\r\n\r\n    // Compute the offset delta for the handle press.\r\n    let delta: number;\r\n    let handle = layout.handles[index];\r\n    let rect = handle.getBoundingClientRect();\r\n    if (layout.orientation === 'horizontal') {\r\n      delta = event.clientX - rect.left;\r\n    } else {\r\n      delta = event.clientY - rect.top;\r\n    }\r\n\r\n    // Override the cursor and store the press data.\r\n    let style = window.getComputedStyle(handle);\r\n    let override = Drag.overrideCursor(style.cursor!);\r\n    this._pressData = { index, delta, override };\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mousemove'` event for the split panel.\r\n   */\r\n  private _evtMouseMove(event: MouseEvent): void {\r\n    // Stop the event when dragging a split handle.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Compute the desired offset position for the handle.\r\n    let pos: number;\r\n    let layout = this.layout as SplitLayout;\r\n    let rect = this.node.getBoundingClientRect();\r\n    if (layout.orientation === 'horizontal') {\r\n      pos = event.clientX - rect.left - this._pressData!.delta;\r\n    } else {\r\n      pos = event.clientY - rect.top - this._pressData!.delta;\r\n    }\r\n\r\n    // Move the handle as close to the desired position as possible.\r\n    layout.moveHandle(this._pressData!.index, pos);\r\n  }\r\n\r\n  /**\r\n   * Handle the `'mouseup'` event for the split panel.\r\n   */\r\n  private _evtMouseUp(event: MouseEvent): void {\r\n    // Do nothing if the left mouse button is not released.\r\n    if (event.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Stop the event when releasing a handle.\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Finalize the mouse release.\r\n    this._releaseMouse();\r\n  }\r\n\r\n  /**\r\n   * Release the mouse grab for the split panel.\r\n   */\r\n  private _releaseMouse(): void {\r\n    // Bail early if no drag is in progress.\r\n    if (!this._pressData) {\r\n      return;\r\n    }\r\n\r\n    // Clear the override cursor.\r\n    this._pressData.override.dispose();\r\n    this._pressData = null;\r\n\r\n    // Remove the extra document listeners.\r\n    document.removeEventListener('mouseup', this, true);\r\n    document.removeEventListener('mousemove', this, true);\r\n    document.removeEventListener('keydown', this, true);\r\n    document.removeEventListener('contextmenu', this, true);\r\n  }\r\n\r\n  private _pressData: Private.IPressData | null = null;\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `SplitPanel` class statics.\r\n */\r\nexport\r\nnamespace SplitPanel {\r\n  /**\r\n   * A type alias for a split panel orientation.\r\n   */\r\n  export\r\n  type Orientation = SplitLayout.Orientation;\r\n\r\n  /**\r\n   * A type alias for a split panel alignment.\r\n   */\r\n  export\r\n  type Alignment = SplitLayout.Alignment;\r\n\r\n  /**\r\n   * A type alias for a split panel renderer.\r\n   */\r\n  export\r\n  type IRenderer = SplitLayout.IRenderer;\r\n\r\n  /**\r\n   * An options object for initializing a split panel.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The renderer to use for the split panel.\r\n     *\r\n     * The default is a shared renderer instance.\r\n     */\r\n    renderer?: IRenderer;\r\n\r\n    /**\r\n     * The layout orientation of the panel.\r\n     *\r\n     * The default is `'horizontal'`.\r\n     */\r\n    orientation?: Orientation;\r\n\r\n    /**\r\n     * The content alignment of the panel.\r\n     *\r\n     * The default is `'start'`.\r\n     */\r\n    alignment?: Alignment;\r\n\r\n    /**\r\n     * The spacing between items in the panel.\r\n     *\r\n     * The default is `4`.\r\n     */\r\n    spacing?: number;\r\n\r\n    /**\r\n     * The split layout to use for the split panel.\r\n     *\r\n     * If this is provided, the other options are ignored.\r\n     *\r\n     * The default is a new `SplitLayout`.\r\n     */\r\n    layout?: SplitLayout;\r\n  }\r\n\r\n  /**\r\n   * The default implementation of `IRenderer`.\r\n   */\r\n  export\r\n  class Renderer implements IRenderer {\r\n    /**\r\n     * Create a new handle for use with a split panel.\r\n     *\r\n     * @returns A new handle element for a split panel.\r\n     */\r\n    createHandle(): HTMLDivElement {\r\n      let handle = document.createElement('div');\r\n      handle.className = 'lm-SplitPanel-handle';\r\n      /* <DEPRECATED> */\r\n      handle.classList.add('p-SplitPanel-handle');\r\n      /* </DEPRECATED> */\r\n      return handle;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The default `Renderer` instance.\r\n   */\r\n  export\r\n  const defaultRenderer = new Renderer();\r\n\r\n  /**\r\n   * Get the split panel stretch factor for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @returns The split panel stretch factor for the widget.\r\n   */\r\n  export\r\n  function getStretch(widget: Widget): number {\r\n    return SplitLayout.getStretch(widget);\r\n  }\r\n\r\n  /**\r\n   * Set the split panel stretch factor for the given widget.\r\n   *\r\n   * @param widget - The widget of interest.\r\n   *\r\n   * @param value - The value for the stretch factor.\r\n   */\r\n  export\r\n  function setStretch(widget: Widget, value: number): void {\r\n    SplitLayout.setStretch(widget, value);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * An object which holds mouse press data.\r\n   */\r\n  export\r\n  interface IPressData {\r\n    /**\r\n     * The index of the pressed handle.\r\n     */\r\n    index: number;\r\n\r\n    /**\r\n     * The offset of the press in handle coordinates.\r\n     */\r\n    delta: number;\r\n\r\n    /**\r\n     * The disposable which will clear the override cursor.\r\n     */\r\n    override: IDisposable;\r\n  }\r\n\r\n  /**\r\n   * Create a split layout for the given panel options.\r\n   */\r\n  export\r\n  function createLayout(options: SplitPanel.IOptions): SplitLayout {\r\n    return options.layout || new SplitLayout({\r\n      renderer: options.renderer || SplitPanel.defaultRenderer,\r\n      orientation: options.orientation,\r\n      alignment: options.alignment,\r\n      spacing: options.spacing\r\n    });\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ArrayExt, each\r\n} from '@lumino/algorithm';\r\n\r\nimport {\r\n  ElementExt\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  Message, MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  LayoutItem\r\n} from './layout';\r\n\r\nimport {\r\n  PanelLayout\r\n} from './panellayout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A layout where visible widgets are stacked atop one another.\r\n *\r\n * #### Notes\r\n * The Z-order of the visible widgets follows their layout order.\r\n */\r\nexport\r\nclass StackedLayout extends PanelLayout {\r\n  /**\r\n   * Dispose of the resources held by the layout.\r\n   */\r\n  dispose(): void {\r\n    // Dispose of the layout items.\r\n    each(this._items, item => { item.dispose(); });\r\n\r\n    // Clear the layout state.\r\n    this._box = null;\r\n    this._items.length = 0;\r\n\r\n    // Dispose of the rest of the layout.\r\n    super.dispose();\r\n  }\r\n\r\n  /**\r\n   * Attach a widget to the parent's DOM node.\r\n   *\r\n   * @param index - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to attach to the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected attachWidget(index: number, widget: Widget): void {\r\n    // Create and add a new layout item for the widget.\r\n    ArrayExt.insert(this._items, index, new LayoutItem(widget));\r\n\r\n    // Send a `'before-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeAttach);\r\n    }\r\n\r\n    // Add the widget's node to the parent.\r\n    this.parent!.node.appendChild(widget.node);\r\n\r\n    // Send an `'after-attach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\r\n    }\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * Move a widget in the parent's DOM node.\r\n   *\r\n   * @param fromIndex - The previous index of the widget in the layout.\r\n   *\r\n   * @param toIndex - The current index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to move in the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected moveWidget(fromIndex: number, toIndex: number, widget: Widget): void {\r\n    // Move the layout item for the widget.\r\n    ArrayExt.move(this._items, fromIndex, toIndex);\r\n\r\n    // Post an update request for the parent widget.\r\n    this.parent!.update();\r\n  }\r\n\r\n  /**\r\n   * Detach a widget from the parent's DOM node.\r\n   *\r\n   * @param index - The previous index of the widget in the layout.\r\n   *\r\n   * @param widget - The widget to detach from the parent.\r\n   *\r\n   * #### Notes\r\n   * This is a reimplementation of the superclass method.\r\n   */\r\n  protected detachWidget(index: number, widget: Widget): void {\r\n    // Remove the layout item for the widget.\r\n    let item = ArrayExt.removeAt(this._items, index);\r\n\r\n    // Send a `'before-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\r\n    }\r\n\r\n    // Remove the widget's node from the parent.\r\n    this.parent!.node.removeChild(widget.node);\r\n\r\n    // Send an `'after-detach'` message if the parent is attached.\r\n    if (this.parent!.isAttached) {\r\n      MessageLoop.sendMessage(widget, Widget.Msg.AfterDetach);\r\n    }\r\n\r\n    // Reset the z-index for the widget.\r\n    item!.widget.node.style.zIndex = '';\r\n\r\n    // Dispose of the layout item.\r\n    item!.dispose();\r\n\r\n    // Post a fit request for the parent widget.\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-show'` message.\r\n   */\r\n  protected onBeforeShow(msg: Message): void {\r\n    super.onBeforeShow(msg);\r\n    this.parent!.update();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'before-attach'` message.\r\n   */\r\n  protected onBeforeAttach(msg: Message): void {\r\n    super.onBeforeAttach(msg);\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-shown'` message.\r\n   */\r\n  protected onChildShown(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-hidden'` message.\r\n   */\r\n  protected onChildHidden(msg: Widget.ChildMessage): void {\r\n    this.parent!.fit();\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'resize'` message.\r\n   */\r\n  protected onResize(msg: Widget.ResizeMessage): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(msg.width, msg.height);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on an `'update-request'` message.\r\n   */\r\n  protected onUpdateRequest(msg: Message): void {\r\n    if (this.parent!.isVisible) {\r\n      this._update(-1, -1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'fit-request'` message.\r\n   */\r\n  protected onFitRequest(msg: Message): void {\r\n    if (this.parent!.isAttached) {\r\n      this._fit();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fit the layout to the total size required by the widgets.\r\n   */\r\n  private _fit(): void {\r\n    // Set up the computed minimum size.\r\n    let minW = 0;\r\n    let minH = 0;\r\n\r\n    // Update the computed minimum size.\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      // Fetch the item.\r\n      let item = this._items[i];\r\n\r\n      // Ignore hidden items.\r\n      if (item.isHidden) {\r\n        continue;\r\n      }\r\n\r\n      // Update the size limits for the item.\r\n      item.fit();\r\n\r\n      // Update the computed minimum size.\r\n      minW = Math.max(minW, item.minWidth);\r\n      minH = Math.max(minH, item.minHeight);\r\n    }\r\n\r\n    // Update the box sizing and add it to the computed min size.\r\n    let box = this._box = ElementExt.boxSizing(this.parent!.node);\r\n    minW += box.horizontalSum;\r\n    minH += box.verticalSum;\r\n\r\n    // Update the parent's min size constraints.\r\n    let style = this.parent!.node.style;\r\n    style.minWidth = `${minW}px`;\r\n    style.minHeight = `${minH}px`;\r\n\r\n    // Set the dirty flag to ensure only a single update occurs.\r\n    this._dirty = true;\r\n\r\n    // Notify the ancestor that it should fit immediately. This may\r\n    // cause a resize of the parent, fulfilling the required update.\r\n    if (this.parent!.parent) {\r\n      MessageLoop.sendMessage(this.parent!.parent!, Widget.Msg.FitRequest);\r\n    }\r\n\r\n    // If the dirty flag is still set, the parent was not resized.\r\n    // Trigger the required update on the parent widget immediately.\r\n    if (this._dirty) {\r\n      MessageLoop.sendMessage(this.parent!, Widget.Msg.UpdateRequest);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the layout position and size of the widgets.\r\n   *\r\n   * The parent offset dimensions should be `-1` if unknown.\r\n   */\r\n  private _update(offsetWidth: number, offsetHeight: number): void {\r\n    // Clear the dirty flag to indicate the update occurred.\r\n    this._dirty = false;\r\n\r\n    // Compute the visible item count.\r\n    let nVisible = 0;\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      nVisible += +!this._items[i].isHidden;\r\n    }\r\n\r\n    // Bail early if there are no visible items to layout.\r\n    if (nVisible === 0) {\r\n      return;\r\n    }\r\n\r\n    // Measure the parent if the offset dimensions are unknown.\r\n    if (offsetWidth < 0) {\r\n      offsetWidth = this.parent!.node.offsetWidth;\r\n    }\r\n    if (offsetHeight < 0) {\r\n      offsetHeight = this.parent!.node.offsetHeight;\r\n    }\r\n\r\n    // Ensure the parent box sizing data is computed.\r\n    if (!this._box) {\r\n      this._box = ElementExt.boxSizing(this.parent!.node);\r\n    }\r\n\r\n    // Compute the actual layout bounds adjusted for border and padding.\r\n    let top = this._box.paddingTop;\r\n    let left = this._box.paddingLeft;\r\n    let width = offsetWidth - this._box.horizontalSum;\r\n    let height = offsetHeight - this._box.verticalSum;\r\n\r\n    // Update the widget stacking order and layout geometry.\r\n    for (let i = 0, n = this._items.length; i < n; ++i) {\r\n      // Fetch the item.\r\n      let item = this._items[i];\r\n\r\n      // Ignore hidden items.\r\n      if (item.isHidden) {\r\n        continue;\r\n      }\r\n\r\n      // Set the z-index for the widget.\r\n      item.widget.node.style.zIndex = `${i}`;\r\n\r\n      // Update the item geometry.\r\n      item.update(left, top, width, height);\r\n    }\r\n  }\r\n\r\n  private _dirty = false;\r\n  private _items: LayoutItem[] = [];\r\n  private _box: ElementExt.IBoxSizing | null = null;\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  Panel\r\n} from './panel';\r\n\r\nimport {\r\n  StackedLayout\r\n} from './stackedlayout';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A panel where visible widgets are stacked atop one another.\r\n *\r\n * #### Notes\r\n * This class provides a convenience wrapper around a [[StackedLayout]].\r\n */\r\nexport\r\nclass StackedPanel extends Panel {\r\n  /**\r\n   * Construct a new stacked panel.\r\n   *\r\n   * @param options - The options for initializing the panel.\r\n   */\r\n  constructor(options: StackedPanel.IOptions = {}) {\r\n    super({ layout: Private.createLayout(options) });\r\n    this.addClass('lm-StackedPanel');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-StackedPanel');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when a widget is removed from a stacked panel.\r\n   */\r\n  get widgetRemoved(): ISignal<this, Widget> {\r\n    return this._widgetRemoved;\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-added'` message.\r\n   */\r\n  protected onChildAdded(msg: Widget.ChildMessage): void {\r\n    msg.child.addClass('lm-StackedPanel-child');\r\n    /* <DEPRECATED> */\r\n    msg.child.addClass('p-StackedPanel-child');\r\n    /* </DEPRECATED> */\r\n  }\r\n\r\n  /**\r\n   * A message handler invoked on a `'child-removed'` message.\r\n   */\r\n  protected onChildRemoved(msg: Widget.ChildMessage): void {\r\n    msg.child.removeClass('lm-StackedPanel-child');\r\n    /* <DEPRECATED> */\r\n    msg.child.removeClass('p-StackedPanel-child');\r\n    /* </DEPRECATED> */\r\n    this._widgetRemoved.emit(msg.child);\r\n  }\r\n\r\n  private _widgetRemoved = new Signal<this, Widget>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `StackedPanel` class statics.\r\n */\r\nexport\r\nnamespace StackedPanel {\r\n  /**\r\n   * An options object for creating a stacked panel.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * The stacked layout to use for the stacked panel.\r\n     *\r\n     * The default is a new `StackedLayout`.\r\n     */\r\n    layout?: StackedLayout;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * Create a stacked layout for the given panel options.\r\n   */\r\n  export\r\n  function createLayout(options: StackedPanel.IOptions): StackedLayout {\r\n    return options.layout || new StackedLayout();\r\n  }\r\n}\r\n","// Copyright (c) Jupyter Development Team.\r\n// Distributed under the terms of the Modified BSD License.\r\n/*-----------------------------------------------------------------------------\r\n| Copyright (c) 2014-2017, PhosphorJS Contributors\r\n|\r\n| Distributed under the terms of the BSD 3-Clause License.\r\n|\r\n| The full license is in the file LICENSE, distributed with this software.\r\n|----------------------------------------------------------------------------*/\r\nimport {\r\n  Platform\r\n} from '@lumino/domutils';\r\n\r\nimport {\r\n  MessageLoop\r\n} from '@lumino/messaging';\r\n\r\nimport {\r\n  ISignal, Signal\r\n} from '@lumino/signaling';\r\n\r\nimport {\r\n  BoxLayout\r\n} from './boxlayout';\r\n\r\nimport {\r\n  StackedPanel\r\n} from './stackedpanel';\r\n\r\nimport {\r\n  TabBar\r\n} from './tabbar';\r\n\r\nimport {\r\n  Widget\r\n} from './widget';\r\n\r\n\r\n/**\r\n * A widget which combines a `TabBar` and a `StackedPanel`.\r\n *\r\n * #### Notes\r\n * This is a simple panel which handles the common case of a tab bar\r\n * placed next to a content area. The selected tab controls the widget\r\n * which is shown in the content area.\r\n *\r\n * For use cases which require more control than is provided by this\r\n * panel, the `TabBar` widget may be used independently.\r\n */\r\nexport\r\nclass TabPanel extends Widget {\r\n  /**\r\n   * Construct a new tab panel.\r\n   *\r\n   * @param options - The options for initializing the tab panel.\r\n   */\r\n  constructor(options: TabPanel.IOptions = {}) {\r\n    super();\r\n    this.addClass('lm-TabPanel');\r\n    /* <DEPRECATED> */\r\n    this.addClass('p-TabPanel');\r\n    /* </DEPRECATED> */\r\n\r\n    // Create the tab bar and stacked panel.\r\n    this.tabBar = new TabBar<Widget>(options);\r\n    this.tabBar.addClass('lm-TabPanel-tabBar');\r\n    this.stackedPanel = new StackedPanel();\r\n    this.stackedPanel.addClass('lm-TabPanel-stackedPanel');\r\n    /* <DEPRECATED> */\r\n    this.tabBar.addClass('p-TabPanel-tabBar');\r\n    this.stackedPanel.addClass('p-TabPanel-stackedPanel');\r\n    /* </DEPRECATED> */\r\n\r\n    // Connect the tab bar signal handlers.\r\n    this.tabBar.tabMoved.connect(this._onTabMoved, this);\r\n    this.tabBar.currentChanged.connect(this._onCurrentChanged, this);\r\n    this.tabBar.tabCloseRequested.connect(this._onTabCloseRequested, this);\r\n    this.tabBar.tabActivateRequested.connect(this._onTabActivateRequested, this);\r\n\r\n    // Connect the stacked panel signal handlers.\r\n    this.stackedPanel.widgetRemoved.connect(this._onWidgetRemoved, this);\r\n\r\n    // Get the data related to the placement.\r\n    this._tabPlacement = options.tabPlacement || 'top';\r\n    let direction = Private.directionFromPlacement(this._tabPlacement);\r\n    let orientation = Private.orientationFromPlacement(this._tabPlacement);\r\n\r\n    // Configure the tab bar for the placement.\r\n    this.tabBar.orientation = orientation;\r\n    this.tabBar.dataset['placement'] = this._tabPlacement;\r\n\r\n    // Create the box layout.\r\n    let layout = new BoxLayout({ direction, spacing: 0 });\r\n\r\n    // Set the stretch factors for the child widgets.\r\n    BoxLayout.setStretch(this.tabBar, 0);\r\n    BoxLayout.setStretch(this.stackedPanel, 1);\r\n\r\n    // Add the child widgets to the layout.\r\n    layout.addWidget(this.tabBar);\r\n    layout.addWidget(this.stackedPanel);\r\n\r\n    // Install the layout on the tab panel.\r\n    this.layout = layout;\r\n  }\r\n\r\n  /**\r\n   * A signal emitted when the current tab is changed.\r\n   *\r\n   * #### Notes\r\n   * This signal is emitted when the currently selected tab is changed\r\n   * either through user or programmatic interaction.\r\n   *\r\n   * Notably, this signal is not emitted when the index of the current\r\n   * tab changes due to tabs being inserted, removed, or moved. It is\r\n   * only emitted when the actual current tab node is changed.\r\n   */\r\n  get currentChanged(): ISignal<this, TabPanel.ICurrentChangedArgs> {\r\n    return this._currentChanged;\r\n  }\r\n\r\n  /**\r\n   * Get the index of the currently selected tab.\r\n   *\r\n   * #### Notes\r\n   * This will be `-1` if no tab is selected.\r\n   */\r\n  get currentIndex(): number {\r\n    return this.tabBar.currentIndex;\r\n  }\r\n\r\n  /**\r\n   * Set the index of the currently selected tab.\r\n   *\r\n   * #### Notes\r\n   * If the index is out of range, it will be set to `-1`.\r\n   */\r\n  set currentIndex(value: number) {\r\n    this.tabBar.currentIndex = value;\r\n  }\r\n\r\n  /**\r\n   * Get the currently selected widget.\r\n   *\r\n   * #### Notes\r\n   * This will be `null` if there is no selected tab.\r\n   */\r\n  get currentWidget(): Widget | null {\r\n    let title = this.tabBar.currentTitle;\r\n    return title ? title.owner : null;\r\n  }\r\n\r\n  /**\r\n   * Set the currently selected widget.\r\n   *\r\n   * #### Notes\r\n   * If the widget is not in the panel, it will be set to `null`.\r\n   */\r\n  set currentWidget(value: Widget | null) {\r\n    this.tabBar.currentTitle = value ? value.title : null;\r\n  }\r\n\r\n  /**\r\n   * Get the whether the tabs are movable by the user.\r\n   *\r\n   * #### Notes\r\n   * Tabs can always be moved programmatically.\r\n   */\r\n  get tabsMovable(): boolean {\r\n    return this.tabBar.tabsMovable;\r\n  }\r\n\r\n  /**\r\n   * Set the whether the tabs are movable by the user.\r\n   *\r\n   * #### Notes\r\n   * Tabs can always be moved programmatically.\r\n   */\r\n  set tabsMovable(value: boolean) {\r\n    this.tabBar.tabsMovable = value;\r\n  }\r\n\r\n  /**\r\n   * Get the tab placement for the tab panel.\r\n   *\r\n   * #### Notes\r\n   * This controls the position of the tab bar relative to the content.\r\n   */\r\n  get tabPlacement(): TabPanel.TabPlacement {\r\n    return this._tabPlacement;\r\n  }\r\n\r\n  /**\r\n   * Set the tab placement for the tab panel.\r\n   *\r\n   * #### Notes\r\n   * This controls the position of the tab bar relative to the content.\r\n   */\r\n  set tabPlacement(value: TabPanel.TabPlacement) {\r\n    // Bail if the placement does not change.\r\n    if (this._tabPlacement === value) {\r\n      return;\r\n    }\r\n\r\n    // Update the internal value.\r\n    this._tabPlacement = value;\r\n\r\n    // Get the values related to the placement.\r\n    let direction = Private.directionFromPlacement(value);\r\n    let orientation = Private.orientationFromPlacement(value);\r\n\r\n    // Configure the tab bar for the placement.\r\n    this.tabBar.orientation = orientation;\r\n    this.tabBar.dataset['placement'] = value;\r\n\r\n    // Update the layout direction.\r\n    (this.layout as BoxLayout).direction = direction;\r\n  }\r\n\r\n  /**\r\n   * The tab bar used by the tab panel.\r\n   *\r\n   * #### Notes\r\n   * Modifying the tab bar directly can lead to undefined behavior.\r\n   */\r\n  readonly tabBar: TabBar<Widget>;\r\n\r\n  /**\r\n   * The stacked panel used by the tab panel.\r\n   *\r\n   * #### Notes\r\n   * Modifying the panel directly can lead to undefined behavior.\r\n   */\r\n  readonly stackedPanel: StackedPanel;\r\n\r\n  /**\r\n   * A read-only array of the widgets in the panel.\r\n   */\r\n  get widgets(): ReadonlyArray<Widget> {\r\n    return this.stackedPanel.widgets;\r\n  }\r\n\r\n  /**\r\n   * Add a widget to the end of the tab panel.\r\n   *\r\n   * @param widget - The widget to add to the tab panel.\r\n   *\r\n   * #### Notes\r\n   * If the widget is already contained in the panel, it will be moved.\r\n   *\r\n   * The widget's `title` is used to populate the tab.\r\n   */\r\n  addWidget(widget: Widget): void {\r\n    this.insertWidget(this.widgets.length, widget);\r\n  }\r\n\r\n  /**\r\n   * Insert a widget into the tab panel at a specified index.\r\n   *\r\n   * @param index - The index at which to insert the widget.\r\n   *\r\n   * @param widget - The widget to insert into to the tab panel.\r\n   *\r\n   * #### Notes\r\n   * If the widget is already contained in the panel, it will be moved.\r\n   *\r\n   * The widget's `title` is used to populate the tab.\r\n   */\r\n  insertWidget(index: number, widget: Widget): void {\r\n    if (widget !== this.currentWidget) {\r\n      widget.hide();\r\n    }\r\n    this.stackedPanel.insertWidget(index, widget);\r\n    this.tabBar.insertTab(index, widget.title);\r\n  }\r\n\r\n  /**\r\n   * Handle the `currentChanged` signal from the tab bar.\r\n   */\r\n  private _onCurrentChanged(sender: TabBar<Widget>, args: TabBar.ICurrentChangedArgs<Widget>): void {\r\n    // Extract the previous and current title from the args.\r\n    let { previousIndex, previousTitle, currentIndex, currentTitle } = args;\r\n\r\n    // Extract the widgets from the titles.\r\n    let previousWidget = previousTitle ? previousTitle.owner : null;\r\n    let currentWidget = currentTitle ? currentTitle.owner : null;\r\n\r\n    // Hide the previous widget.\r\n    if (previousWidget) {\r\n      previousWidget.hide();\r\n    }\r\n\r\n    // Show the current widget.\r\n    if (currentWidget) {\r\n      currentWidget.show();\r\n    }\r\n\r\n    // Emit the `currentChanged` signal for the tab panel.\r\n    this._currentChanged.emit({\r\n      previousIndex, previousWidget, currentIndex, currentWidget\r\n    });\r\n\r\n    // Flush the message loop on IE and Edge to prevent flicker.\r\n    if (Platform.IS_EDGE || Platform.IS_IE) {\r\n      MessageLoop.flush();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the `tabActivateRequested` signal from the tab bar.\r\n   */\r\n  private _onTabActivateRequested(sender: TabBar<Widget>, args: TabBar.ITabActivateRequestedArgs<Widget>): void {\r\n    args.title.owner.activate();\r\n  }\r\n\r\n  /**\r\n   * Handle the `tabCloseRequested` signal from the tab bar.\r\n   */\r\n  private _onTabCloseRequested(sender: TabBar<Widget>, args: TabBar.ITabCloseRequestedArgs<Widget>): void {\r\n    args.title.owner.close();\r\n  }\r\n\r\n  /**\r\n   * Handle the `tabMoved` signal from the tab bar.\r\n   */\r\n  private _onTabMoved(sender: TabBar<Widget>, args: TabBar.ITabMovedArgs<Widget>): void {\r\n    this.stackedPanel.insertWidget(args.toIndex, args.title.owner);\r\n  }\r\n\r\n  /**\r\n   * Handle the `widgetRemoved` signal from the stacked panel.\r\n   */\r\n  private _onWidgetRemoved(sender: StackedPanel, widget: Widget): void {\r\n    this.tabBar.removeTab(widget.title);\r\n  }\r\n\r\n  private _tabPlacement: TabPanel.TabPlacement;\r\n  private _currentChanged = new Signal<this, TabPanel.ICurrentChangedArgs>(this);\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the `TabPanel` class statics.\r\n */\r\nexport\r\nnamespace TabPanel {\r\n  /**\r\n   * A type alias for tab placement in a tab bar.\r\n   */\r\n  export\r\n  type TabPlacement = (\r\n    /**\r\n     * The tabs are placed as a row above the content.\r\n     */\r\n    'top' |\r\n\r\n    /**\r\n     * The tabs are placed as a column to the left of the content.\r\n     */\r\n    'left' |\r\n\r\n    /**\r\n     * The tabs are placed as a column to the right of the content.\r\n     */\r\n    'right' |\r\n\r\n    /**\r\n     * The tabs are placed as a row below the content.\r\n     */\r\n    'bottom'\r\n  );\r\n\r\n  /**\r\n   * An options object for initializing a tab panel.\r\n   */\r\n  export\r\n  interface IOptions {\r\n    /**\r\n     * Whether the tabs are movable by the user.\r\n     *\r\n     * The default is `false`.\r\n     */\r\n    tabsMovable?: boolean;\r\n\r\n    /**\r\n     * The placement of the tab bar relative to the content.\r\n     *\r\n     * The default is `'top'`.\r\n     */\r\n    tabPlacement?: TabPlacement;\r\n\r\n    /**\r\n     * The renderer for the panel's tab bar.\r\n     *\r\n     * The default is a shared renderer instance.\r\n     */\r\n    renderer?: TabBar.IRenderer<Widget>;\r\n  }\r\n\r\n  /**\r\n   * The arguments object for the `currentChanged` signal.\r\n   */\r\n  export\r\n  interface ICurrentChangedArgs {\r\n    /**\r\n     * The previously selected index.\r\n     */\r\n    previousIndex: number;\r\n\r\n    /**\r\n     * The previously selected widget.\r\n     */\r\n    previousWidget: Widget | null;\r\n\r\n    /**\r\n     * The currently selected index.\r\n     */\r\n    currentIndex: number;\r\n\r\n    /**\r\n     * The currently selected widget.\r\n     */\r\n    currentWidget: Widget | null;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The namespace for the module implementation details.\r\n */\r\nnamespace Private {\r\n  /**\r\n   * Convert a tab placement to tab bar orientation.\r\n   */\r\n  export\r\n  function orientationFromPlacement(plc: TabPanel.TabPlacement): TabBar.Orientation {\r\n    return placementToOrientationMap[plc];\r\n  }\r\n\r\n  /**\r\n   * Convert a tab placement to a box layout direction.\r\n   */\r\n  export\r\n  function directionFromPlacement(plc: TabPanel.TabPlacement): BoxLayout.Direction {\r\n    return placementToDirectionMap[plc];\r\n  }\r\n\r\n  /**\r\n   * A mapping of tab placement to tab bar orientation.\r\n   */\r\n  const placementToOrientationMap: { [key: string]: TabBar.Orientation } = {\r\n    'top': 'horizontal',\r\n    'left': 'vertical',\r\n    'right': 'vertical',\r\n    'bottom': 'horizontal'\r\n  };\r\n\r\n  /**\r\n   * A mapping of tab placement to box layout direction.\r\n   */\r\n  const placementToDirectionMap: { [key: string]: BoxLayout.Direction } = {\r\n    'top': 'top-to-bottom',\r\n    'left': 'left-to-right',\r\n    'right': 'right-to-left',\r\n    'bottom': 'bottom-to-top'\r\n  };\r\n}\r\n"],"names":["BoxEngine","Signal","MessageLoop","AttachedProperty","empty","Message","ConflatableMessage","Widget","each","Private","Layout","ElementExt","iter","ArrayExt","BoxLayout","BoxPanel","VirtualDOM","h","StringExt","CommandRegistry","CommandPalette","JSONExt","getKeyboardLayout","Menu","DisposableDelegate","Selector","chain","once","map","ChainIterator","reduce","Drag","TabBar","find","Platform","MimeData","DockPanel","toArray","filter","max","GridLayout","MenuBar","SplitLayout","SplitPanel"],"mappings":"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"}